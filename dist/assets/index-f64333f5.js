import{r as p,E as z,G as v,a as e,aw as E,J as R,K as j,N as g,Q as y,V as C,I as S,W as f,ab as H,ac as P,X as u,ad as F,aY as M,ae as k,af as T,ax as w,aB as A,aC as I,aD as L,aE as U,aF as O,aG as $,aH as D,aI as K,aJ as V,B,R as G,aL as J,aM as Q,aN as Y,aO as W}from"./index-51361ed7.js";import{u as X,a as q,b as Z}from"./index-40e6811c.js";import{h as ee}from"./holidays-3060eb79.js";function ae({modalClose:s,data:a}){const[c,d]=p.useState({start_date:!1,end_date:!1}),[h,{isLoading:x}]=X(),n=z({resolver:v(ee),defaultValues:{name:(a==null?void 0:a.name)||"",start_date:a!=null&&a.start_date?new Date(a.start_date):void 0,end_date:a!=null&&a.end_date?new Date(a.end_date):void 0,duration:(a==null?void 0:a.duration)||"",note:(a==null?void 0:a.note)||""}}),r=t=>new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),m=(t,l)=>{if(t&&l){const o=l.getTime()-t.getTime(),i=Math.ceil(o/(1e3*60*60*24));return`${i+1} day${i===0?"":"s"}`}return""};async function _(t){try{if(a){const l={...t,start_date:r(t.start_date),end_date:r(t.end_date)};await h({holidayId:a.id,updatedHoliday:l}).unwrap(),w.success("Holiday updated successfully"),s()}}catch(l){console.error("Failed to update holiday:",l),w.error("Failed to update holiday")}}const b=t=>{d(l=>({...l,[t]:!l[t]}))};return p.useEffect(()=>{const t=n.getValues("start_date"),l=n.getValues("end_date");if(t&&l){const o=m(t,l);n.setValue("duration",o)}},[n.watch("start_date"),n.watch("end_date")]),e.jsx(e.Fragment,{children:x?e.jsx("div",{className:"h-56",children:e.jsx(E,{})}):e.jsx(R,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(_),className:"space-y-3 mb-auto",children:[e.jsx(j,{control:n.control,name:"name",render:({field:t})=>e.jsxs(g,{children:[e.jsx(y,{children:"Holiday Name"}),e.jsx(C,{children:e.jsx(S,{type:"text",placeholder:"Enter holiday name",...t})}),e.jsx(f,{})]})}),e.jsx(j,{control:n.control,name:"start_date",render:({field:t})=>e.jsxs(g,{children:[e.jsx(y,{children:"Start Date"}),e.jsxs(H,{open:c.start_date,onOpenChange:()=>b("start_date"),children:[e.jsx(P,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`w-full justify-start text-left font-normal ${!t.value&&"text-muted-foreground"}`,children:[t.value?F(t.value,"PP"):"Pick a date",e.jsx(M,{className:"ml-auto h-4 w-4 opacity-50"})]})}),e.jsx(k,{className:"w-auto p-0",align:"start",children:e.jsx(T,{mode:"single",selected:t.value??void 0,onSelect:l=>{const o=r(l);t.onChange(o);const i=n.getValues("end_date");if(o&&i){const N=m(o,i);n.setValue("duration",N)}},initialFocus:!0})})]}),e.jsx(f,{})]})}),e.jsx(j,{control:n.control,name:"end_date",render:({field:t})=>e.jsxs(g,{children:[e.jsx(y,{children:"End Date"}),e.jsxs(H,{open:c.end_date,onOpenChange:()=>b("end_date"),children:[e.jsx(P,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`w-full justify-start text-left font-normal ${!t.value&&"text-muted-foreground"}`,children:[t.value?F(t.value,"PP"):"Pick a date",e.jsx(M,{className:"ml-auto h-4 w-4 opacity-50"})]})}),e.jsx(k,{className:"w-auto p-0",align:"start",children:e.jsx(T,{mode:"single",selected:t.value??void 0,disabled:l=>{const o=n.getValues("start_date");return!!(o&&r(l)<r(o))},onSelect:l=>{const o=r(l);t.onChange(o);const i=n.getValues("start_date");if(i&&o){const N=m(i,o);n.setValue("duration",N)}},initialFocus:!0})})]}),e.jsx(f,{})]})}),e.jsx(j,{control:n.control,name:"duration",render:({field:t})=>e.jsxs(g,{children:[e.jsx(y,{children:"Duration"}),e.jsx(C,{children:e.jsx(S,{type:"text",placeholder:"Duration",...t,value:t.value||"",disabled:!0})}),e.jsx(f,{})]})}),e.jsx(j,{control:n.control,name:"note",render:({field:t})=>e.jsxs(g,{children:[e.jsx(y,{children:"Note"}),e.jsx(C,{children:e.jsx(S,{type:"text",placeholder:"Enter note",...t})}),e.jsx(f,{})]})}),e.jsx("div",{children:e.jsx(u,{variant:"default",type:"submit",className:"w-full mt-4",children:"Update"})})]})})})}function te({data:s}){const[a,c]=p.useState(!1),[d,h]=p.useState(!1),[x,{isLoading:n}]=q(),r=async m=>{try{await x(m),w.success("Holiday deleted successfully"),c(!1)}catch(_){console.log(_)}};return console.log(s),e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx(A,{children:e.jsxs(I,{children:[e.jsx(L,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>h(!0),children:e.jsx(U,{className:"h-4 w-4 text-foreground"})})}),e.jsx(O,{children:e.jsx("p",{children:"Update Holiday"})})]})}),e.jsx(A,{children:e.jsxs(I,{children:[e.jsx(L,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{c(!0)},children:e.jsx($,{className:"h-4 w-4 text-foreground"})})}),e.jsx(O,{children:e.jsx("p",{children:"Delete Holiday"})})]})}),e.jsx(D,{title:"Are you sure?",description:"This action cannot be undone.",name:s==null?void 0:s.name,isOpen:a,onClose:()=>c(!1),onConfirm:()=>r(s.id),loading:n}),d&&e.jsx(K,{title:"Update Holiday",isOpen:d,toggleModal:()=>h(!1),children:e.jsx(ae,{data:s,modalClose:()=>h(!1)})})]})}const se=[{id:"select",header:({table:s})=>e.jsx(V,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>s.toggleAllPageRowsSelected(!!a),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(V,{checked:s.getIsSelected(),onCheckedChange:a=>s.toggleSelected(!!a),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:"Name"},{accessorKey:"start_date",header:"Start Date",cell:({row:s})=>{const a=s.original.start_date;return a?new Date(a).toLocaleDateString():"N/A"}},{accessorKey:"end_date",header:"End Date",cell:({row:s})=>{const a=s.original.end_date;return a?new Date(a).toLocaleDateString():"N/A"}},{accessorKey:"duration",header:"Duration"},{accessorKey:"note",header:"Note"},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"Actions"}),enableSorting:!1,cell:({row:s})=>e.jsx(te,{data:s.original})}],de=()=>{const s=B(),[a,c]=G.useState({pageIndex:0,pageSize:10}),{data:d,isLoading:h}=Z(`per_page=${a.pageSize}&page=${a.pageIndex+1}`),x=(d==null?void 0:d.data.map(r=>({...r,id:r.id||0})))||[],n=d==null?void 0:d.meta;return h?e.jsx(E,{}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(J,{title:x.length?"Holiday List":"Add Holiday",description:"Manage your holidays"}),e.jsxs(u,{size:"sm",onClick:()=>s("/hrm/holidays/add"),children:[e.jsx(Q,{className:"mr-2 h-4 w-4"})," Add Holiday"]})]}),e.jsx(Y,{}),x.length>0&&e.jsx(W,{columns:se,data:x,paginationInfo:n,pagination:a,setPagination:c})]})})})};export{de as default};
