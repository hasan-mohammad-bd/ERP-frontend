import{aX as _,k as e,R as B,aZ as G,a_ as n,L as R,n as z,F as D,a$ as ee,b0 as se,b1 as S,b2 as ne,r as I,N as Q,Q as H,S as M,T as U,U as j,V as m,W as u,X as p,I as P,Y as y,ae as C,af as L,ag as w,ah as E,ai as t,B as O,b3 as le,a0 as X,b4 as ce,b5 as re,a9 as ae,P as $,aa as de}from"./index-DxUC03k6.js";import{T as te,a as ie,b as oe,c as xe}from"./tabs-Tyd14L7N.js";import{B as Y}from"./badge-gO5O5x7e.js";import{M as k}from"./modal-aT_piVnM.js";import{S as he}from"./switch-DrlxWnQ2.js";import"./sheet-D3omyzf4.js";const je=_.injectEndpoints({endpoints:c=>({getLedgerGroups:c.query({query:()=>"ledger-groups?tree=1",providesTags:["ledger-groups-tree"]}),getLedgerGroupsArray:c.query({query:()=>"ledger-groups",providesTags:["ledger-groups-array"]}),createLedgerGroup:c.mutation({query:s=>({url:"ledger-groups",method:"POST",body:s}),invalidatesTags:["ledger-groups","ledger-groups-tree","ledger-groups-array"]}),removeLedgerGroup:c.mutation({query:s=>({url:`ledger-groups/${s}`,method:"DELETE"}),invalidatesTags:["ledger-groups"]}),updateLedgerGroup:c.mutation({query:({ledgerGroupId:s,updatedLedgerGroup:a})=>({url:`ledger-groups/${s}`,method:"PUT",body:a}),invalidatesTags:["ledger-groups"]})}),overrideExisting:!1}),{useGetLedgerGroupsQuery:me,useGetLedgerGroupsArrayQuery:W,useCreateLedgerGroupMutation:ue,useRemoveLedgerGroupMutation:we,useUpdateLedgerGroupMutation:Ee}=je,Z=({group:c,coaType:s,depth:a=0})=>{const d=Array(a).fill("        ").join("");return c.childs_group.map(i=>e.jsxs(B.Fragment,{children:[e.jsxs(G,{children:[e.jsxs(n,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:[d,i.name]}),e.jsx(n,{className:"py-2.5",children:i.code}),e.jsx(n,{className:"py-2.5",children:"Group"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"})]}),i.childs_group.length>0&&e.jsx(Z,{group:i,coaType:s,depth:a+1}),i.ledgers.map(x=>e.jsxs(G,{children:[e.jsx(n,{className:"py-0 col-span-2 w-2/3",children:e.jsxs(R,{className:z({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/detailed-general-ledger/${x.id}`,children:[d,x.name]})}),e.jsx(n,{className:"py-2.5",children:x.code}),e.jsx(n,{className:"py-2.5",children:"Account"}),e.jsx(n,{className:"py-2.5",children:e.jsx(Y,{variant:"outline",children:"active"})}),e.jsx(n,{className:"py-2.5",children:"700"}),e.jsx(n,{className:"py-2.5",children:"500"})]},x.id))]},i.id))},pe=({data:c,coaType:s})=>{const a=c.find(d=>d.name===s);return a?e.jsx(D,{className:"mt-4",children:e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(G,{children:[e.jsx(S,{className:"py-2.5 h-8 col-span-2 w-2/3",children:"Name"}),e.jsx(S,{className:"py-2.5 h-8 w-[100px]",children:"Code"}),e.jsx(S,{className:"py-2.5 h-8",children:"Type"}),e.jsx(S,{className:"py-2.5 h-8",children:"Status"}),e.jsx(S,{className:"py-2.5 h-8",children:"Debit"}),e.jsx(S,{className:"py-2.5 h-8",children:"Credit"})]})}),e.jsxs(ne,{children:[e.jsxs(G,{children:[e.jsx(n,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:a.name}),e.jsx(n,{className:"py-2.5",children:a.code}),e.jsx(n,{className:"py-2.5",children:"Group"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"})]}),e.jsx(Z,{group:a,coaType:s,depth:1}),a.ledgers.map(d=>e.jsxs(G,{children:[e.jsx(n,{className:"py-2.5 col-span-2 w-2/3",children:e.jsxs(R,{className:z({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/detailed-general-ledger/${d.id}`,children:["    ",d.name]})}),e.jsx(n,{className:"py-2.5",children:d.code}),e.jsx(n,{className:"py-2.5",children:"Account"}),e.jsx(n,{className:"py-2.5",children:e.jsx(Y,{variant:"secondary",children:"Inactive"})}),e.jsx(n,{className:"py-2.5",children:"700"}),e.jsx(n,{className:"py-2.5",children:"500"})]},d.id))]})]})}):null},v=[{type:"Assets",title:"Assets",description:"Manage assets for your business"},{type:"Liabilities",title:"Liabilities",description:"Manage liabilities for your business"},{type:"Income",title:"Incomes",description:"Manage incomes for your business"},{type:"Expenses",title:"Expenses",description:"Manage expenses for your business"}];function ge({modalClose:c,rowData:s}){const[a,{isLoading:d}]=ue(),{data:i,isLoading:x}=W(),[A,o]=I.useState("Assets"),F=(i==null?void 0:i.data)||[],g=F==null?void 0:F.filter(r=>(r==null?void 0:r.type)===A),N=Q({resolver:H(le),defaultValues:{parent_id:(s==null?void 0:s.id)||0}});async function V(r){try{await a(r),X.success("Add ledger group successfully"),c()}catch(b){console.log(b)}}return e.jsx(e.Fragment,{children:d?e.jsx("div",{className:"h-56",children:e.jsx(M,{})}):e.jsx(U,{...N,children:e.jsxs("form",{onSubmit:N.handleSubmit(V),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(j,{control:N.control,name:"name",render:({field:r})=>e.jsxs(m,{children:[e.jsx(u,{children:"Name"}),e.jsx(p,{children:e.jsx(P,{placeholder:"Enter name",...r})}),e.jsx(y,{})]})}),e.jsx(j,{control:N.control,name:"code",render:({field:r})=>e.jsxs(m,{children:[e.jsx(u,{children:"Code"}),e.jsx(p,{children:e.jsx(P,{placeholder:"Enter code",...r,value:r.value||""})}),e.jsx(y,{})]})}),e.jsx(j,{name:"",render:()=>e.jsxs(m,{children:[e.jsx(u,{children:"Account Type"}),e.jsxs(C,{value:A,onValueChange:r=>{o(r)},children:[e.jsx(p,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Account Type"})})}),e.jsxs(E,{children:[e.jsx(t,{value:"Assets",children:"Assets"}),e.jsx(t,{value:"Liabilities",children:"Liabilities"}),e.jsx(t,{value:"Income",children:"Incomes"}),e.jsx(t,{value:"Expenses",children:"Expenses"})]})]}),e.jsx(y,{})]})}),(g==null?void 0:g.length)>0?e.jsx(j,{control:N.control,name:"parent_id",render:({field:r})=>e.jsxs(m,{children:[e.jsx(u,{children:"Parent"}),e.jsxs(C,{onValueChange:r.onChange,children:[e.jsx(p,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(E,{children:x?e.jsx(M,{}):g==null?void 0:g.map(b=>e.jsx(t,{value:String(b.id),children:b.name},b.id))})]}),e.jsx(y,{})]})}):null]}),e.jsx("div",{children:e.jsx(O,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Group"})})]})})})}const ye=_.injectEndpoints({endpoints:c=>({getEnum:c.query({query:()=>"catalogs/enum",providesTags:["catalogs/enum"]})}),overrideExisting:!1}),{useGetEnumQuery:fe}=ye;function Ne({modalClose:c,rowData:s,coaType:a}){const[d,{isLoading:i}]=ce(),[x,A]=B.useState(0),{data:o,isLoading:F}=W(),{data:g,isLoading:N}=fe(),V=(g==null?void 0:g.account_nature)||[],[r,b]=I.useState("Assets"),q=(o==null?void 0:o.data)||[],T=q==null?void 0:q.filter(l=>(l==null?void 0:l.type)===r),f=Q({resolver:H(re),defaultValues:{name:(s==null?void 0:s.name)||"",parent_id:(s==null?void 0:s.id)||0,is_sub_type:0,nature:(s==null?void 0:s.nature)||""}});async function J(l){try{await d(l),X.success("Add ledger account successfully"),c()}catch(h){console.log(h)}}return e.jsx(e.Fragment,{children:i?e.jsx("div",{className:"h-56",children:e.jsx(M,{})}):e.jsx(U,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(J),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(j,{control:f.control,name:"name",render:({field:l})=>e.jsxs(m,{children:[e.jsx(u,{children:"Name"}),e.jsx(p,{children:e.jsx(P,{placeholder:"Enter ledger account name",...l})}),e.jsx(y,{})]})}),e.jsx(j,{control:f.control,name:"code",render:({field:l})=>e.jsxs(m,{children:[e.jsx(u,{children:"Code"}),e.jsx(p,{children:e.jsx(P,{placeholder:"Enter code",...l,value:l.value||""})}),e.jsx(y,{})]})}),e.jsx(j,{name:"",render:()=>e.jsxs(m,{children:[e.jsx(u,{children:"Account Type"}),e.jsxs(C,{value:r,onValueChange:l=>{b(l)},children:[e.jsx(p,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Account Type"})})}),e.jsxs(E,{children:[e.jsx(t,{value:"Assets",children:"Assets"}),e.jsx(t,{value:"Liabilities",children:"Liabilities"}),e.jsx(t,{value:"Income",children:"Incomes"}),e.jsx(t,{value:"Expenses",children:"Expenses"})]})]}),e.jsx(y,{})]})}),(T==null?void 0:T.length)>0?e.jsx(j,{control:f.control,name:"parent_id",render:({field:l})=>e.jsxs(m,{children:[e.jsx(u,{children:"Parent"}),e.jsxs(C,{onValueChange:l.onChange,children:[e.jsx(p,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(E,{children:F?e.jsx(M,{}):T==null?void 0:T.map(h=>e.jsx(t,{value:String(h.id),children:h.name},h.id))})]}),e.jsx(y,{})]})}):null]}),a==="Assets"||r==="Assets"?e.jsx(j,{control:f.control,name:"nature",render:({field:l})=>e.jsxs(m,{children:[e.jsx(u,{children:"Default Account Type"}),e.jsxs(C,{onValueChange:l.onChange,children:[e.jsx(p,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(E,{children:N?e.jsx(M,{}):V.map((h,K)=>e.jsx(t,{value:h.toString(),children:h.toString()},K))})]}),e.jsx(y,{})]})}):null,e.jsx(j,{control:f.control,name:"is_sub_type",render:({field:l})=>e.jsxs(m,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(u,{children:"Is Sub Type"})}),e.jsx(p,{children:e.jsx(he,{checked:l.value===1,onCheckedChange:h=>{l.onChange(h?1:0),A(h?1:0)}})})]})}),x===1&&e.jsx(j,{control:f.control,name:"sub_type",render:({field:l})=>e.jsxs(m,{children:[e.jsx(u,{children:"Sub Type"}),e.jsxs(C,{onValueChange:l.onChange,defaultValue:"None",children:[e.jsx(p,{children:e.jsx(L,{children:e.jsx(w,{placeholder:""})})}),e.jsxs(E,{children:[e.jsx(t,{value:"None",children:"None"}),e.jsx(t,{value:"Employee",children:"Employee"}),e.jsx(t,{value:"Customer",children:"Customer"}),e.jsx(t,{value:"Supplier",children:"Supplier"}),e.jsx(t,{value:"Agent",children:"Agent"})]})]}),e.jsx(y,{})]})}),e.jsx("div",{children:e.jsx(O,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Account"})})]})})})}const Me=()=>{const{data:c,isLoading:s}=me(),[a,d]=I.useState(!1),[i,x]=I.useState(!1),A=(c==null?void 0:c.data)||[];return s?e.jsx(M,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{title:"Chart Of Account",description:"Manage Chart of account for you business"}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsxs(O,{onClick:()=>d(!0),size:"sm",children:[e.jsx($,{className:"mr-2 h-4 w-4"})," Add Group"]}),e.jsxs(O,{onClick:()=>x(!0),size:"sm",children:[e.jsx($,{className:"mr-2 h-4 w-4"})," Add Account"]})]})]}),e.jsx(de,{}),e.jsxs(te,{defaultValue:v[0].type,className:"w-full mt-3",children:[e.jsx(ie,{className:"w-fit",children:v.map(o=>e.jsx(oe,{value:o.type,children:o.title},o.type))}),v.map(o=>e.jsx(xe,{value:o.type,children:e.jsx(pe,{title:o.title,coaType:o.type,description:o.description,data:A})},o.type))]}),a&&e.jsx(k,{title:"Add Group",isOpen:a,toggleModal:()=>d(!1),children:e.jsx(ge,{modalClose:()=>d(!1)})}),i&&e.jsx(k,{title:"Add Account",isOpen:i,toggleModal:()=>x(!1),children:e.jsx(Ne,{modalClose:()=>x(!1)})})]})};export{Me as default};
