import{c9 as xe,ca as pe,x as je,cb as ge,r as m,a as e,aj as E,ak as $,al as R,am as K,an as A,I as ye,b as N,y as ne,z,B as k,aD as re,A as T,D as G,cc as F,cd as Se,o as B,ce as we,bx as be,ar as Ne,aE as ke,V as ve,Y as ae,Z as Ae,_ as V,$ as D,a0 as H,a1 as O,aK as Me,a2 as L,aq as Te,a3 as U,a4 as Ie,bD as Ce,bE as Pe,bF as _e,bG as Ve,bH as De,bI as He,bJ as Oe,bK as Le,K as Ee,cf as $e,E as Re,ae as Ke,t as Fe,af as Ye,ag as ze,ac as Ge,F as qe,G as Be,H as Q,J,M as W,N as Z,Q as X}from"./index-ed251f1a.js";import{a as ee}from"./format-dates-7f6b682f.js";import{C as Ue}from"./clock-b54488dc.js";import{c as Qe}from"./index-2bdfbb97.js";function Je(t,s){const{years:n=0,months:c=0,weeks:r=0,days:u=0,hours:o=0,minutes:d=0,seconds:l=0}=s,i=xe(t),f=c||n?pe(i,c+n*12):i,a=u||r?je(f,u+r*7):f,x=d+o*60,y=(l+x*60)*1e3;return ge(t,a.getTime()+y)}const We=[{accessorKey:"employee.name",header:"Employee Name"},{accessorKey:"employee.department.name",header:"Department"},{accessorKey:"employee.designation.name",header:"Designation"},{accessorKey:"check_in",header:"Check In",cell:({row:t})=>{var s;return t.original.check_in&&ee((s=t.original)==null?void 0:s.check_in)}},{accessorKey:"check_out",header:"Check out",cell:({row:t})=>{var s;return t.original.check_out&&ee((s=t.original)==null?void 0:s.check_out)}},{accessorKey:"note",header:"Note"}];function Ze(t){return/^(0[0-9]|1[0-9]|2[0-3])$/.test(t)}function Xe(t){return/^(0[1-9]|1[0-2])$/.test(t)}function et(t){return/^[0-5][0-9]$/.test(t)}function I(t,{max:s,min:n=0,loop:c=!1}){let r=parseInt(t,10);return isNaN(r)?"00":(c?(r>s&&(r=n),r<n&&(r=s)):(r>s&&(r=s),r<n&&(r=n)),r.toString().padStart(2,"0"))}function ce(t){return Ze(t)?t:I(t,{max:23})}function ie(t){return Xe(t)?t:I(t,{min:1,max:12})}function M(t){return et(t)?t:I(t,{max:59})}function q(t,{min:s,max:n,step:c}){let r=parseInt(t,10);return isNaN(r)?"00":(r+=c,I(String(r),{min:s,max:n,loop:!0}))}function tt(t,s){return q(t,{min:0,max:23,step:s})}function st(t,s){return q(t,{min:1,max:12,step:s})}function te(t,s){return q(t,{min:0,max:59,step:s})}function nt(t,s){const n=M(s);return t.setMinutes(parseInt(n,10)),t}function rt(t,s){const n=M(s);return t.setSeconds(parseInt(n,10)),t}function at(t,s){const n=ce(s);return t.setHours(parseInt(n,10)),t}function ct(t,s,n){const c=parseInt(ie(s),10),r=lt(c,n);return t.setHours(r),t}function Y(t,s,n,c){switch(n){case"minutes":return nt(t,s);case"seconds":return rt(t,s);case"hours":return at(t,s);case"12hours":return c?ct(t,s,c):t;default:return t}}function it(t,s){if(!t)return"00";switch(s){case"minutes":return M(String(t.getMinutes()));case"seconds":return M(String(t.getSeconds()));case"hours":return ce(String(t.getHours()));case"12hours":const n=oe(t.getHours());return ie(String(n));default:return"00"}}function ot(t,s,n){switch(n){case"minutes":return te(t,s);case"seconds":return te(t,s);case"hours":return tt(t,s);case"12hours":return st(t,s);default:return"00"}}function lt(t,s){return s==="PM"?t<=11?t+12:t:s==="AM"&&t===12?0:t}function oe(t){return t===0||t===12?"12":t>=22?`${t-12}`:t%12>9?`${t}`:`0${t%12}`}function ut(t){return Array.from({length:12},(s,n)=>({value:n,label:T(new Date(2021,n),"MMMM",{locale:t})}))}function dt(t,s=50){const n=new Date;return Array.from({length:s*2+1},(c,r)=>({value:n.getFullYear()-s+r,label:(n.getFullYear()-s+r).toString()}))}function le({className:t,classNames:s,showOutsideDays:n=!0,yearRange:c=50,...r}){const u=m.useMemo(()=>ut(r.locale||F),[]),o=m.useMemo(()=>dt(r.locale||F,c),[]);return e.jsx(Se,{showOutsideDays:n,className:N("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0 justify-center",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:N(B({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:N(B({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:({...d})=>e.jsx(we,{...d,className:"h-4 w-4"}),IconRight:({...d})=>e.jsx(be,{...d,className:"h-4 w-4"}),CaptionLabel:({displayMonth:d})=>e.jsxs("div",{className:"inline-flex gap-2",children:[e.jsxs(E,{defaultValue:d.getMonth().toString(),onValueChange:l=>{var f;const i=new Date(d);i.setMonth(parseInt(l,10)),(f=r.onMonthChange)==null||f.call(r,i)},children:[e.jsx($,{className:"w-fit border-none p-0 focus:bg-accent focus:text-accent-foreground",children:e.jsx(R,{})}),e.jsx(K,{children:u.map(l=>e.jsx(A,{value:l.value.toString(),children:l.label},l.value))})]}),e.jsxs(E,{defaultValue:d.getFullYear().toString(),onValueChange:l=>{var f;const i=new Date(d);i.setFullYear(parseInt(l,10)),(f=r.onMonthChange)==null||f.call(r,i)},children:[e.jsx($,{className:"w-fit border-none p-0 focus:bg-accent focus:text-accent-foreground",children:e.jsx(R,{})}),e.jsx(K,{children:o.map(l=>e.jsx(A,{value:l.value.toString(),children:l.label},l.value))})]})]})},...r})}le.displayName="Calendar";const ue=m.forwardRef(({period:t,setPeriod:s,date:n,onDateChange:c,onLeftFocus:r,onRightFocus:u},o)=>{const d=i=>{i.key==="ArrowRight"&&(u==null||u()),i.key==="ArrowLeft"&&(r==null||r())},l=i=>{if(s==null||s(i),n){const f=new Date(n),a=oe(n.getHours());c==null||c(Y(f,a.toString(),"12hours",t==="AM"?"PM":"AM"))}};return e.jsx("div",{className:"flex h-10 items-center",children:e.jsxs(E,{defaultValue:t,onValueChange:i=>l(i),children:[e.jsx($,{ref:o,className:"w-[65px] focus:bg-accent focus:text-accent-foreground",onKeyDown:d,children:e.jsx(R,{})}),e.jsxs(K,{children:[e.jsx(A,{value:"AM",children:"AM"}),e.jsx(A,{value:"PM",children:"PM"})]})]})})});ue.displayName="TimePeriodSelect";const v=m.forwardRef(({className:t,type:s="tel",value:n,id:c,name:r,date:u=new Date(new Date().setHours(0,0,0,0)),onDateChange:o,onChange:d,onKeyDown:l,picker:i,period:f,onLeftFocus:a,onRightFocus:x,...g},y)=>{const[h,j]=m.useState(!1),[w,S]=m.useState("0");m.useEffect(()=>{if(h){const p=setTimeout(()=>{j(!1)},2e3);return()=>clearTimeout(p)}},[h]);const b=m.useMemo(()=>it(u,i),[u,i]),fe=p=>i==="12hours"&&h&&b.slice(1,2)==="1"&&w==="0"?"0"+p:h?b.slice(1,2)+p:"0"+p,he=p=>{if(p.key!=="Tab"){if(p.preventDefault(),p.key==="ArrowRight"&&(x==null||x()),p.key==="ArrowLeft"&&(a==null||a()),["ArrowUp","ArrowDown"].includes(p.key)){const C=p.key==="ArrowUp"?1:-1,P=ot(b,C,i);h&&j(!1);const _=u?new Date(u):new Date;o==null||o(Y(_,P,i,f))}if(p.key>="0"&&p.key<="9"){i==="12hours"&&S(p.key);const C=fe(p.key);h&&(x==null||x()),j(_=>!_);const P=u?new Date(u):new Date;o==null||o(Y(P,C,i,f))}}};return e.jsx(ye,{ref:y,id:c||i,name:r||i,className:N("w-[48px] text-center font-mono text-base tabular-nums caret-transparent focus:bg-accent focus:text-accent-foreground [&::-webkit-inner-spin-button]:appearance-none",t),value:n||b,onChange:p=>{p.preventDefault(),d==null||d(p)},type:s,inputMode:"decimal",onKeyDown:p=>{l==null||l(p),he(p)},...g})});v.displayName="TimePickerInput";const de=m.forwardRef(({date:t,onChange:s,hourCycle:n=24,granularity:c="second"},r)=>{const u=m.useRef(null),o=m.useRef(null),d=m.useRef(null),l=m.useRef(null),[i,f]=m.useState(t&&t.getHours()>=12?"PM":"AM");return m.useImperativeHandle(r,()=>({minuteRef:u.current,hourRef:o.current,secondRef:d.current,periodRef:l.current}),[u,o,d]),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("label",{htmlFor:"datetime-picker-hour-input",className:"cursor-pointer",children:e.jsx(Ue,{className:"mr-2 h-4 w-4"})}),e.jsx(v,{picker:n===24?"hours":"12hours",date:t,id:"datetime-picker-hour-input",onDateChange:s,ref:o,period:i,onRightFocus:()=>{var a;return(a=u.current)==null?void 0:a.focus()}}),(c==="minute"||c==="second")&&e.jsxs(e.Fragment,{children:[":",e.jsx(v,{picker:"minutes",date:t,onDateChange:s,ref:u,onLeftFocus:()=>{var a;return(a=o.current)==null?void 0:a.focus()},onRightFocus:()=>{var a;return(a=d.current)==null?void 0:a.focus()}})]}),c==="second"&&e.jsxs(e.Fragment,{children:[":",e.jsx(v,{picker:"seconds",date:t,onDateChange:s,ref:d,onLeftFocus:()=>{var a;return(a=u.current)==null?void 0:a.focus()},onRightFocus:()=>{var a;return(a=l.current)==null?void 0:a.focus()}})]}),n===12&&e.jsx("div",{className:"grid gap-1 text-center",children:e.jsx(ue,{period:i,setPeriod:f,date:t,onDateChange:a=>{s==null||s(a),a&&(a==null?void 0:a.getHours())>=12?f("PM"):f("AM")},ref:l,onLeftFocus:()=>{var a;return(a=d.current)==null?void 0:a.focus()}})})]})});de.displayName="TimePicker";const me=m.forwardRef(({locale:t=F,value:s,onChange:n,hourCycle:c=24,yearRange:r=50,disabled:u=!1,displayFormat:o,granularity:d="second",placeholder:l="Pick a date",...i},f)=>{const[a,x]=m.useState(s??new Date),g=m.useRef(null),y=j=>{if(!j)return;if(!s){n==null||n(j),x(j);return}const S=(j.getTime()-s.getTime())/(1e3*60*60*24),b=Je(s,{days:Math.ceil(S)});n==null||n(b),x(b)};m.useImperativeHandle(f,()=>({...g.current,value:s}),[s]);const h={hour24:(o==null?void 0:o.hour24)??"PPP HH:mm:ss",hour12:(o==null?void 0:o.hour12)??"PP hh:mm:ss b"};return e.jsxs(ne,{children:[e.jsx(z,{asChild:!0,disabled:u,children:e.jsxs(k,{variant:"outline",className:N("w-[280px] justify-start text-left font-normal",!s&&"text-muted-foreground"),ref:g,children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),s?T(s,c===24?h.hour24:h.hour12,{locale:t}):e.jsx("span",{children:l})]})}),e.jsxs(G,{className:"w-auto p-0",children:[e.jsx(le,{mode:"single",selected:s,month:a,onSelect:j=>y(j),onMonthChange:y,initialFocus:!0,yearRange:r,locale:t,...i}),d!=="day"&&e.jsx("div",{className:"border-t border-border p-3",children:e.jsx(de,{onChange:n,date:s,hourCycle:c,granularity:d})})]})]})});me.displayName="DateTimePicker";const mt=Ne.injectEndpoints({endpoints:t=>({getAttendanceList:t.query({query:s=>`attendances?${s}`,providesTags:["attendance-list"]}),createAttendanceCheckIn:t.mutation({query:s=>({url:"attendance-check-in",method:"POST",body:s}),invalidatesTags:["attendance-list"]}),createAttendanceCheckOut:t.mutation({query:s=>({url:"attendance-check-out",method:"POST",body:s}),invalidatesTags:["attendance-list"]})}),overrideExisting:!1}),{useGetAttendanceListQuery:ft,useCreateAttendanceCheckInMutation:ht,useCreateAttendanceCheckOutMutation:xt}=mt;function se({tab:t,modalClose:s}){const[n,c]=m.useState([]),[r,u]=m.useState(""),{data:o,isLoading:d}=ke(`per_page=15&page=1&search=${r}`),[l,{isLoading:i}]=ht(),[f,{isLoading:a}]=xt(),x=ve({defaultValues:{}}),g=async h=>{var w;return u(h),((w=o==null?void 0:o.data)==null?void 0:w.map(S=>({value:String(S.id),label:S.first_name+" "+S.last_name+" ("+S.id+")"})))||[]},y=async h=>{try{t==="check-in"?(await l(h).unwrap(),U.success("CheckIn created successfully!")):(await f(h).unwrap(),U.success("CheckOut created successfully!")),s()}catch(j){console.error("Error recording attendance:",j),Ie(j)}};return e.jsx(e.Fragment,{children:d?e.jsx("div",{className:"h-56",children:e.jsx(ae,{})}):e.jsx(Ae,{...x,children:e.jsxs("form",{onSubmit:x.handleSubmit(y),className:"w-full space-y-3",children:[e.jsx(V,{control:x.control,name:"employee_ids",render:({field:h})=>e.jsxs(D,{children:[e.jsx(H,{children:"Employee Name"}),e.jsx(O,{children:e.jsx(Me,{...h,value:n,onSearch:g,onChange:j=>{c(j),h.onChange(j.map(w=>parseInt(w.value)))},hidePlaceholderWhenSelected:!0,placeholder:"Search and select options",loadingIndicator:e.jsx("span",{children:"Loading..."}),emptyIndicator:e.jsx("span",{children:"No options found"})})}),e.jsx(L,{})]})}),e.jsx(V,{control:x.control,name:"date_time",render:({field:h})=>e.jsxs(D,{children:[e.jsx(H,{children:"Punch Time"}),e.jsx(O,{className:"",children:e.jsx(me,{...h,displayFormat:{hour12:"yyyy/MM/dd h:mm a"},value:h.value,onChange:h.onChange,granularity:"minute",hourCycle:12})}),e.jsx(L,{})]})}),e.jsx(V,{control:x.control,name:"note",render:()=>e.jsxs(D,{children:[e.jsx(H,{children:"Note"}),e.jsx(O,{children:e.jsx(Te,{...x.register("note")})}),e.jsx(L,{})]})}),e.jsx("div",{children:e.jsx(k,{variant:t==="check-in"?"default":"destructive",type:"submit",className:"w-full mt-4",disabled:i||a,children:i||a?"Submitting...":t==="check-in"?"Check In":"Check Out"})})]})})})}const pt=({items:t,value:s,labelKey:n,valueKey:c,onSelect:r,placeholder:u="Select an item...",noItemText:o="No items found."})=>{var f;const[d,l]=m.useState(!1),i=a=>{r(a),l(!1)};return e.jsxs(ne,{open:d,onOpenChange:l,children:[e.jsx(z,{asChild:!0,children:e.jsxs(k,{variant:"outline",size:"sm",role:"combobox","aria-expanded":d,className:"w-[230px] justify-between",children:[s?(f=s[n])==null?void 0:f.toString():u,e.jsx(Ce,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(G,{className:"max-w-[230px] p-0",children:e.jsxs(Pe,{children:[e.jsx(_e,{placeholder:`Search ${u.toLowerCase()}`}),e.jsxs(Ve,{children:[e.jsx(De,{children:o}),e.jsx(He,{children:t.map(a=>{var x,g,y;return e.jsxs(Oe,{value:(x=a[c])==null?void 0:x.toString(),onSelect:()=>i(a),children:[e.jsx(Le,{className:N("mr-2 h-4 w-4",s&&s[c]===a[c]?"opacity-100":"opacity-0")}),(g=a[n])==null?void 0:g.toString()]},(y=a[c])==null?void 0:y.toString())})})]})]})})]})};function jt({selectedDate:t,setSelectedDate:s,selectedDepartment:n,setSelectedDepartment:c}){const{data:r}=Qe(""),[u,o]=m.useState(!1);return e.jsx(Ee,{className:"w-full p-5",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-[280px]",children:e.jsxs($e,{open:u,onOpenChange:o,children:[e.jsx(z,{asChild:!0,className:"h-9",children:e.jsxs(k,{variant:"outline",className:`w-full justify-start text-left font-normal ${!t&&"text-muted-foreground"}`,children:[t?T(t,"PP"):"Pick a date",e.jsx(re,{className:"ml-auto h-4 w-4 opacity-50"})]})}),e.jsx(G,{className:"w-auto p-0",align:"start",children:e.jsx(Re,{mode:"single",selected:t,onSelect:s,initialFocus:!0})})]})}),e.jsx(pt,{items:(r==null?void 0:r.data)||[],labelKey:"name",valueKey:"id",value:n,placeholder:"Select Department",onSelect:c})]})})}const bt=()=>{const[t,s]=m.useState("check-in"),[n,c]=m.useState(!1),[r,u]=m.useState(),[o,d]=m.useState(void 0),[l,i]=m.useState({pageIndex:0,pageSize:10}),f=new URLSearchParams({date:r&&T(r,"yyyy-MM-dd")||"",per_page:l.pageSize.toString(),page:l.pageIndex.toString()}),{data:a,isLoading:x}=ft(f.toString()),g=(a==null?void 0:a.data)||[],y=a==null?void 0:a.meta;return x?e.jsx(ae,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Ke,{title:"Attendance List",description:"Manage job apply for your business"}),e.jsxs(k,{onClick:()=>c(!0),size:"sm",children:[e.jsx(Fe,{className:"mr-2 h-4 w-4"})," Add Attendance"]})]}),e.jsx(jt,{selectedDate:r,setSelectedDate:u,selectedDepartment:o,setSelectedDepartment:d}),e.jsx(Ye,{}),g.length>0?e.jsx(ze,{columns:We,data:g,paginationInfo:y,pagination:l,setPagination:i,className:"py-2 px-4"}):e.jsx("div",{className:"grid place-items-center min-h-[60vh]",children:e.jsx("p",{className:"text-xl",children:"No attendance records found for the selected date or department."})})]})}),n&&e.jsx(Ge,{title:"Add Attendance List",isOpen:n,toggleModal:()=>c(!1),className:"w-fit",children:e.jsxs(qe,{defaultValue:t,onValueChange:h=>s(h),className:"w-[400px] mx-auto",children:[e.jsxs(Be,{className:"grid w-full grid-cols-2 my-2",children:[e.jsx(Q,{value:"check-in",children:"Check In"}),e.jsx(Q,{value:"check-out",children:"Check Out"})]}),e.jsxs(J,{value:"check-in",children:[e.jsx(W,{children:e.jsx(Z,{children:"Check In"})}),e.jsx(X,{className:"space-y-2",children:e.jsx("div",{className:"space-y-1",children:e.jsx(se,{modalClose:()=>c(!1),tab:t})})})]}),e.jsxs(J,{value:"check-out",children:[e.jsx(W,{children:e.jsx(Z,{children:"Check Out"})}),e.jsx(X,{className:"space-y-2",children:e.jsx("div",{className:"space-y-1",children:e.jsx(se,{modalClose:()=>c(!1),tab:t})})})]})]})})]})};export{bt as default};
