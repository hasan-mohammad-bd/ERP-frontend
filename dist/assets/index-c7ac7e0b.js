import{a1 as $,a as e,R as _,V as S,Y as h,L as Q,o as U,F as K,Q as Z,U as R,W as E,X as D,ag as q,a7 as v,a8 as B,$ as L,a9 as H,aa as j,ab as m,ac as g,y as ee,z as se,ad as p,B as w,b as I,bb as ne,D as re,bc as ae,bd as le,be as ce,bf as de,bg as oe,bh as te,bi as ie,ae as f,I as A,bj as ue,bk as he,av as G,aw as M,ax as O,ay as F,az as N,bl as xe,r as k,aq as je,t as V,ar as me,ao as z}from"./index-92b059ef.js";import{T as ge,a as pe,b as ye,c as fe}from"./tabs-2df5c165.js";import{S as be}from"./switch-91c44ceb.js";const Ne=$.injectEndpoints({endpoints:n=>({getLedgerGroups:n.query({query:()=>"ledger-groups?tree=1",providesTags:["ledger-groups-tree"]}),getLedgerGroupsArray:n.query({query:()=>"ledger-groups",providesTags:["ledger-groups-array"]}),createLedgerGroup:n.mutation({query:s=>({url:"ledger-groups",method:"POST",body:s}),invalidatesTags:["ledger-groups","ledger-groups-tree","ledger-groups-array"]}),removeLedgerGroup:n.mutation({query:s=>({url:`ledger-groups/${s}`,method:"DELETE"}),invalidatesTags:["ledger-groups"]}),updateLedgerGroup:n.mutation({query:({ledgerGroupId:s,updatedLedgerGroup:a})=>({url:`ledger-groups/${s}`,method:"PUT",body:a}),invalidatesTags:["ledger-groups"]})}),overrideExisting:!1}),{useGetLedgerGroupsQuery:Ce,useGetLedgerGroupsArrayQuery:Y,useCreateLedgerGroupMutation:Le,useRemoveLedgerGroupMutation:Pe,useUpdateLedgerGroupMutation:_e}=Ne,J=({group:n,coaType:s,depth:a=0})=>{const l=Array(a).fill("        ").join("");return n.childs_group.map(c=>e.jsxs(_.Fragment,{children:[e.jsxs(S,{children:[e.jsxs(h,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:[l,c.name]}),e.jsx(h,{className:"py-2.5",children:c.code}),e.jsx(h,{className:"py-2.5",children:"Group"})]}),c.childs_group&&c.childs_group.length>0&&e.jsx(J,{group:c,coaType:s,depth:a+1}),c.ledgers&&c.ledgers.length>0&&c.ledgers.map(o=>e.jsxs(S,{children:[e.jsx(h,{className:"py-0 col-span-2 w-2/3",children:e.jsxs(Q,{className:U({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/reports/detailed-general-ledger/${o.id}`,children:[l,o.name]})}),e.jsx(h,{className:"py-2.5",children:o.code}),e.jsx(h,{className:"py-2.5",children:"Account"})]},o.id))]},c.id))},Se=({data:n,coaType:s})=>{const a=n.find(l=>l.name===s);return a?e.jsx(K,{className:"mt-4",children:e.jsxs(Z,{children:[e.jsx(R,{children:e.jsxs(S,{children:[e.jsx(E,{className:"py-2.5 h-8 col-span-2 w-2/3",children:"Name"}),e.jsx(E,{className:"py-2.5 h-8 w-[100px]",children:"Code"}),e.jsx(E,{className:"py-2.5 h-8",children:"Type"})]})}),e.jsxs(D,{children:[e.jsxs(S,{children:[e.jsx(h,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:a.name}),e.jsx(h,{className:"py-2.5",children:a.code}),e.jsx(h,{className:"py-2.5",children:"Group"})]}),e.jsx(J,{group:a,coaType:s,depth:1}),a.ledgers.map(l=>e.jsxs(S,{children:[e.jsx(h,{className:"py-2.5 col-span-2 w-2/3",children:e.jsxs(Q,{className:U({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/detailed-general-ledger/${l.id}`,children:["    ",l.name]})}),e.jsx(h,{className:"py-2.5",children:l.code}),e.jsx(h,{className:"py-2.5",children:"Account"})]},l.id))]})]})}):null},P=[{type:"Assets",title:"Assets",description:"Manage assets for your business"},{type:"Liabilities",title:"Liabilities",description:"Manage liabilities for your business"},{type:"Income",title:"Incomes",description:"Manage incomes for your business"},{type:"Expenses",title:"Expenses",description:"Manage expenses for your business"},{type:"Equity",title:"Equity",description:"Manage expenses for your business"}];function we(n){var l,c;const s=(l=n==null?void 0:n.data)==null?void 0:l.data,a=[];if(s)for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&s[o].forEach(x=>{a.push(x)});return a.length===0&&a.push(((c=n==null?void 0:n.data)==null?void 0:c.message)||"Something went wrong. Please try again."),a}function W(n){we(n).forEach(a=>{q.error(a)})}function Ae({modalClose:n,rowData:s}){const[a,l]=_.useState(!1),[c,{isLoading:o}]=Le(),{data:x,isLoading:u}=Y(),C=(x==null?void 0:x.data)||[],b=v({resolver:B(ue),defaultValues:{parent_id:s==null?void 0:s.id}});async function T(d){try{await c(d).unwrap(),q.success("Add ledger group successfully"),n()}catch(i){W(i),console.log(i)}}return e.jsx(e.Fragment,{children:o?e.jsx("div",{className:"h-56",children:e.jsx(L,{})}):e.jsx(H,{...b,children:e.jsxs("form",{onSubmit:b.handleSubmit(T),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(j,{control:b.control,name:"parent_id",render:({field:d})=>{var i;return e.jsxs(m,{children:[e.jsx(g,{children:"Parent Group"}),e.jsxs(ee,{open:a,onOpenChange:l,modal:!0,children:[e.jsx(se,{asChild:!0,children:e.jsx(p,{children:e.jsxs(w,{variant:"outline",role:"combobox",className:I("w-full justify-between",!d.value&&"text-muted-foreground"),children:[d.value?(i=C.find(y=>y.id===Number(d.value)))==null?void 0:i.name:"Select Parent",e.jsx(ne,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(re,{className:"w-[460px] p-0",children:e.jsxs(ae,{children:[e.jsx(le,{placeholder:"Search parent group..."}),e.jsxs(ce,{children:[e.jsx(de,{children:"No parent group found."}),e.jsx(oe,{children:u?e.jsx(L,{}):C.map(y=>e.jsxs(te,{onSelect:()=>{d.onChange(String(y.id)),l(!1)},children:[e.jsx(ie,{className:I("mr-2 h-4 w-4",Number(d.value)===y.id?"opacity-100":"opacity-0")}),y.name]},y.id))})]})]})})]}),e.jsx(f,{})]})}}),e.jsx(j,{control:b.control,name:"name",render:({field:d})=>e.jsxs(m,{children:[e.jsx(g,{children:"Account Name"}),e.jsx(p,{children:e.jsx(A,{placeholder:"Enter name",...d})}),e.jsx(f,{})]})}),e.jsx(j,{control:b.control,name:"code",render:({field:d})=>e.jsxs(m,{children:[e.jsx(g,{children:"Code"}),e.jsx(p,{children:e.jsx(A,{placeholder:"Enter code",...d,value:d.value||""})}),e.jsx(f,{})]})})]}),e.jsx("div",{children:e.jsx(w,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Group"})})]})})})}const Te=$.injectEndpoints({endpoints:n=>({getEnum:n.query({query:()=>"catalogs/enum",providesTags:["catalogs/enum"]})}),overrideExisting:!1}),{useGetEnumQuery:Ee}=Te;function Ge({modalClose:n,rowData:s}){const[a,{isLoading:l}]=he(),[c,o]=_.useState(0),{data:x,isLoading:u}=Y(),{data:C,isLoading:b}=Ee(),T=(C==null?void 0:C.account_nature)||[],d=(x==null?void 0:x.data)||[];console.log(d);const i=v({resolver:B(xe),defaultValues:{name:(s==null?void 0:s.name)||"",parent_id:s==null?void 0:s.id,is_sub_type:0,nature:(s==null?void 0:s.nature)||""}});console.log(d);async function y(t){try{await a(t).unwrap(),q.success("Add ledger account successfully"),n()}catch(r){W(r),console.log(r)}}return e.jsx(e.Fragment,{children:l?e.jsx("div",{className:"h-56",children:e.jsx(L,{})}):e.jsx(H,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(y),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(j,{control:i.control,name:"parent_id",render:({field:t})=>e.jsxs(m,{children:[e.jsx(g,{children:"Parent Group"}),e.jsxs(G,{onValueChange:t.onChange,children:[e.jsx(p,{children:e.jsx(M,{children:e.jsx(O,{placeholder:"Select Parent"})})}),e.jsx(F,{children:u?e.jsx(L,{}):d==null?void 0:d.filter(r=>(r==null?void 0:r.name)!=="Assets"&&(r==null?void 0:r.name)!=="Liabilities"&&(r==null?void 0:r.name)!=="Equity"&&(r==null?void 0:r.name)!=="Expenses"&&(r==null?void 0:r.name)!=="Owner's Equity").map(r=>e.jsx(N,{value:String(r.id),children:r.name},r.id))})]}),e.jsx(f,{})]})}),e.jsx(j,{control:i.control,name:"name",render:({field:t})=>e.jsxs(m,{children:[e.jsx(g,{children:"Account Name"}),e.jsx(p,{children:e.jsx(A,{placeholder:"Enter ledger account name",...t})}),e.jsx(f,{})]})}),e.jsx(j,{control:i.control,name:"code",render:({field:t})=>e.jsxs(m,{children:[e.jsx(g,{children:"Code"}),e.jsx(p,{children:e.jsx(A,{placeholder:"Enter code",...t,value:t.value||""})}),e.jsx(f,{})]})})]}),e.jsx(j,{control:i.control,name:"nature",render:({field:t})=>e.jsxs(m,{children:[e.jsx(g,{children:"Default Account Type"}),e.jsxs(G,{onValueChange:t.onChange,children:[e.jsx(p,{children:e.jsx(M,{children:e.jsx(O,{placeholder:"Select Parent"})})}),e.jsx(F,{children:b?e.jsx(L,{}):T.map((r,X)=>e.jsx(N,{value:r.toString(),children:r.toString()},X))})]}),e.jsx(f,{})]})}),e.jsx(j,{control:i.control,name:"is_sub_type",render:({field:t})=>e.jsxs(m,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(g,{children:"Is Sub Type"})}),e.jsx(p,{children:e.jsx(be,{checked:t.value===1,onCheckedChange:r=>{t.onChange(r?1:0),o(r?1:0)}})})]})}),c===1&&e.jsx(j,{control:i.control,name:"sub_type",render:({field:t})=>e.jsxs(m,{children:[e.jsx(g,{children:"Sub Type"}),e.jsxs(G,{onValueChange:t.onChange,defaultValue:"None",children:[e.jsx(p,{children:e.jsx(M,{children:e.jsx(O,{placeholder:""})})}),e.jsxs(F,{children:[e.jsx(N,{value:"None",children:"None"}),e.jsx(N,{value:"Employee",children:"Employee"}),e.jsx(N,{value:"Customer",children:"Customer"}),e.jsx(N,{value:"Supplier",children:"Supplier"}),e.jsx(N,{value:"Agent",children:"Agent"})]})]}),e.jsx(f,{})]})}),e.jsx("div",{children:e.jsx(w,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Account"})})]})})})}const qe=()=>{const{data:n,isLoading:s}=Ce(),[a,l]=k.useState(!1),[c,o]=k.useState(!1),x=(n==null?void 0:n.data)||[];return s?e.jsx(L,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(je,{title:"Chart Of Account",description:"Manage Chart of account for you business"}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsxs(w,{onClick:()=>l(!0),size:"sm",children:[e.jsx(V,{className:"mr-2 h-4 w-4"})," Add Group"]}),e.jsxs(w,{onClick:()=>o(!0),size:"sm",children:[e.jsx(V,{className:"mr-2 h-4 w-4"})," Add Account"]})]})]}),e.jsx(me,{}),e.jsxs(ge,{defaultValue:P[0].type,className:"w-full mt-3",children:[e.jsx(pe,{className:"w-fit",children:P.map(u=>e.jsx(ye,{value:u.type,children:u.title},u.type))}),P.map(u=>e.jsx(fe,{value:u.type,children:e.jsx(Se,{title:u.title,coaType:u.type,description:u.description,data:x})},u.type))]}),a&&e.jsx(z,{title:"Add Group",isOpen:a,toggleModal:()=>l(!1),children:e.jsx(Ae,{modalClose:()=>l(!1)})}),c&&e.jsx(z,{title:"Add Account",isOpen:c,toggleModal:()=>o(!1),children:e.jsx(Ge,{modalClose:()=>o(!1)})})]})};export{qe as default};
