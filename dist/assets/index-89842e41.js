import{a_ as U,j as e,R as _,b0 as A,b1 as l,L as H,n as Q,J as ne,b2 as ae,b3 as le,b4 as C,b5 as re,a2 as I,U as J,V as Y,W as S,X as W,Y as p,Z as g,_ as y,y as ce,z as de,$ as f,B as L,k as v,b6 as te,D as oe,b7 as ie,b8 as he,b9 as xe,ba as me,bb as je,bc as ue,bd as pe,a0 as b,I as T,be as ge,bf as ye,ah as G,ai as M,aj as O,ak as F,al as N,bg as fe,r as z,ac as be,s as B,ad as Ne,aa as $}from"./index-91b0e797.js";import{T as Ce,a as Se,b as Ae,c as Le}from"./tabs-862cf627.js";import{B as X}from"./badge-45a0f0cc.js";import{S as we}from"./switch-be3d07f1.js";const Te=U.injectEndpoints({endpoints:n=>({getLedgerGroups:n.query({query:()=>"ledger-groups?tree=1",providesTags:["ledger-groups-tree"]}),getLedgerGroupsArray:n.query({query:()=>"ledger-groups",providesTags:["ledger-groups-array"]}),createLedgerGroup:n.mutation({query:s=>({url:"ledger-groups",method:"POST",body:s}),invalidatesTags:["ledger-groups","ledger-groups-tree","ledger-groups-array"]}),removeLedgerGroup:n.mutation({query:s=>({url:`ledger-groups/${s}`,method:"DELETE"}),invalidatesTags:["ledger-groups"]}),updateLedgerGroup:n.mutation({query:({ledgerGroupId:s,updatedLedgerGroup:a})=>({url:`ledger-groups/${s}`,method:"PUT",body:a}),invalidatesTags:["ledger-groups"]})}),overrideExisting:!1}),{useGetLedgerGroupsQuery:Ee,useGetLedgerGroupsArrayQuery:Z,useCreateLedgerGroupMutation:Ge,useRemoveLedgerGroupMutation:ze,useUpdateLedgerGroupMutation:Be}=Te,K=({group:n,coaType:s,depth:a=0})=>{const r=Array(a).fill("        ").join("");return n.childs_group.map(c=>e.jsxs(_.Fragment,{children:[e.jsxs(A,{children:[e.jsxs(l,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:[r,c.name]}),e.jsx(l,{className:"py-2.5",children:c.code}),e.jsx(l,{className:"py-2.5",children:"Group"}),e.jsx(l,{className:"py-2.5"}),e.jsx(l,{className:"py-2.5"}),e.jsx(l,{className:"py-2.5"})]}),c.childs_group&&c.childs_group.length>0&&e.jsx(K,{group:c,coaType:s,depth:a+1}),c.ledgers&&c.ledgers.length>0&&c.ledgers.map(o=>e.jsxs(A,{children:[e.jsx(l,{className:"py-0 col-span-2 w-2/3",children:e.jsxs(H,{className:Q({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/detailed-general-ledger/${o.id}`,children:[r,o.name]})}),e.jsx(l,{className:"py-2.5",children:o.code}),e.jsx(l,{className:"py-2.5",children:"Account"}),e.jsx(l,{className:"py-2.5",children:e.jsx(X,{variant:"outline",children:"active"})}),e.jsx(l,{className:"py-2.5",children:"700"}),e.jsx(l,{className:"py-2.5",children:"500"})]},o.id))]},c.id))},Me=({data:n,coaType:s})=>{const a=n.find(r=>r.name===s);return a?e.jsx(ne,{className:"mt-4",children:e.jsxs(ae,{children:[e.jsx(le,{children:e.jsxs(A,{children:[e.jsx(C,{className:"py-2.5 h-8 col-span-2 w-2/3",children:"Name"}),e.jsx(C,{className:"py-2.5 h-8 w-[100px]",children:"Code"}),e.jsx(C,{className:"py-2.5 h-8",children:"Type"}),e.jsx(C,{className:"py-2.5 h-8",children:"Status"}),e.jsx(C,{className:"py-2.5 h-8",children:"Debit"}),e.jsx(C,{className:"py-2.5 h-8",children:"Credit"})]})}),e.jsxs(re,{children:[e.jsxs(A,{children:[e.jsx(l,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:a.name}),e.jsx(l,{className:"py-2.5",children:a.code}),e.jsx(l,{className:"py-2.5",children:"Group"}),e.jsx(l,{className:"py-2.5"}),e.jsx(l,{className:"py-2.5"}),e.jsx(l,{className:"py-2.5"})]}),e.jsx(K,{group:a,coaType:s,depth:1}),a.ledgers.map(r=>e.jsxs(A,{children:[e.jsx(l,{className:"py-2.5 col-span-2 w-2/3",children:e.jsxs(H,{className:Q({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/detailed-general-ledger/${r.id}`,children:["    ",r.name]})}),e.jsx(l,{className:"py-2.5",children:r.code}),e.jsx(l,{className:"py-2.5",children:"Account"}),e.jsx(l,{className:"py-2.5",children:e.jsx(X,{variant:"secondary",children:"Inactive"})}),e.jsx(l,{className:"py-2.5",children:"700"}),e.jsx(l,{className:"py-2.5",children:"500"})]},r.id))]})]})}):null},P=[{type:"Assets",title:"Assets",description:"Manage assets for your business"},{type:"Liabilities",title:"Liabilities",description:"Manage liabilities for your business"},{type:"Income",title:"Incomes",description:"Manage incomes for your business"},{type:"Expenses",title:"Expenses",description:"Manage expenses for your business"}];function Oe(n){var r,c;const s=(r=n==null?void 0:n.data)==null?void 0:r.data,a=[];if(s)for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&s[o].forEach(j=>{a.push(j)});return a.length===0&&a.push(((c=n==null?void 0:n.data)==null?void 0:c.message)||"Something went wrong. Please try again."),a}function R(n){Oe(n).forEach(a=>{I.error(a)})}function Fe({modalClose:n,rowData:s}){const[a,r]=_.useState(!1),[c,{isLoading:o}]=Ge(),{data:j,isLoading:i}=Z(),w=(j==null?void 0:j.data)||[],u=J({resolver:Y(ge),defaultValues:{parent_id:(s==null?void 0:s.id)||0}});async function E(h){try{await c(h).unwrap(),I.success("Add ledger group successfully"),n()}catch(x){R(x),console.log(x)}}return e.jsx(e.Fragment,{children:o?e.jsx("div",{className:"h-56",children:e.jsx(S,{})}):e.jsx(W,{...u,children:e.jsxs("form",{onSubmit:u.handleSubmit(E),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(p,{control:u.control,name:"parent_id",render:({field:h})=>{var x;return e.jsxs(g,{children:[e.jsx(y,{children:"Parent Group"}),e.jsxs(ce,{open:a,onOpenChange:r,modal:!0,children:[e.jsx(de,{asChild:!0,children:e.jsx(f,{children:e.jsxs(L,{variant:"outline",role:"combobox",className:v("w-full justify-between",!h.value&&"text-muted-foreground"),children:[h.value?(x=w.find(t=>t.id===Number(h.value)))==null?void 0:x.name:"Select Parent",e.jsx(te,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(oe,{className:"w-[460px] p-0",children:e.jsxs(ie,{children:[e.jsx(he,{placeholder:"Search parent group..."}),e.jsxs(xe,{children:[e.jsx(me,{children:"No parent group found."}),e.jsx(je,{children:i?e.jsx(S,{}):w.map(t=>e.jsxs(ue,{onSelect:()=>{h.onChange(String(t.id)),r(!1)},children:[e.jsx(pe,{className:v("mr-2 h-4 w-4",Number(h.value)===t.id?"opacity-100":"opacity-0")}),t.name]},t.id))})]})]})})]}),e.jsx(b,{})]})}}),e.jsx(p,{control:u.control,name:"name",render:({field:h})=>e.jsxs(g,{children:[e.jsx(y,{children:"Account Name"}),e.jsx(f,{children:e.jsx(T,{placeholder:"Enter name",...h})}),e.jsx(b,{})]})}),e.jsx(p,{control:u.control,name:"code",render:({field:h})=>e.jsxs(g,{children:[e.jsx(y,{children:"Code"}),e.jsx(f,{children:e.jsx(T,{placeholder:"Enter code",...h,value:h.value||""})}),e.jsx(b,{})]})})]}),e.jsx("div",{children:e.jsx(L,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Group"})})]})})})}const Pe=U.injectEndpoints({endpoints:n=>({getEnum:n.query({query:()=>"catalogs/enum",providesTags:["catalogs/enum"]})}),overrideExisting:!1}),{useGetEnumQuery:_e}=Pe;function Ie({modalClose:n,rowData:s,coaType:a}){var q,V;const[r,{isLoading:c}]=ye(),[o,j]=_.useState(0),{data:i,isLoading:w}=Z(),{data:u,isLoading:E}=_e(),h=(u==null?void 0:u.account_nature)||[],x=(i==null?void 0:i.data)||[],t=J({resolver:Y(fe),defaultValues:{name:(s==null?void 0:s.name)||"",parent_id:(s==null?void 0:s.id)||0,is_sub_type:0,nature:(s==null?void 0:s.nature)||""}});console.log(x);const D=t.watch("parent_id"),k=x==null?void 0:x.filter(d=>(d==null?void 0:d.id)==D);console.log((q=k[0])==null?void 0:q.type);async function ee(d){try{await r(d).unwrap(),I.success("Add ledger account successfully"),n()}catch(m){R(m),console.log(m)}}return e.jsx(e.Fragment,{children:c?e.jsx("div",{className:"h-56",children:e.jsx(S,{})}):e.jsx(W,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(ee),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(p,{control:t.control,name:"parent_id",render:({field:d})=>e.jsxs(g,{children:[e.jsx(y,{children:"Parent Group"}),e.jsxs(G,{onValueChange:d.onChange,children:[e.jsx(f,{children:e.jsx(M,{children:e.jsx(O,{placeholder:"Select Parent"})})}),e.jsx(F,{children:w?e.jsx(S,{}):x==null?void 0:x.map(m=>e.jsx(N,{value:String(m.id),children:m.name},m.id))})]}),e.jsx(b,{})]})}),e.jsx(p,{control:t.control,name:"name",render:({field:d})=>e.jsxs(g,{children:[e.jsx(y,{children:"Account Name"}),e.jsx(f,{children:e.jsx(T,{placeholder:"Enter ledger account name",...d})}),e.jsx(b,{})]})}),e.jsx(p,{control:t.control,name:"code",render:({field:d})=>e.jsxs(g,{children:[e.jsx(y,{children:"Code"}),e.jsx(f,{children:e.jsx(T,{placeholder:"Enter code",...d,value:d.value||""})}),e.jsx(b,{})]})})]}),a==="Assets"||((V=k[0])==null?void 0:V.type)==="Assets"?e.jsx(p,{control:t.control,name:"nature",render:({field:d})=>e.jsxs(g,{children:[e.jsx(y,{children:"Default Account Type"}),e.jsxs(G,{onValueChange:d.onChange,children:[e.jsx(f,{children:e.jsx(M,{children:e.jsx(O,{placeholder:"Select Parent"})})}),e.jsx(F,{children:E?e.jsx(S,{}):h.map((m,se)=>e.jsx(N,{value:m.toString(),children:m.toString()},se))})]}),e.jsx(b,{})]})}):null,e.jsx(p,{control:t.control,name:"is_sub_type",render:({field:d})=>e.jsxs(g,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(y,{children:"Is Sub Type"})}),e.jsx(f,{children:e.jsx(we,{checked:d.value===1,onCheckedChange:m=>{d.onChange(m?1:0),j(m?1:0)}})})]})}),o===1&&e.jsx(p,{control:t.control,name:"sub_type",render:({field:d})=>e.jsxs(g,{children:[e.jsx(y,{children:"Sub Type"}),e.jsxs(G,{onValueChange:d.onChange,defaultValue:"None",children:[e.jsx(f,{children:e.jsx(M,{children:e.jsx(O,{placeholder:""})})}),e.jsxs(F,{children:[e.jsx(N,{value:"None",children:"None"}),e.jsx(N,{value:"Employee",children:"Employee"}),e.jsx(N,{value:"Customer",children:"Customer"}),e.jsx(N,{value:"Supplier",children:"Supplier"}),e.jsx(N,{value:"Agent",children:"Agent"})]})]}),e.jsx(b,{})]})}),e.jsx("div",{children:e.jsx(L,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Account"})})]})})})}const $e=()=>{const{data:n,isLoading:s}=Ee(),[a,r]=z.useState(!1),[c,o]=z.useState(!1),j=(n==null?void 0:n.data)||[];return s?e.jsx(S,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(be,{title:"Chart Of Account",description:"Manage Chart of account for you business"}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsxs(L,{onClick:()=>r(!0),size:"sm",children:[e.jsx(B,{className:"mr-2 h-4 w-4"})," Add Group"]}),e.jsxs(L,{onClick:()=>o(!0),size:"sm",children:[e.jsx(B,{className:"mr-2 h-4 w-4"})," Add Account"]})]})]}),e.jsx(Ne,{}),e.jsxs(Ce,{defaultValue:P[0].type,className:"w-full mt-3",children:[e.jsx(Se,{className:"w-fit",children:P.map(i=>e.jsx(Ae,{value:i.type,children:i.title},i.type))}),P.map(i=>e.jsx(Le,{value:i.type,children:e.jsx(Me,{title:i.title,coaType:i.type,description:i.description,data:j})},i.type))]}),a&&e.jsx($,{title:"Add Group",isOpen:a,toggleModal:()=>r(!1),children:e.jsx(Fe,{modalClose:()=>r(!1)})}),c&&e.jsx($,{title:"Add Account",isOpen:c,toggleModal:()=>o(!1),children:e.jsx(Ie,{modalClose:()=>o(!1)})})]})};export{$e as default};
