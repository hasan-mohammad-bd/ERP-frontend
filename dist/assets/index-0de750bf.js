import{ay as $,az as R,r as D,aA as V,V as Y,W as Z,aB as W,a as t,Y as L,Z as K,_ as f,$ as j,a0 as y,a1 as S,I as T,a2 as p,y as _,z as H,B as g,A as I,aC as b,D as U,E as F,a3 as v,aD as B,a5 as P,a6 as k,a7 as M,a8 as J,a9 as O,aa as G,ab as Q,ac as q,ad as z,aE as X,R as ee,aF as te,ae,t as ne,af as se,ag as re}from"./index-a4833209.js";function A(a,e){const s=(e==null?void 0:e.additionalDigits)??2,n=ce(a);let r;if(n.date){const d=de(n.date,s);r=ue(d.restDateString,d.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);const c=r.getTime();let o=0,u;if(n.time&&(o=me(n.time),isNaN(o)))return new Date(NaN);if(n.timezone){if(u=he(n.timezone),isNaN(u))return new Date(NaN)}else{const d=new Date(c+o),h=new Date(0);return h.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),h.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),h}return new Date(c+o+u)}const C={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},le=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,oe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,ie=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ce(a){const e={},s=a.split(C.dateTimeDelimiter);let n;if(s.length>2)return e;if(/:/.test(s[0])?n=s[0]:(e.date=s[0],n=s[1],C.timeZoneDelimiter.test(e.date)&&(e.date=a.split(C.timeZoneDelimiter)[0],n=a.substr(e.date.length,a.length))),n){const r=C.timezone.exec(n);r?(e.time=n.replace(r[1],""),e.timezone=r[1]):e.time=n}return e}function de(a,e){const s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),n=a.match(s);if(!n)return{year:NaN,restDateString:""};const r=n[1]?parseInt(n[1]):null,c=n[2]?parseInt(n[2]):null;return{year:c===null?r:c*100,restDateString:a.slice((n[1]||n[2]).length)}}function ue(a,e){if(e===null)return new Date(NaN);const s=a.match(le);if(!s)return new Date(NaN);const n=!!s[4],r=N(s[1]),c=N(s[2])-1,o=N(s[3]),u=N(s[4]),d=N(s[5])-1;if(n)return ye(e,u,d)?xe(e,u,d):new Date(NaN);{const h=new Date(0);return!fe(e,c,o)||!je(e,r)?new Date(NaN):(h.setUTCFullYear(e,c,Math.max(r,o)),h)}}function N(a){return a?parseInt(a):1}function me(a){const e=a.match(oe);if(!e)return NaN;const s=w(e[1]),n=w(e[2]),r=w(e[3]);return pe(s,n,r)?s*$+n*R+r*1e3:NaN}function w(a){return a&&parseFloat(a.replace(",","."))||0}function he(a){if(a==="Z")return 0;const e=a.match(ie);if(!e)return 0;const s=e[1]==="+"?-1:1,n=parseInt(e[2]),r=e[3]&&parseInt(e[3])||0;return Ne(n,r)?s*(n*$+r*R):NaN}function xe(a,e,s){const n=new Date(0);n.setUTCFullYear(a,0,4);const r=n.getUTCDay()||7,c=(e-1)*7+s+1-r;return n.setUTCDate(n.getUTCDate()+c),n}const ge=[31,null,31,30,31,30,31,31,30,31,30,31];function E(a){return a%400===0||a%4===0&&a%100!==0}function fe(a,e,s){return e>=0&&e<=11&&s>=1&&s<=(ge[e]||(E(a)?29:28))}function je(a,e){return e>=1&&e<=(E(a)?366:365)}function ye(a,e,s){return e>=1&&e<=53&&s>=0&&s<=6}function pe(a,e,s){return a===24?e===0&&s===0:s>=0&&s<60&&e>=0&&e<60&&a>=0&&a<25}function Ne(a,e){return e>=0&&e<=59}function Ce({modalClose:a,data:e}){const[s,n]=D.useState({start_date:!1,end_date:!1}),[r,{isLoading:c}]=V(),o=Y({resolver:Z(W),defaultValues:{name:(e==null?void 0:e.name)||"",start_date:e!=null&&e.start_date?A(e.start_date.toString()):void 0,end_date:e!=null&&e.end_date?A(e.end_date.toString()):void 0,duration:(e==null?void 0:e.duration)||"",note:(e==null?void 0:e.note)||""}}),u=(l,i)=>{if(l&&i){const m=i.getTime()-l.getTime(),x=Math.ceil(m/(1e3*60*60*24));return`${x+1} day${x===0?"":"s"}`}return""};async function d(l){try{e&&(await r({holidayId:e.id,updatedHoliday:l}).unwrap(),v.success("Holiday updated successfully"),a())}catch(i){console.log(i)}}const h=l=>{n(i=>({...i,[l]:!i[l]}))};return D.useEffect(()=>{const l=o.getValues("start_date"),i=o.getValues("end_date");if(l&&i){const m=u(l,i);o.setValue("duration",m)}},[o]),t.jsx(t.Fragment,{children:c?t.jsx("div",{className:"h-56",children:t.jsx(L,{})}):t.jsx(K,{...o,children:t.jsxs("form",{onSubmit:o.handleSubmit(d),className:"space-y-3 mb-auto",children:[t.jsx(f,{control:o.control,name:"name",render:({field:l})=>t.jsxs(j,{children:[t.jsx(y,{children:"Holiday Name"}),t.jsx(S,{children:t.jsx(T,{type:"text",placeholder:"Enter holiday name",...l})}),t.jsx(p,{})]})}),t.jsx(f,{control:o.control,name:"start_date",render:({field:l})=>t.jsxs(j,{children:[t.jsx(y,{children:"Start Date"}),t.jsxs(_,{open:s.start_date,onOpenChange:()=>h("start_date"),children:[t.jsx(H,{asChild:!0,children:t.jsxs(g,{variant:"outline",className:`w-full justify-start text-left font-normal ${!l.value&&"text-muted-foreground"}`,children:[l.value?I(l.value,"PP"):"Pick a date",t.jsx(b,{className:"ml-auto h-4 w-4 opacity-50"})]})}),t.jsx(U,{className:"w-auto p-0",align:"start",children:t.jsx(F,{mode:"single",selected:l.value??void 0,onSelect:i=>{l.onChange(i);const m=o.getValues("end_date");if(i&&m){const x=u(i,m);o.setValue("duration",x)}},initialFocus:!0})})]}),t.jsx(p,{})]})}),t.jsx(f,{control:o.control,name:"end_date",render:({field:l})=>t.jsxs(j,{children:[t.jsx(y,{children:"End Date"}),t.jsxs(_,{open:s.end_date,onOpenChange:()=>h("end_date"),children:[t.jsx(H,{asChild:!0,children:t.jsxs(g,{variant:"outline",className:`w-full justify-start text-left font-normal ${!l.value&&"text-muted-foreground"}`,children:[l.value?I(l.value,"PP"):"Pick a date",t.jsx(b,{className:"ml-auto h-4 w-4 opacity-50"})]})}),t.jsx(U,{className:"w-auto p-0",align:"start",children:t.jsx(F,{mode:"single",selected:l.value??void 0,disabled:i=>{const m=o.getValues("start_date");return!!(m&&i<m)},onSelect:i=>{l.onChange(i);const m=o.getValues("start_date");if(m&&i){const x=u(m,i);o.setValue("duration",x)}},initialFocus:!0})})]}),t.jsx(p,{})]})}),t.jsx(f,{control:o.control,name:"duration",render:({field:l})=>t.jsxs(j,{children:[t.jsx(y,{children:"Duration"}),t.jsx(S,{children:t.jsx(T,{type:"text",placeholder:"Duration",...l,value:l.value||"",disabled:!0})}),t.jsx(p,{})]})}),t.jsx(f,{control:o.control,name:"note",render:({field:l})=>t.jsxs(j,{children:[t.jsx(y,{children:"Note"}),t.jsx(S,{children:t.jsx(T,{type:"text",placeholder:"Enter note",...l})}),t.jsx(p,{})]})}),t.jsx("div",{children:t.jsx(g,{variant:"default",type:"submit",className:"w-full mt-4",children:"Update"})})]})})})}function De({data:a}){const[e,s]=D.useState(!1),[n,r]=D.useState(!1),[c,{isLoading:o}]=B(),u=async d=>{try{await c(d),v.success("Holiday deleted successfully"),s(!1)}catch(h){console.log(h)}};return console.log(a),t.jsxs("div",{className:"flex justify-center space-x-2",children:[t.jsx(P,{children:t.jsxs(k,{children:[t.jsx(M,{asChild:!0,children:t.jsx(g,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>r(!0),children:t.jsx(J,{className:"h-4 w-4 text-foreground"})})}),t.jsx(O,{children:t.jsx("p",{children:"Update Holiday"})})]})}),t.jsx(P,{children:t.jsxs(k,{children:[t.jsx(M,{asChild:!0,children:t.jsx(g,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{s(!0)},children:t.jsx(G,{className:"h-4 w-4 text-foreground"})})}),t.jsx(O,{children:t.jsx("p",{children:"Delete Holiday"})})]})}),t.jsx(Q,{title:"Are you sure?",description:"This action cannot be undone.",name:a==null?void 0:a.name,isOpen:e,onClose:()=>s(!1),onConfirm:()=>u(a.id),loading:o}),n&&t.jsx(q,{title:"Update Holiday",isOpen:n,toggleModal:()=>r(!1),children:t.jsx(Ce,{data:a,modalClose:()=>r(!1)})})]})}const Se=[{id:"select",header:({table:a})=>t.jsx(z,{checked:a.getIsAllPageRowsSelected()||a.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:e=>a.toggleAllPageRowsSelected(!!e),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:a})=>t.jsx(z,{checked:a.getIsSelected(),onCheckedChange:e=>a.toggleSelected(!!e),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:"Name"},{accessorKey:"start_date",header:"Start Date",cell:({row:a})=>{const e=a.original.start_date;return e?new Date(e).toLocaleDateString():"N/A"}},{accessorKey:"end_date",header:"End Date",cell:({row:a})=>{const e=a.original.end_date;return e?new Date(e).toLocaleDateString():"N/A"}},{accessorKey:"duration",header:"Duration"},{accessorKey:"note",header:"Note"},{id:"actions",header:()=>t.jsx("div",{className:"text-center",children:"Actions"}),enableSorting:!1,cell:({row:a})=>t.jsx(De,{data:a.original})}],we=()=>{const a=X(),[e,s]=ee.useState({pageIndex:0,pageSize:10}),{data:n,isLoading:r}=te(`per_page=${e.pageSize}&page=${e.pageIndex+1}`),c=(n==null?void 0:n.data.map(u=>({...u,id:u.id||0})))||[],o=n==null?void 0:n.meta;return r?t.jsx(L,{}):t.jsx(t.Fragment,{children:t.jsx("div",{className:"flex flex-col",children:t.jsxs("div",{className:"flex-1 space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx(ae,{title:c.length?"Holiday List":"Add Holiday",description:"Manage your holidays"}),t.jsxs(g,{size:"sm",onClick:()=>a("/hrm/holidays/add"),children:[t.jsx(ne,{className:"mr-2 h-4 w-4"})," Add Holiday"]})]}),t.jsx(se,{}),c.length>0&&t.jsx(re,{columns:Se,data:c,paginationInfo:o,pagination:e,setPagination:s})]})})})};export{we as default};
