import{bG as R,a as e,R as P,aZ as S,b0 as x,L as z,o as Q,U as Z,aX as X,aY as W,a_ as G,a$ as D,Z as $,_ as U,bI as ee,a0 as L,a1 as B,a2 as j,a3 as m,a4 as g,y as se,z as ne,a5 as p,B as A,b as I,bJ as re,E as ae,bK as le,bL as ce,bM as de,bN as oe,bO as te,bP as ie,bQ as ue,a6 as b,I as w,a7 as H,a8 as v,bR as xe,bS as he,an as E,ao as M,ap as _,aq as F,ar as N,r as q,ai as je,t as k,aj as me,K as ge,M as pe,N as ye,Q as be,ag as V}from"./index-1c1a7b38.js";import{S as fe}from"./switch-745b70c1.js";const Ne=R.injectEndpoints({endpoints:r=>({getLedgerGroups:r.query({query:()=>"ledger-groups?tree=1",providesTags:["ledger-groups-tree"]}),getLedgerGroupsArray:r.query({query:()=>"ledger-groups",providesTags:["ledger-groups-array"]}),createLedgerGroup:r.mutation({query:s=>({url:"ledger-groups",method:"POST",body:s}),invalidatesTags:["ledger-groups","ledger-groups-tree","ledger-groups-array"]}),removeLedgerGroup:r.mutation({query:s=>({url:`ledger-groups/${s}`,method:"DELETE"}),invalidatesTags:["ledger-groups"]}),updateLedgerGroup:r.mutation({query:({ledgerGroupId:s,updatedLedgerGroup:c})=>({url:`ledger-groups/${s}`,method:"PUT",body:c}),invalidatesTags:["ledger-groups"]})}),overrideExisting:!1}),{useGetLedgerGroupsQuery:Ce,useGetLedgerGroupsArrayQuery:J,useCreateLedgerGroupMutation:Le,useRemoveLedgerGroupMutation:_e,useUpdateLedgerGroupMutation:Fe}=Ne,K=({group:r,coaType:s,depth:c=0})=>{const a=Array(c).fill("        ").join("");return r.childs_group.map(d=>e.jsxs(P.Fragment,{children:[e.jsxs(S,{children:[e.jsxs(x,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:[a,d.name]}),e.jsx(x,{className:"py-2.5",children:d.code}),e.jsx(x,{className:"py-2.5",children:"Group"})]}),d.childs_group&&d.childs_group.length>0&&e.jsx(K,{group:d,coaType:s,depth:c+1}),d.ledgers&&d.ledgers.length>0&&d.ledgers.map(u=>e.jsxs(S,{children:[e.jsx(x,{className:"py-0 col-span-2 w-2/3",children:e.jsxs(z,{className:Q({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/reports/detailed-general-ledger/${u.id}`,children:[a,u.name]})}),e.jsx(x,{className:"py-2.5",children:u.code}),e.jsx(x,{className:"py-2.5",children:"Account"})]},u.id))]},d.id))},Se=({data:r,coaType:s})=>{const c=r.find(a=>a.name===s);return c?e.jsx(Z,{className:"mt-4",children:e.jsxs(X,{children:[e.jsx(W,{children:e.jsxs(S,{children:[e.jsx(G,{className:"py-2.5 h-8 col-span-2 w-2/3",children:"Name"}),e.jsx(G,{className:"py-2.5 h-8 w-[100px]",children:"Code"}),e.jsx(G,{className:"py-2.5 h-8",children:"Type"})]})}),e.jsxs(D,{children:[e.jsxs(S,{children:[e.jsx(x,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:c.name}),e.jsx(x,{className:"py-2.5",children:c.code}),e.jsx(x,{className:"py-2.5",children:"Group"})]}),e.jsx(K,{group:c,coaType:s,depth:1}),c.ledgers.map(a=>e.jsxs(S,{children:[e.jsx(x,{className:"py-2.5 col-span-2 w-2/3",children:e.jsxs(z,{className:Q({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/detailed-general-ledger/${a.id}`,children:["    ",a.name]})}),e.jsx(x,{className:"py-2.5",children:a.code}),e.jsx(x,{className:"py-2.5",children:"Account"})]},a.id))]})]})}):null},O=[{type:"Assets",title:"Assets",description:"Manage assets for your business"},{type:"Liabilities",title:"Liabilities",description:"Manage liabilities for your business"},{type:"Income",title:"Income",description:"Manage incomes for your business"},{type:"Expenses",title:"Expenses",description:"Manage expenses for your business"},{type:"Equity",title:"Equity",description:"Manage expenses for your business"}];function Ae({modalClose:r,rowData:s}){const[c,a]=P.useState(!1),[d,{isLoading:u}]=Le(),{data:h,isLoading:i}=J(),C=(h==null?void 0:h.data)||[],f=$({resolver:U(ee),defaultValues:{parent_id:s==null?void 0:s.id}});async function T(l){try{await d(l).unwrap(),H.success("Add ledger group successfully"),r()}catch(t){v(t),console.log(t)}}return e.jsx(e.Fragment,{children:u?e.jsx("div",{className:"h-56",children:e.jsx(L,{})}):e.jsx(B,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(T),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(j,{control:f.control,name:"parent_id",render:({field:l})=>{var t;return e.jsxs(m,{children:[e.jsx(g,{children:"Parent Group"}),e.jsxs(se,{open:c,onOpenChange:a,modal:!0,children:[e.jsx(ne,{asChild:!0,children:e.jsx(p,{children:e.jsxs(A,{variant:"outline",role:"combobox",className:I("w-full justify-between",!l.value&&"text-muted-foreground"),children:[l.value?(t=C.find(y=>y.id===Number(l.value)))==null?void 0:t.name:"Select Parent",e.jsx(re,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(ae,{className:"w-[460px] p-0",children:e.jsxs(le,{children:[e.jsx(ce,{placeholder:"Search parent group..."}),e.jsxs(de,{children:[e.jsx(oe,{children:"No parent group found."}),e.jsx(te,{children:i?e.jsx(L,{}):C.map(y=>e.jsxs(ie,{onSelect:()=>{l.onChange(String(y.id)),a(!1)},children:[e.jsx(ue,{className:I("mr-2 h-4 w-4",Number(l.value)===y.id?"opacity-100":"opacity-0")}),y.name]},y.id))})]})]})})]}),e.jsx(b,{})]})}}),e.jsx(j,{control:f.control,name:"name",render:({field:l})=>e.jsxs(m,{children:[e.jsx(g,{children:"Account Name"}),e.jsx(p,{children:e.jsx(w,{placeholder:"Enter name",...l})}),e.jsx(b,{})]})}),e.jsx(j,{control:f.control,name:"code",render:({field:l})=>e.jsxs(m,{children:[e.jsx(g,{children:"Code"}),e.jsx(p,{children:e.jsx(w,{placeholder:"Enter code",...l,value:l.value||""})}),e.jsx(b,{})]})})]}),e.jsx("div",{children:e.jsx(A,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Group"})})]})})})}const we=R.injectEndpoints({endpoints:r=>({getEnum:r.query({query:()=>"catalogs/enum",providesTags:["catalogs/enum"]})}),overrideExisting:!1}),{useGetEnumQuery:Te}=we;function Ge({modalClose:r,rowData:s}){const[c,{isLoading:a}]=xe(),[d,u]=P.useState(0),{data:h,isLoading:i}=J(),{data:C,isLoading:f}=Te(),T=(C==null?void 0:C.account_nature)||[],l=(h==null?void 0:h.data)||[];console.log(l);const t=$({resolver:U(he),defaultValues:{name:(s==null?void 0:s.name)||"",parent_id:s==null?void 0:s.id,is_sub_type:0,nature:(s==null?void 0:s.nature)||""}});console.log(l);async function y(o){try{await c(o).unwrap(),H.success("Add ledger account successfully"),r()}catch(n){v(n),console.log(n)}}return e.jsx(e.Fragment,{children:a?e.jsx("div",{className:"h-56",children:e.jsx(L,{})}):e.jsx(B,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(y),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(j,{control:t.control,name:"parent_id",render:({field:o})=>e.jsxs(m,{children:[e.jsx(g,{children:"Parent Group"}),e.jsxs(E,{onValueChange:o.onChange,children:[e.jsx(p,{children:e.jsx(M,{children:e.jsx(_,{placeholder:"Select Parent"})})}),e.jsx(F,{children:i?e.jsx(L,{}):l==null?void 0:l.filter(n=>(n==null?void 0:n.name)!=="Assets"&&(n==null?void 0:n.name)!=="Liabilities"&&(n==null?void 0:n.name)!=="Equity"&&(n==null?void 0:n.name)!=="Expenses"&&(n==null?void 0:n.name)!=="Income").map(n=>e.jsx(N,{value:String(n.id),children:n.name},n.id))})]}),e.jsx(b,{})]})}),e.jsx(j,{control:t.control,name:"name",render:({field:o})=>e.jsxs(m,{children:[e.jsx(g,{children:"Account Name"}),e.jsx(p,{children:e.jsx(w,{placeholder:"Enter ledger account name",...o})}),e.jsx(b,{})]})}),e.jsx(j,{control:t.control,name:"code",render:({field:o})=>e.jsxs(m,{children:[e.jsx(g,{children:"Code"}),e.jsx(p,{children:e.jsx(w,{placeholder:"Enter code",...o,value:o.value||""})}),e.jsx(b,{})]})})]}),e.jsx(j,{control:t.control,name:"nature",render:({field:o})=>e.jsxs(m,{children:[e.jsx(g,{children:"Default Account Type"}),e.jsxs(E,{onValueChange:o.onChange,children:[e.jsx(p,{children:e.jsx(M,{children:e.jsx(_,{placeholder:"Select Parent"})})}),e.jsx(F,{children:f?e.jsx(L,{}):T.map((n,Y)=>e.jsx(N,{value:n.toString(),children:n.toString()},Y))})]}),e.jsx(b,{})]})}),e.jsx(j,{control:t.control,name:"is_sub_type",render:({field:o})=>e.jsxs(m,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(g,{children:"Is Sub Type"})}),e.jsx(p,{children:e.jsx(fe,{checked:o.value===1,onCheckedChange:n=>{o.onChange(n?1:0),u(n?1:0)}})})]})}),d===1&&e.jsx(j,{control:t.control,name:"sub_type",render:({field:o})=>e.jsxs(m,{children:[e.jsx(g,{children:"Sub Type"}),e.jsxs(E,{onValueChange:o.onChange,defaultValue:"None",children:[e.jsx(p,{children:e.jsx(M,{children:e.jsx(_,{placeholder:""})})}),e.jsxs(F,{children:[e.jsx(N,{value:"None",children:"None"}),e.jsx(N,{value:"Employee",children:"Employee"}),e.jsx(N,{value:"Customer",children:"Customer"}),e.jsx(N,{value:"Supplier",children:"Supplier"}),e.jsx(N,{value:"Agent",children:"Agent"})]})]}),e.jsx(b,{})]})}),e.jsx("div",{children:e.jsx(A,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Account"})})]})})})}const Oe=()=>{const{data:r,isLoading:s}=Ce(),[c,a]=q.useState(!1),[d,u]=q.useState(!1),h=(r==null?void 0:r.data)||[];return s?e.jsx(L,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(je,{title:"Chart Of Account",description:"Manage Chart of account for you business"}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsxs(A,{onClick:()=>a(!0),size:"sm",children:[e.jsx(k,{className:"mr-2 h-4 w-4"})," Add Group"]}),e.jsxs(A,{onClick:()=>u(!0),size:"sm",children:[e.jsx(k,{className:"mr-2 h-4 w-4"})," Add Account"]})]})]}),e.jsx(me,{}),e.jsxs(ge,{defaultValue:O[0].type,className:"w-full mt-3",children:[e.jsx(pe,{className:"w-fit",children:O.map(i=>e.jsx(ye,{value:i.type,children:i.title},i.type))}),O.map(i=>e.jsx(be,{value:i.type,children:e.jsx(Se,{title:i.title,coaType:i.type,description:i.description,data:h})},i.type))]}),c&&e.jsx(V,{title:"Add Group",isOpen:c,toggleModal:()=>a(!1),children:e.jsx(Ae,{modalClose:()=>a(!1)})}),d&&e.jsx(V,{title:"Add Account",isOpen:d,toggleModal:()=>u(!1),children:e.jsx(Ge,{modalClose:()=>u(!1)})})]})};export{Oe as default};
