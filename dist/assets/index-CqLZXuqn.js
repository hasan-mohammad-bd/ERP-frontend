import{aX as v,k as e,aZ as G,a_ as n,L as Z,n as J,F as K,a$ as D,b0 as ee,b1 as T,b2 as se,r as I,N as B,Q as R,S as M,T as Q,U as x,V as h,W as j,X as m,I as P,Y as p,ae as C,af as L,ag as w,ah as E,ai as t,B as O,b3 as ne,a0 as z,b4 as le,R as ce,b5 as re,a9 as ae,P as _,aa as de}from"./index-Dd8XAAu7.js";import{T as te,a as ie,b as oe,c as xe}from"./tabs-BXCJ2GYb.js";import{B as H}from"./badge-BPq9jFLC.js";import{M as k}from"./modal-Co1IIh7u.js";import{S as he}from"./switch-Caekwphh.js";import"./sheet-DFIQMRKP.js";const je=v.injectEndpoints({endpoints:r=>({getLedgerGroups:r.query({query:()=>"ledger-groups?tree=1",providesTags:["ledger-groups-tree"]}),getLedgerGroupsArray:r.query({query:()=>"ledger-groups",providesTags:["ledger-groups-array"]}),createLedgerGroup:r.mutation({query:s=>({url:"ledger-groups",method:"POST",body:s}),invalidatesTags:["ledger-groups","ledger-groups-tree","ledger-groups-array"]}),removeLedgerGroup:r.mutation({query:s=>({url:`ledger-groups/${s}`,method:"DELETE"}),invalidatesTags:["ledger-groups"]}),updateLedgerGroup:r.mutation({query:({ledgerGroupId:s,updatedLedgerGroup:l})=>({url:`ledger-groups/${s}`,method:"PUT",body:l}),invalidatesTags:["ledger-groups"]})}),overrideExisting:!1}),{useGetLedgerGroupsQuery:me,useGetLedgerGroupsArrayQuery:U,useCreateLedgerGroupMutation:ue,useRemoveLedgerGroupMutation:we,useUpdateLedgerGroupMutation:Ee}=je,X=({group:r,coaType:s})=>r.childs_group.map(l=>e.jsxs(e.Fragment,{children:[e.jsxs(G,{children:[e.jsxs(n,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:["    ",l.name]}),e.jsx(n,{className:"py-2.5",children:l.code}),e.jsx(n,{className:"py-2.5",children:"Group"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"})]},l.id),l.childs_group.length>0&&e.jsx(X,{group:l,coaType:s}),l.ledgers.map(a=>e.jsxs(G,{children:[e.jsx(n,{className:"py-0 col-span-2 w-2/3",children:e.jsxs(Z,{className:J({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/${s}/${a.id}`,children:["    ",a.name]})}),e.jsx(n,{className:"py-2.5",children:a.code}),e.jsx(n,{className:"py-2.5",children:"Account"}),e.jsx(n,{className:"py-2.5",children:e.jsx(H,{variant:"outline",children:"active"})}),e.jsx(n,{className:"py-2.5",children:"700"}),e.jsx(n,{className:"py-2.5",children:"500"})]},a.id))]})),pe=({data:r,coaType:s})=>{const l=r.find(a=>a.name===s);return l?e.jsx(K,{className:"mt-4",children:e.jsxs(D,{children:[e.jsx(ee,{children:e.jsxs(G,{children:[e.jsx(T,{className:"py-2.5 h-8 col-span-2 w-2/3",children:"Name"}),e.jsx(T,{className:"py-2.5 h-8 w-[100px]",children:"Code"}),e.jsx(T,{className:"py-2.5 h-8",children:"Type"}),e.jsx(T,{className:"py-2.5 h-8",children:"Status"}),e.jsx(T,{className:"py-2.5 h-8",children:"Debit"}),e.jsx(T,{className:"py-2.5 h-8",children:"Credit"})]})}),e.jsxs(se,{children:[e.jsxs(G,{children:[e.jsx(n,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:l.name}),e.jsx(n,{className:"py-2.5",children:l.code}),e.jsx(n,{className:"py-2.5",children:"Group"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"})]}),e.jsx(X,{group:l,coaType:s}),l.ledgers.map(a=>e.jsxs(G,{children:[e.jsx(n,{className:"py-2.5 col-span-2 w-2/3",children:a.name}),e.jsx(n,{className:"py-2.5",children:a.code}),e.jsx(n,{className:"py-2.5",children:"Account"}),e.jsx(n,{className:"py-2.5",children:e.jsx(H,{variant:"secondary",children:"Inactive"})}),e.jsx(n,{className:"py-2.5",children:"700"}),e.jsx(n,{className:"py-2.5",children:"500"})]},a.id))]})]})}):null},$=[{type:"Assets",title:"Assets",description:"Manage assets for your business"},{type:"Liabilities",title:"Liabilities",description:"Manage liabilities for your business"},{type:"Income",title:"Incomes",description:"Manage incomes for your business"},{type:"Expenses",title:"Expenses",description:"Manage expenses for your business"}];function ye({modalClose:r,rowData:s}){const[l,{isLoading:a}]=ue(),{data:y,isLoading:f}=U(),[A,i]=I.useState("Assets"),F=(y==null?void 0:y.data)||[],u=F==null?void 0:F.filter(d=>(d==null?void 0:d.type)===A),N=B({resolver:R(ne),defaultValues:{parent_id:(s==null?void 0:s.id)||0}});async function V(d){try{await l(d),z.success("Add ledger group successfully"),r()}catch(b){console.log(b)}}return e.jsx(e.Fragment,{children:a?e.jsx("div",{className:"h-56",children:e.jsx(M,{})}):e.jsx(Q,{...N,children:e.jsxs("form",{onSubmit:N.handleSubmit(V),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(x,{control:N.control,name:"name",render:({field:d})=>e.jsxs(h,{children:[e.jsx(j,{children:"Name"}),e.jsx(m,{children:e.jsx(P,{placeholder:"Enter financial year name",...d})}),e.jsx(p,{})]})}),e.jsx(x,{control:N.control,name:"code",render:({field:d})=>e.jsxs(h,{children:[e.jsx(j,{children:"Code"}),e.jsx(m,{children:e.jsx(P,{placeholder:"Enter code",...d,value:d.value||""})}),e.jsx(p,{})]})}),e.jsx(x,{name:"",render:()=>e.jsxs(h,{children:[e.jsx(j,{children:"Account Type"}),e.jsxs(C,{value:A,onValueChange:d=>{i(d)},children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Account Type"})})}),e.jsxs(E,{children:[e.jsx(t,{value:"Assets",children:"Assets"}),e.jsx(t,{value:"Liabilities",children:"Liabilities"}),e.jsx(t,{value:"Income",children:"Incomes"}),e.jsx(t,{value:"Expenses",children:"Expenses"})]})]}),e.jsx(p,{})]})}),(u==null?void 0:u.length)>0?e.jsx(x,{control:N.control,name:"parent_id",render:({field:d})=>e.jsxs(h,{children:[e.jsx(j,{children:"Parent"}),e.jsxs(C,{onValueChange:d.onChange,children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(E,{children:f?e.jsx(M,{}):u==null?void 0:u.map(b=>e.jsx(t,{value:String(b.id),children:b.name},b.id))})]}),e.jsx(p,{})]})}):null]}),e.jsx("div",{children:e.jsx(O,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Group"})})]})})})}const ge=v.injectEndpoints({endpoints:r=>({getEnum:r.query({query:()=>"catalogs/enum",providesTags:["catalogs/enum"]})}),overrideExisting:!1}),{useGetEnumQuery:fe}=ge;function Ne({modalClose:r,rowData:s,coaType:l}){const[a,{isLoading:y}]=le(),[f,A]=ce.useState(0),{data:i,isLoading:F}=U(),{data:u,isLoading:N}=fe(),V=(u==null?void 0:u.account_nature)||[],[d,b]=I.useState("Assets"),q=(i==null?void 0:i.data)||[],S=q==null?void 0:q.filter(c=>(c==null?void 0:c.type)===d),g=B({resolver:R(re),defaultValues:{name:(s==null?void 0:s.name)||"",parent_id:(s==null?void 0:s.id)||0,is_sub_type:0,nature:(s==null?void 0:s.nature)||""}});async function Y(c){try{await a(c),z.success("Add ledger account successfully"),r()}catch(o){console.log(o)}}return e.jsx(e.Fragment,{children:y?e.jsx("div",{className:"h-56",children:e.jsx(M,{})}):e.jsx(Q,{...g,children:e.jsxs("form",{onSubmit:g.handleSubmit(Y),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(x,{control:g.control,name:"name",render:({field:c})=>e.jsxs(h,{children:[e.jsx(j,{children:"Name"}),e.jsx(m,{children:e.jsx(P,{placeholder:"Enter ledger account name",...c})}),e.jsx(p,{})]})}),e.jsx(x,{control:g.control,name:"code",render:({field:c})=>e.jsxs(h,{children:[e.jsx(j,{children:"Code"}),e.jsx(m,{children:e.jsx(P,{placeholder:"Enter code",...c,value:c.value||""})}),e.jsx(p,{})]})}),e.jsx(x,{name:"",render:()=>e.jsxs(h,{children:[e.jsx(j,{children:"Account Type"}),e.jsxs(C,{value:d,onValueChange:c=>{b(c)},children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Account Type"})})}),e.jsxs(E,{children:[e.jsx(t,{value:"Assets",children:"Assets"}),e.jsx(t,{value:"Liabilities",children:"Liabilities"}),e.jsx(t,{value:"Income",children:"Incomes"}),e.jsx(t,{value:"Expenses",children:"Expenses"})]})]}),e.jsx(p,{})]})}),(S==null?void 0:S.length)>0?e.jsx(x,{control:g.control,name:"parent_id",render:({field:c})=>e.jsxs(h,{children:[e.jsx(j,{children:"Parent"}),e.jsxs(C,{onValueChange:c.onChange,children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(E,{children:F?e.jsx(M,{}):S==null?void 0:S.map(o=>e.jsx(t,{value:String(o.id),children:o.name},o.id))})]}),e.jsx(p,{})]})}):null]}),l==="Assets"||d==="Assets"?e.jsx(x,{control:g.control,name:"nature",render:({field:c})=>e.jsxs(h,{children:[e.jsx(j,{children:"Default Account Type"}),e.jsxs(C,{onValueChange:c.onChange,children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(E,{children:N?e.jsx(M,{}):V.map((o,W)=>e.jsx(t,{value:o.toString(),children:o.toString()},W))})]}),e.jsx(p,{})]})}):null,e.jsx(x,{control:g.control,name:"is_sub_type",render:({field:c})=>e.jsxs(h,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(j,{children:"Is Sub Type"})}),e.jsx(m,{children:e.jsx(he,{checked:c.value===1,onCheckedChange:o=>{c.onChange(o?1:0),A(o?1:0)}})})]})}),f===1&&e.jsx(x,{control:g.control,name:"sub_type",render:({field:c})=>e.jsxs(h,{children:[e.jsx(j,{children:"Sub Type"}),e.jsxs(C,{onValueChange:c.onChange,defaultValue:"None",children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(w,{placeholder:""})})}),e.jsxs(E,{children:[e.jsx(t,{value:"None",children:"None"}),e.jsx(t,{value:"Employee",children:"Employee"}),e.jsx(t,{value:"Customer",children:"Customer"}),e.jsx(t,{value:"Supplier",children:"Supplier"}),e.jsx(t,{value:"Agent",children:"Agent"})]})]}),e.jsx(p,{})]})}),e.jsx("div",{children:e.jsx(O,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Account"})})]})})})}const Me=()=>{const{data:r,isLoading:s}=me(),[l,a]=I.useState(!1),[y,f]=I.useState(!1),A=(r==null?void 0:r.data)||[];return s?e.jsx(M,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{title:"Chart Of Account",description:"Manage Chart of account for you business"}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsxs(O,{onClick:()=>a(!0),size:"sm",children:[e.jsx(_,{className:"mr-2 h-4 w-4"})," Add Group"]}),e.jsxs(O,{onClick:()=>f(!0),size:"sm",children:[e.jsx(_,{className:"mr-2 h-4 w-4"})," Add Account"]})]})]}),e.jsx(de,{}),e.jsxs(te,{defaultValue:$[0].type,className:"w-full mt-3",children:[e.jsx(ie,{className:"w-fit",children:$.map(i=>e.jsx(oe,{value:i.type,children:i.title},i.type))}),$.map(i=>e.jsx(xe,{value:i.type,children:e.jsx(pe,{title:i.title,coaType:i.type,description:i.description,data:A})},i.type))]}),l&&e.jsx(k,{title:"Add Group",isOpen:l,toggleModal:()=>a(!1),children:e.jsx(ye,{modalClose:()=>a(!1)})}),y&&e.jsx(k,{title:"Add Account",isOpen:y,toggleModal:()=>f(!1),children:e.jsx(Ne,{modalClose:()=>f(!1)})})]})};export{Me as default};
