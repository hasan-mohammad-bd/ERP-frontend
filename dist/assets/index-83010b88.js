import{r as d,a$ as O,G as I,H as k,a as e,ax as F,K as $,aY as S,N as R,Q as z,V as G,ac as U,ad as H,Y as h,ae as N,aZ as K,af as Q,ag as V,ay as E,az as J,aC as f,aD as j,aE as A,aF as Y,aG as u,aH as B,aI as Z,aJ as w,aK as C,R as q,D as W,aM as X,aN as D,aO as ee,aP as ae}from"./index-68967a8a.js";import{a as se,e as te,b as ne,c as le}from"./attendance-policy-mapping-39935be6.js";import{u as ce}from"./index-c2f1d76e.js";function b({modalClose:s,data:a}){const[t,n]=d.useState(null),[l,r]=d.useState(!1),{data:i,isLoading:c}=ce("per_page=1000&page=1"),{data:o,isLoading:m}=O("per_page=1000&page=1"),g=(i==null?void 0:i.data)||[],y=(o==null?void 0:o.data)||[],[v,{isLoading:M}]=se(),x=I({resolver:k(te),defaultValues:{employee_id:a==null?void 0:a.employee_id.toString(),attendance_policy_id:a==null?void 0:a.attendance_policy_id.toString(),effective_date:a==null?void 0:a.effective_date}}),L=p=>{p&&(n(p),x.setValue("effective_date",`${N(p,"yyyy-MM-dd")}`),r(!1))};d.useEffect(()=>{a&&n(new Date(a.effective_date))},[a]);async function T(p){try{a&&(await v({attendancePolicyId:a.id,updatedAttendancePolicy:p}).unwrap(),E.success("Policy updated successfully")),s()}catch(P){console.log(P),J(P)}}return e.jsx(e.Fragment,{children:M?e.jsx("div",{children:e.jsx(F,{})}):e.jsx($,{...x,children:e.jsxs("form",{onSubmit:x.handleSubmit(T),className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx("div",{className:"w-full",children:e.jsx(S,{loading:c,data:g,displayField:"name",valueField:"id",form:x,name:"attendance_policy_id",title:"Attendance Policy",className:"w-[460px]"})}),e.jsx("div",{className:"w-full",children:e.jsx(S,{loading:m,data:y,displayField:"first_name",valueField:"id",form:x,name:"employee_id",title:"Employee",className:"w-[460px]"})}),e.jsx(R,{control:x.control,name:"effective_date",render:()=>e.jsxs(z,{children:[e.jsx(G,{children:"Effective Date"}),e.jsxs(U,{open:l,onOpenChange:r,children:[e.jsx(H,{asChild:!0,className:"",children:e.jsxs(h,{variant:"outline",className:`w-full justify-start text-left font-normal ${!t&&"text-muted-foreground"}`,children:[t?N(t,"PP"):"Pick a date",e.jsx(K,{className:"ml-auto h-4 w-4 opacity-50"})]})}),e.jsx(Q,{className:"w-auto p-0",align:"start",children:e.jsx(V,{mode:"single",selected:t??void 0,onSelect:L,initialFocus:!0})})]})]})})]}),e.jsx("div",{className:"text-right",children:e.jsx(h,{variant:"default",type:"submit",className:"w-fit mt-4",children:a?"Update":"Add"})})]})})})}function ie({data:s}){const[a,t]=d.useState(!1),[n,l]=d.useState(!1),[r,{isLoading:i}]=ne(),c=async o=>{try{await r(o),E.success("Employee Attendance Policy deleted successfully"),t(!1)}catch(m){console.log(m)}};return e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx(f,{children:e.jsxs(j,{children:[e.jsx(A,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>l(!0),children:e.jsx(Y,{className:"h-4 w-4 text-foreground"})})}),e.jsx(u,{children:e.jsx("p",{children:"Update Attendance Policy"})})]})}),e.jsx(f,{children:e.jsx(j,{children:e.jsx(u,{children:e.jsx("p",{children:"Delete Attendance Policy"})})})}),e.jsx(f,{children:e.jsxs(j,{children:[e.jsx(A,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{t(!0)},children:e.jsx(B,{className:"h-4 w-4 text-foreground"})})}),e.jsx(u,{children:e.jsx("p",{children:"Delete Attendance Policy"})})]})}),e.jsx(Z,{title:"Are you sure?",description:"This action cannot be undone.",name:s.attendance_policy.name,isOpen:a,onClose:()=>t(!1),onConfirm:()=>c(s.id),loading:i}),n&&e.jsx(w,{title:"Update Employee Attendance Policy",isOpen:n,toggleModal:()=>l(!1),children:e.jsx(b,{data:s,modalClose:()=>l(!1)})})]})}const oe=[{id:"select",header:({table:s})=>e.jsx(C,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>s.toggleAllPageRowsSelected(!!a),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(C,{checked:s.getIsSelected(),onCheckedChange:a=>s.toggleSelected(!!a),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"effective_date",header:"Effective Date"},{header:"Policy Name",cell:({row:s})=>s.original.attendance_policy.name},{accessorKey:"",header:"Employee Name",cell:({row:s})=>{var a,t,n,l;return`${(t=(a=s.original)==null?void 0:a.employee)==null?void 0:t.first_name} ${((l=(n=s.original)==null?void 0:n.employee)==null?void 0:l.last_name)??""}`}},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"Actions"}),enableSorting:!1,cell:({row:s})=>e.jsx(ie,{data:s.original})}],_={pageIndex:0,pageSize:10},xe=()=>{const[s,a]=d.useState(!1),[t,n]=q.useState(_),[l,r]=d.useState(""),i=W(),{data:c,isLoading:o}=le(`per_page=${t.pageSize}&page=${t.pageIndex+1}&text=${l}`),m=(c==null?void 0:c.data)||[],g=c==null?void 0:c.meta;return o?e.jsx(F,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(X,{title:"Manage Employee Attendance Policy",description:"Manage job apply for you business"}),e.jsxs(h,{onClick:()=>i("/hrm/employees-list"),size:"sm",children:[e.jsx(D,{className:"mr-2 h-4 w-4"})," Add Employee Attendance Policy"]})]}),e.jsx(ee,{}),m&&e.jsx("div",{children:e.jsx(ae,{columns:oe,data:m,paginationInfo:g,pagination:g&&t,setPagination:g&&n,onChangeSearch:y=>{n(_),r(y)}})})]})}),s&&e.jsx(w,{title:"Add Leave Type",isOpen:s,toggleModal:()=>a(!1),className:"",children:e.jsx(b,{modalClose:()=>a(!1)})})]})};export{xe as default};
