import{aX as k,k as e,R as B,aZ as C,a_ as n,L as R,n as z,F as ee,a$ as se,b0 as ne,b1 as A,b2 as le,N as Q,Q as H,S as L,T as U,U as j,V as m,W as u,ae as S,X as p,af as T,ag as w,ah as G,ai as g,Y as y,I as E,B as M,b3 as re,a0 as X,b4 as ce,b5 as ae,r as V,a9 as de,P as q,aa as te}from"./index-JcxNYC_Z.js";import{T as oe,a as ie,b as xe,c as he}from"./tabs-go4OZve3.js";import{B as Y}from"./badge-B3mPXXtr.js";import{M as $}from"./modal-CFAFuriY.js";import{S as je}from"./switch-xtq6QMom.js";import"./sheet-B-2L5xZc.js";const me=k.injectEndpoints({endpoints:l=>({getLedgerGroups:l.query({query:()=>"ledger-groups?tree=1",providesTags:["ledger-groups-tree"]}),getLedgerGroupsArray:l.query({query:()=>"ledger-groups",providesTags:["ledger-groups-array"]}),createLedgerGroup:l.mutation({query:s=>({url:"ledger-groups",method:"POST",body:s}),invalidatesTags:["ledger-groups","ledger-groups-tree","ledger-groups-array"]}),removeLedgerGroup:l.mutation({query:s=>({url:`ledger-groups/${s}`,method:"DELETE"}),invalidatesTags:["ledger-groups"]}),updateLedgerGroup:l.mutation({query:({ledgerGroupId:s,updatedLedgerGroup:a})=>({url:`ledger-groups/${s}`,method:"PUT",body:a}),invalidatesTags:["ledger-groups"]})}),overrideExisting:!1}),{useGetLedgerGroupsQuery:ue,useGetLedgerGroupsArrayQuery:W,useCreateLedgerGroupMutation:pe,useRemoveLedgerGroupMutation:Ge,useUpdateLedgerGroupMutation:Ee}=me,Z=({group:l,coaType:s,depth:a=0})=>{const d=Array(a).fill("        ").join("");return l.childs_group.map(t=>e.jsxs(B.Fragment,{children:[e.jsxs(C,{children:[e.jsxs(n,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:[d,t.name]}),e.jsx(n,{className:"py-2.5",children:t.code}),e.jsx(n,{className:"py-2.5",children:"Group"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"})]}),t.childs_group.length>0&&e.jsx(Z,{group:t,coaType:s,depth:a+1}),t.ledgers.map(o=>e.jsxs(C,{children:[e.jsx(n,{className:"py-0 col-span-2 w-2/3",children:e.jsxs(R,{className:z({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/detailed-general-ledger/${o.id}`,children:[d,o.name]})}),e.jsx(n,{className:"py-2.5",children:o.code}),e.jsx(n,{className:"py-2.5",children:"Account"}),e.jsx(n,{className:"py-2.5",children:e.jsx(Y,{variant:"outline",children:"active"})}),e.jsx(n,{className:"py-2.5",children:"700"}),e.jsx(n,{className:"py-2.5",children:"500"})]},o.id))]},t.id))},ge=({data:l,coaType:s})=>{const a=l.find(d=>d.name===s);return a?e.jsx(ee,{className:"mt-4",children:e.jsxs(se,{children:[e.jsx(ne,{children:e.jsxs(C,{children:[e.jsx(A,{className:"py-2.5 h-8 col-span-2 w-2/3",children:"Name"}),e.jsx(A,{className:"py-2.5 h-8 w-[100px]",children:"Code"}),e.jsx(A,{className:"py-2.5 h-8",children:"Type"}),e.jsx(A,{className:"py-2.5 h-8",children:"Status"}),e.jsx(A,{className:"py-2.5 h-8",children:"Debit"}),e.jsx(A,{className:"py-2.5 h-8",children:"Credit"})]})}),e.jsxs(le,{children:[e.jsxs(C,{children:[e.jsx(n,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:a.name}),e.jsx(n,{className:"py-2.5",children:a.code}),e.jsx(n,{className:"py-2.5",children:"Group"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"})]}),e.jsx(Z,{group:a,coaType:s,depth:1}),a.ledgers.map(d=>e.jsxs(C,{children:[e.jsx(n,{className:"py-2.5 col-span-2 w-2/3",children:e.jsxs(R,{className:z({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/detailed-general-ledger/${d.id}`,children:["    ",d.name]})}),e.jsx(n,{className:"py-2.5",children:d.code}),e.jsx(n,{className:"py-2.5",children:"Account"}),e.jsx(n,{className:"py-2.5",children:e.jsx(Y,{variant:"secondary",children:"Inactive"})}),e.jsx(n,{className:"py-2.5",children:"700"}),e.jsx(n,{className:"py-2.5",children:"500"})]},d.id))]})]})}):null},O=[{type:"Assets",title:"Assets",description:"Manage assets for your business"},{type:"Liabilities",title:"Liabilities",description:"Manage liabilities for your business"},{type:"Income",title:"Incomes",description:"Manage incomes for your business"},{type:"Expenses",title:"Expenses",description:"Manage expenses for your business"}];function ye({modalClose:l,rowData:s}){const[a,{isLoading:d}]=pe(),{data:t,isLoading:o}=W(),f=(t==null?void 0:t.data)||[],r=Q({resolver:H(re),defaultValues:{parent_id:(s==null?void 0:s.id)||0}});async function F(i){try{await a(i),X.success("Add ledger group successfully"),l()}catch(N){console.log(N)}}return e.jsx(e.Fragment,{children:d?e.jsx("div",{className:"h-56",children:e.jsx(L,{})}):e.jsx(U,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(F),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(j,{control:r.control,name:"parent_id",render:({field:i})=>e.jsxs(m,{children:[e.jsx(u,{children:"Parent Group"}),e.jsxs(S,{onValueChange:i.onChange,children:[e.jsx(p,{children:e.jsx(T,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(G,{children:o?e.jsx(L,{}):f==null?void 0:f.map(N=>e.jsx(g,{value:String(N.id),children:N.name},N.id))})]}),e.jsx(y,{})]})}),e.jsx(j,{control:r.control,name:"name",render:({field:i})=>e.jsxs(m,{children:[e.jsx(u,{children:"Account Name"}),e.jsx(p,{children:e.jsx(E,{placeholder:"Enter name",...i})}),e.jsx(y,{})]})}),e.jsx(j,{control:r.control,name:"code",render:({field:i})=>e.jsxs(m,{children:[e.jsx(u,{children:"Code"}),e.jsx(p,{children:e.jsx(E,{placeholder:"Enter code",...i,value:i.value||""})}),e.jsx(y,{})]})})]}),e.jsx("div",{children:e.jsx(M,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Group"})})]})})})}const fe=k.injectEndpoints({endpoints:l=>({getEnum:l.query({query:()=>"catalogs/enum",providesTags:["catalogs/enum"]})}),overrideExisting:!1}),{useGetEnumQuery:Ne}=fe;function be({modalClose:l,rowData:s,coaType:a}){var _,I;const[d,{isLoading:t}]=ce(),[o,f]=B.useState(0),{data:r,isLoading:F}=W(),{data:i,isLoading:N}=Ne(),J=(i==null?void 0:i.account_nature)||[],b=(r==null?void 0:r.data)||[],h=Q({resolver:H(ae),defaultValues:{name:(s==null?void 0:s.name)||"",parent_id:(s==null?void 0:s.id)||0,is_sub_type:0,nature:(s==null?void 0:s.nature)||""}});console.log(b);const K=h.watch("parent_id"),P=b==null?void 0:b.filter(c=>(c==null?void 0:c.id)==K);console.log((_=P[0])==null?void 0:_.type);async function v(c){try{await d(c),X.success("Add ledger account successfully"),l()}catch(x){console.log(x)}}return e.jsx(e.Fragment,{children:t?e.jsx("div",{className:"h-56",children:e.jsx(L,{})}):e.jsx(U,{...h,children:e.jsxs("form",{onSubmit:h.handleSubmit(v),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(j,{control:h.control,name:"parent_id",render:({field:c})=>e.jsxs(m,{children:[e.jsx(u,{children:"Parent Group"}),e.jsxs(S,{onValueChange:c.onChange,children:[e.jsx(p,{children:e.jsx(T,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(G,{children:F?e.jsx(L,{}):b==null?void 0:b.map(x=>e.jsx(g,{value:String(x.id),children:x.name},x.id))})]}),e.jsx(y,{})]})}),e.jsx(j,{control:h.control,name:"name",render:({field:c})=>e.jsxs(m,{children:[e.jsx(u,{children:"Account Name"}),e.jsx(p,{children:e.jsx(E,{placeholder:"Enter ledger account name",...c})}),e.jsx(y,{})]})}),e.jsx(j,{control:h.control,name:"code",render:({field:c})=>e.jsxs(m,{children:[e.jsx(u,{children:"Code"}),e.jsx(p,{children:e.jsx(E,{placeholder:"Enter code",...c,value:c.value||""})}),e.jsx(y,{})]})})]}),a==="Assets"||((I=P[0])==null?void 0:I.type)==="Assets"?e.jsx(j,{control:h.control,name:"nature",render:({field:c})=>e.jsxs(m,{children:[e.jsx(u,{children:"Default Account Type"}),e.jsxs(S,{onValueChange:c.onChange,children:[e.jsx(p,{children:e.jsx(T,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(G,{children:N?e.jsx(L,{}):J.map((x,D)=>e.jsx(g,{value:x.toString(),children:x.toString()},D))})]}),e.jsx(y,{})]})}):null,e.jsx(j,{control:h.control,name:"is_sub_type",render:({field:c})=>e.jsxs(m,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(u,{children:"Is Sub Type"})}),e.jsx(p,{children:e.jsx(je,{checked:c.value===1,onCheckedChange:x=>{c.onChange(x?1:0),f(x?1:0)}})})]})}),o===1&&e.jsx(j,{control:h.control,name:"sub_type",render:({field:c})=>e.jsxs(m,{children:[e.jsx(u,{children:"Sub Type"}),e.jsxs(S,{onValueChange:c.onChange,defaultValue:"None",children:[e.jsx(p,{children:e.jsx(T,{children:e.jsx(w,{placeholder:""})})}),e.jsxs(G,{children:[e.jsx(g,{value:"None",children:"None"}),e.jsx(g,{value:"Employee",children:"Employee"}),e.jsx(g,{value:"Customer",children:"Customer"}),e.jsx(g,{value:"Supplier",children:"Supplier"}),e.jsx(g,{value:"Agent",children:"Agent"})]})]}),e.jsx(y,{})]})}),e.jsx("div",{children:e.jsx(M,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Account"})})]})})})}const Me=()=>{const{data:l,isLoading:s}=ue(),[a,d]=V.useState(!1),[t,o]=V.useState(!1),f=(l==null?void 0:l.data)||[];return s?e.jsx(L,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(de,{title:"Chart Of Account",description:"Manage Chart of account for you business"}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsxs(M,{onClick:()=>d(!0),size:"sm",children:[e.jsx(q,{className:"mr-2 h-4 w-4"})," Add Group"]}),e.jsxs(M,{onClick:()=>o(!0),size:"sm",children:[e.jsx(q,{className:"mr-2 h-4 w-4"})," Add Account"]})]})]}),e.jsx(te,{}),e.jsxs(oe,{defaultValue:O[0].type,className:"w-full mt-3",children:[e.jsx(ie,{className:"w-fit",children:O.map(r=>e.jsx(xe,{value:r.type,children:r.title},r.type))}),O.map(r=>e.jsx(he,{value:r.type,children:e.jsx(ge,{title:r.title,coaType:r.type,description:r.description,data:f})},r.type))]}),a&&e.jsx($,{title:"Add Group",isOpen:a,toggleModal:()=>d(!1),children:e.jsx(ye,{modalClose:()=>d(!1)})}),t&&e.jsx($,{title:"Add Account",isOpen:t,toggleModal:()=>o(!1),children:e.jsx(be,{modalClose:()=>o(!1)})})]})};export{Me as default};
