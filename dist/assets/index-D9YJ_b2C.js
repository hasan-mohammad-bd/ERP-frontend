import{o as O,j as e,L as Y,r as M,A as q,R as J}from"./index-Cf2D7OQV.js";import{u as $,t as R,L as k,F as B,a as u,b as j,c as h,S as C,d as m,f as L,g as S,h as w,i as o,e as p,H as K,M as I}from"./modal-CRX6wKgW.js";import{l as W,B as V}from"./index-GeoyNztS.js";import{$ as X}from"./index-BZai77ga.js";import{T as Z,a as D,b as ee,c as se}from"./tabs-DRPcqRUP.js";import{T as E,a as c,b as ne,c as ae,d as A,e as re}from"./table-CTcDfsc8.js";import{C as ce}from"./card-Ck73ltmw.js";import{B as H}from"./badge-BI8CfH5u.js";import{I as G}from"./input-D5cdJpEH.js";import{L as le,a as te}from"./sub-account-DSjFaIfv.js";import{S as de}from"./switch-DoUD6Z4p.js";import{P}from"./sheet-CV_RbaUK.js";const ie=O.injectEndpoints({endpoints:l=>({getLedgerGroups:l.query({query:()=>"ledger-groups?tree=1",providesTags:["ledger-groups-tree"]}),getLedgerGroupsArray:l.query({query:()=>"ledger-groups",providesTags:["ledger-groups-array"]}),createLedgerGroup:l.mutation({query:s=>({url:"ledger-groups",method:"POST",body:s}),invalidatesTags:["ledger-groups","ledger-groups-tree","ledger-groups-array"]}),removeLedgerGroup:l.mutation({query:s=>({url:`ledger-groups/${s}`,method:"DELETE"}),invalidatesTags:["ledger-groups"]}),updateLedgerGroup:l.mutation({query:({ledgerGroupId:s,updatedLedgerGroup:a})=>({url:`ledger-groups/${s}`,method:"PUT",body:a}),invalidatesTags:["ledger-groups"]})}),overrideExisting:!1}),{useGetLedgerGroupsQuery:oe,useGetLedgerGroupsArrayQuery:U,useCreateLedgerGroupMutation:xe,useRemoveLedgerGroupMutation:Ee,useUpdateLedgerGroupMutation:ke}=ie,z=({group:l,coaType:s})=>l.childs_group.map(a=>e.jsxs(e.Fragment,{children:[e.jsxs(E,{children:[e.jsxs(c,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:["    ",a.name]}),e.jsx(c,{className:"py-2.5",children:a.code}),e.jsx(c,{className:"py-2.5",children:"Group"}),e.jsx(c,{className:"py-2.5"}),e.jsx(c,{className:"py-2.5"}),e.jsx(c,{className:"py-2.5"})]},a.id),a.childs_group.length>0&&e.jsx(z,{group:a,coaType:s}),a.ledgers.map(d=>e.jsxs(E,{children:[e.jsx(c,{className:"py-0 col-span-2 w-2/3",children:e.jsxs(Y,{className:W({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/${s}/${d.id}`,children:["    ",d.name]})}),e.jsx(c,{className:"py-2.5",children:d.code}),e.jsx(c,{className:"py-2.5",children:"Account"}),e.jsx(c,{className:"py-2.5",children:e.jsx(H,{variant:"outline",children:"active"})}),e.jsx(c,{className:"py-2.5",children:"700"}),e.jsx(c,{className:"py-2.5",children:"500"})]},d.id))]})),he=({data:l,coaType:s})=>{const a=l.find(d=>d.name===s);return a?e.jsx(ce,{className:"mt-4",children:e.jsxs(ne,{children:[e.jsx(ae,{children:e.jsxs(E,{children:[e.jsx(A,{className:"py-2.5 h-8 col-span-2 w-2/3",children:"Name"}),e.jsx(A,{className:"py-2.5 h-8 w-[100px]",children:"Code"}),e.jsx(A,{className:"py-2.5 h-8",children:"Type"}),e.jsx(A,{className:"py-2.5 h-8",children:"Status"}),e.jsx(A,{className:"py-2.5 h-8",children:"Debit"}),e.jsx(A,{className:"py-2.5 h-8",children:"Credit"})]})}),e.jsxs(re,{children:[e.jsxs(E,{children:[e.jsx(c,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:a.name}),e.jsx(c,{className:"py-2.5",children:a.code}),e.jsx(c,{className:"py-2.5",children:"Group"}),e.jsx(c,{className:"py-2.5"}),e.jsx(c,{className:"py-2.5"}),e.jsx(c,{className:"py-2.5"})]}),e.jsx(z,{group:a,coaType:s}),a.ledgers.map(d=>e.jsxs(E,{children:[e.jsx(c,{className:"py-2.5 col-span-2 w-2/3",children:d.name}),e.jsx(c,{className:"py-2.5",children:d.code}),e.jsx(c,{className:"py-2.5",children:"Account"}),e.jsx(c,{className:"py-2.5",children:e.jsx(H,{variant:"secondary",children:"Inactive"})}),e.jsx(c,{className:"py-2.5",children:"700"}),e.jsx(c,{className:"py-2.5",children:"500"})]},d.id))]})]})}):null},F=[{type:"Assets",title:"Assets",description:"Manage assets for your business"},{type:"Liabilities",title:"Liabilities",description:"Manage liabilities for your business"},{type:"Income",title:"Incomes",description:"Manage incomes for your business"},{type:"Expenses",title:"Expenses",description:"Manage expenses for your business"}];function ue({modalClose:l,rowData:s}){const[a,{isLoading:d}]=xe(),{data:g,isLoading:f}=U(),[b,i]=M.useState("Assets"),_=(g==null?void 0:g.data)||[],x=_==null?void 0:_.filter(t=>(t==null?void 0:t.type)===b),N=$({resolver:R(le),defaultValues:{parent_id:(s==null?void 0:s.id)||0}});async function T(t){try{await a(t),q.success("Add ledger group successfully"),l()}catch(n){console.log(n)}}return e.jsx(e.Fragment,{children:d?e.jsx("div",{className:"h-56",children:e.jsx(k,{})}):e.jsx(B,{...N,children:e.jsxs("form",{onSubmit:N.handleSubmit(T),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(u,{name:"",render:()=>e.jsxs(j,{children:[e.jsx(h,{children:"Account Type"}),e.jsxs(C,{value:b,onValueChange:t=>{i(t)},children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(S,{placeholder:"Select Account Type"})})}),e.jsxs(w,{children:[e.jsx(o,{value:"Assets",children:"Assets"}),e.jsx(o,{value:"Liabilities",children:"Liabilities"}),e.jsx(o,{value:"Income",children:"Incomes"}),e.jsx(o,{value:"Expenses",children:"Expenses"})]})]}),e.jsx(p,{})]})}),(x==null?void 0:x.length)>0?e.jsx(u,{control:N.control,name:"parent_id",render:({field:t})=>e.jsxs(j,{children:[e.jsx(h,{children:"Parent"}),e.jsxs(C,{onValueChange:t.onChange,children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(S,{placeholder:"Select Parent"})})}),e.jsx(w,{children:f?e.jsx(k,{}):x==null?void 0:x.map(n=>e.jsx(o,{value:String(n.id),children:n.name},n.id))})]}),e.jsx(p,{})]})}):null]}),e.jsx(u,{control:N.control,name:"code",render:({field:t})=>e.jsxs(j,{children:[e.jsx(h,{children:"Code"}),e.jsx(m,{children:e.jsx(G,{placeholder:"Enter code",...t,value:t.value||""})}),e.jsx(p,{})]})}),e.jsx(u,{control:N.control,name:"name",render:({field:t})=>e.jsxs(j,{children:[e.jsx(h,{children:"Name"}),e.jsx(m,{children:e.jsx(G,{placeholder:"Enter financial year name",...t})}),e.jsx(p,{})]})}),e.jsx("div",{children:e.jsx(V,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Group"})})]})})})}const je=O.injectEndpoints({endpoints:l=>({getLedgerAccounts:l.query({query:()=>"ledger-accounts",providesTags:["ledger-accounts"]}),createLedgerAccount:l.mutation({query:s=>({url:"ledger-accounts",method:"POST",body:s}),invalidatesTags:["ledger-accounts","ledger-groups-tree","ledger-groups-array"]}),removeLedgerAccount:l.mutation({query:s=>({url:`ledger-accounts/${s}`,method:"DELETE"}),invalidatesTags:["ledger-accounts","ledger-groups-tree","ledger-groups-array"]}),updateLedgerAccount:l.mutation({query:({ledgerAccountId:s,updatedLedgerAccount:a})=>({url:`ledger-accounts/${s}`,method:"PUT",body:a}),invalidatesTags:["ledger-accounts","ledger-groups"]})}),overrideExisting:!1}),{useGetLedgerAccountsQuery:ve,useCreateLedgerAccountMutation:me,useRemoveLedgerAccountMutation:Me,useUpdateLedgerAccountMutation:Ve}=je;function pe({modalClose:l,rowData:s,coaType:a}){const[d,{isLoading:g}]=me(),[f,b]=J.useState(0),{data:i,isLoading:_}=U(),[x,N]=M.useState("Assets"),T=(i==null?void 0:i.data)||[],t=T==null?void 0:T.filter(r=>(r==null?void 0:r.type)===x),n=$({resolver:R(te),defaultValues:{parent_id:(s==null?void 0:s.id)||0,is_fixed_asset:0,is_stock:0,is_cash_nature:0,is_bank_nature:0,is_sub_type:0}});async function Q(r){try{await d(r),q.success("Add ledger account successfully"),l()}catch(y){console.log(y)}}const v=r=>{a==="Assets"||x==="Assets"?(n.setValue("is_fixed_asset",r==="is_fixed_asset"?1:0),n.setValue("is_stock",r==="is_stock"?1:0),n.setValue("is_cash_nature",r==="is_cash_nature"?1:0),n.setValue("is_bank_nature",r==="is_bank_nature"?1:0)):(n.setValue("is_fixed_asset",0),n.setValue("is_stock",0),n.setValue("is_cash_nature",0),n.setValue("is_bank_nature",0))};return e.jsx(e.Fragment,{children:g?e.jsx("div",{className:"h-56",children:e.jsx(k,{})}):e.jsx(B,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(Q),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(u,{name:"",render:()=>e.jsxs(j,{children:[e.jsx(h,{children:"Account Type"}),e.jsxs(C,{value:x,onValueChange:r=>{N(r)},children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(S,{placeholder:"Select Account Type"})})}),e.jsxs(w,{children:[e.jsx(o,{value:"Assets",children:"Assets"}),e.jsx(o,{value:"Liabilities",children:"Liabilities"}),e.jsx(o,{value:"Income",children:"Incomes"}),e.jsx(o,{value:"Expenses",children:"Expenses"})]})]}),e.jsx(p,{})]})}),(t==null?void 0:t.length)>0?e.jsx(u,{control:n.control,name:"parent_id",render:({field:r})=>e.jsxs(j,{children:[e.jsx(h,{children:"Parent"}),e.jsxs(C,{onValueChange:r.onChange,children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(S,{placeholder:"Select Parent"})})}),e.jsx(w,{children:_?e.jsx(k,{}):t==null?void 0:t.map(y=>e.jsx(o,{value:String(y.id),children:y.name},y.id))})]}),e.jsx(p,{})]})}):null]}),e.jsx(u,{control:n.control,name:"code",render:({field:r})=>e.jsxs(j,{children:[e.jsx(h,{children:"Code"}),e.jsx(m,{children:e.jsx(G,{placeholder:"Enter code",...r,value:r.value||""})}),e.jsx(p,{})]})}),e.jsx(u,{control:n.control,name:"name",render:({field:r})=>e.jsxs(j,{children:[e.jsx(h,{children:"Name"}),e.jsx(m,{children:e.jsx(G,{placeholder:"Enter ledger account name",...r})}),e.jsx(p,{})]})}),a==="Assets"||x==="Assets"?e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Nature"}),e.jsxs("div",{className:"flex items-center text-sm space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"nature",checked:!!n.watch("is_fixed_asset"),onChange:()=>v("is_fixed_asset")}),e.jsx("span",{children:"Fixed Asset"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"nature",checked:!!n.watch("is_stock"),onChange:()=>v("is_stock")}),e.jsx("span",{children:"Stock"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"nature",checked:!!n.watch("is_cash_nature"),onChange:()=>v("is_cash_nature")}),e.jsx("span",{children:"Cash Nature"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"nature",checked:!!n.watch("is_bank_nature"),onChange:()=>v("is_bank_nature")}),e.jsx("span",{children:"Bank Nature"})]})]})]}):null,e.jsx(u,{control:n.control,name:"is_sub_type",render:({field:r})=>e.jsxs(j,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(h,{children:"Is Sub Type"})}),e.jsx(m,{children:e.jsx(de,{checked:r.value===1,onCheckedChange:y=>{r.onChange(y?1:0),b(y?1:0)}})})]})}),f===1&&e.jsx(u,{control:n.control,name:"sub_type",render:({field:r})=>e.jsxs(j,{children:[e.jsx(h,{children:"Sub Type"}),e.jsxs(C,{onValueChange:r.onChange,defaultValue:"None",children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(S,{placeholder:""})})}),e.jsxs(w,{children:[e.jsx(o,{value:"None",children:"None"}),e.jsx(o,{value:"Employee",children:"Employee"}),e.jsx(o,{value:"Customer",children:"Customer"}),e.jsx(o,{value:"Supplier",children:"Supplier"}),e.jsx(o,{value:"Agent",children:"Agent"})]})]}),e.jsx(p,{})]})}),e.jsx("div",{children:e.jsx(V,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Account"})})]})})})}const Ge=()=>{const{data:l,isLoading:s}=oe(),[a,d]=M.useState(!1),[g,f]=M.useState(!1),b=(l==null?void 0:l.data)||[];return s?e.jsx(k,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(K,{title:"Chart Of Account",description:"Manage Chart of account for you business"}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsxs(V,{onClick:()=>d(!0),size:"sm",children:[e.jsx(P,{className:"mr-2 h-4 w-4"})," Add Group"]}),e.jsxs(V,{onClick:()=>f(!0),size:"sm",children:[e.jsx(P,{className:"mr-2 h-4 w-4"})," Add Account"]})]})]}),e.jsx(X,{}),e.jsxs(Z,{defaultValue:F[0].type,className:"w-full mt-3",children:[e.jsx(D,{className:"w-fit",children:F.map(i=>e.jsx(ee,{value:i.type,children:i.title},i.type))}),F.map(i=>e.jsx(se,{value:i.type,children:e.jsx(he,{title:i.title,coaType:i.type,description:i.description,data:b})},i.type))]}),a&&e.jsx(I,{title:"Add Group",isOpen:a,toggleModal:()=>d(!1),children:e.jsx(ue,{modalClose:()=>d(!1)})}),g&&e.jsx(I,{title:"Add Account",isOpen:g,toggleModal:()=>f(!1),children:e.jsx(pe,{modalClose:()=>f(!1)})})]})};export{Ge as default};
