import{b1 as X,k as e,R as P,b3 as S,b4 as l,L as q,n as $,S as Z,b5 as J,b6 as W,b7 as A,b8 as D,r as V,X as R,Y as B,Z as E,a0 as z,a1 as m,a2 as p,a3 as u,a4 as y,I as M,a5 as g,al as T,am as L,an as w,ao as k,ap as x,K as G,b9 as ee,a7 as H,ba as se,bb as ne,ag as ae,P as F,ah as le}from"./index-Df36uixq.js";import{T as ce,a as re,b as te,c as ie}from"./tabs-D_zzpaa7.js";import{B as Q}from"./badge-D63LJO8c.js";import{M as O}from"./modal-iNOZ8d19.js";import{S as de}from"./switch-nmg8XGbF.js";import"./sheet-Bk0mowo8.js";const oe=X.injectEndpoints({endpoints:t=>({getLedgerGroups:t.query({query:()=>"ledger-groups?tree=1",providesTags:["ledger-groups-tree"]}),getLedgerGroupsArray:t.query({query:()=>"ledger-groups",providesTags:["ledger-groups-array"]}),createLedgerGroup:t.mutation({query:s=>({url:"ledger-groups",method:"POST",body:s}),invalidatesTags:["ledger-groups","ledger-groups-tree","ledger-groups-array"]}),removeLedgerGroup:t.mutation({query:s=>({url:`ledger-groups/${s}`,method:"DELETE"}),invalidatesTags:["ledger-groups"]}),updateLedgerGroup:t.mutation({query:({ledgerGroupId:s,updatedLedgerGroup:r})=>({url:`ledger-groups/${s}`,method:"PUT",body:r}),invalidatesTags:["ledger-groups"]})}),overrideExisting:!1}),{useGetLedgerGroupsQuery:xe,useGetLedgerGroupsArrayQuery:U,useCreateLedgerGroupMutation:he,useRemoveLedgerGroupMutation:Ae,useUpdateLedgerGroupMutation:_e}=oe,Y=({group:t,coaType:s,depth:r=0})=>{const i=Array(r).fill("        ").join("");return t.childs_group.map(d=>e.jsxs(P.Fragment,{children:[e.jsxs(S,{children:[e.jsxs(l,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:[i,d.name]}),e.jsx(l,{className:"py-2.5",children:d.code}),e.jsx(l,{className:"py-2.5",children:"Group"}),e.jsx(l,{className:"py-2.5"}),e.jsx(l,{className:"py-2.5"}),e.jsx(l,{className:"py-2.5"})]}),d.childs_group.length>0&&e.jsx(Y,{group:d,coaType:s,depth:r+1}),d.ledgers.map(h=>e.jsxs(S,{children:[e.jsx(l,{className:"py-0 col-span-2 w-2/3",children:e.jsxs(q,{className:$({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/ledger-view/${h.id}`,children:[i,h.name]})}),e.jsx(l,{className:"py-2.5",children:h.code}),e.jsx(l,{className:"py-2.5",children:"Account"}),e.jsx(l,{className:"py-2.5",children:e.jsx(Q,{variant:"outline",children:"active"})}),e.jsx(l,{className:"py-2.5",children:"700"}),e.jsx(l,{className:"py-2.5",children:"500"})]},h.id))]},d.id))},je=({data:t,coaType:s})=>{const r=t.find(i=>i.name===s);return r?e.jsx(Z,{className:"mt-4",children:e.jsxs(J,{children:[e.jsx(W,{children:e.jsxs(S,{children:[e.jsx(A,{className:"py-2.5 h-8 col-span-2 w-2/3",children:"Name"}),e.jsx(A,{className:"py-2.5 h-8 w-[100px]",children:"Code"}),e.jsx(A,{className:"py-2.5 h-8",children:"Type"}),e.jsx(A,{className:"py-2.5 h-8",children:"Status"}),e.jsx(A,{className:"py-2.5 h-8",children:"Debit"}),e.jsx(A,{className:"py-2.5 h-8",children:"Credit"})]})}),e.jsxs(D,{children:[e.jsxs(S,{children:[e.jsx(l,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:r.name}),e.jsx(l,{className:"py-2.5",children:r.code}),e.jsx(l,{className:"py-2.5",children:"Group"}),e.jsx(l,{className:"py-2.5"}),e.jsx(l,{className:"py-2.5"}),e.jsx(l,{className:"py-2.5"})]}),e.jsx(Y,{group:r,coaType:s,depth:1}),r.ledgers.map(i=>e.jsxs(S,{children:[e.jsx(l,{className:"py-2.5 col-span-2 w-2/3",children:e.jsxs(q,{className:$({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/ledger-view/${i.id}`,children:["    ",i.name]})}),e.jsx(l,{className:"py-2.5",children:i.code}),e.jsx(l,{className:"py-2.5",children:"Account"}),e.jsx(l,{className:"py-2.5",children:e.jsx(Q,{variant:"secondary",children:"Inactive"})}),e.jsx(l,{className:"py-2.5",children:"700"}),e.jsx(l,{className:"py-2.5",children:"500"})]},i.id))]})]})}):null},I=[{type:"Assets",title:"Assets",description:"Manage assets for your business"},{type:"Liabilities",title:"Liabilities",description:"Manage liabilities for your business"},{type:"Income",title:"Incomes",description:"Manage incomes for your business"},{type:"Expenses",title:"Expenses",description:"Manage expenses for your business"}];function ue({modalClose:t,rowData:s}){const[r,{isLoading:i}]=he(),{data:d,isLoading:h}=U(),[N,o]=V.useState("Assets"),_=(d==null?void 0:d.data)||[],j=_==null?void 0:_.filter(c=>(c==null?void 0:c.type)===N),b=R({resolver:B(ee),defaultValues:{parent_id:(s==null?void 0:s.id)||0}});async function C(c){try{await r(c),H.success("Add ledger group successfully"),t()}catch(n){console.log(n)}}return e.jsx(e.Fragment,{children:i?e.jsx("div",{className:"h-56",children:e.jsx(E,{})}):e.jsx(z,{...b,children:e.jsxs("form",{onSubmit:b.handleSubmit(C),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(m,{control:b.control,name:"name",render:({field:c})=>e.jsxs(p,{children:[e.jsx(u,{children:"Name"}),e.jsx(y,{children:e.jsx(M,{placeholder:"Enter financial year name",...c})}),e.jsx(g,{})]})}),e.jsx(m,{control:b.control,name:"code",render:({field:c})=>e.jsxs(p,{children:[e.jsx(u,{children:"Code"}),e.jsx(y,{children:e.jsx(M,{placeholder:"Enter code",...c,value:c.value||""})}),e.jsx(g,{})]})}),e.jsx(m,{name:"",render:()=>e.jsxs(p,{children:[e.jsx(u,{children:"Account Type"}),e.jsxs(T,{value:N,onValueChange:c=>{o(c)},children:[e.jsx(y,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Account Type"})})}),e.jsxs(k,{children:[e.jsx(x,{value:"Assets",children:"Assets"}),e.jsx(x,{value:"Liabilities",children:"Liabilities"}),e.jsx(x,{value:"Income",children:"Incomes"}),e.jsx(x,{value:"Expenses",children:"Expenses"})]})]}),e.jsx(g,{})]})}),(j==null?void 0:j.length)>0?e.jsx(m,{control:b.control,name:"parent_id",render:({field:c})=>e.jsxs(p,{children:[e.jsx(u,{children:"Parent"}),e.jsxs(T,{onValueChange:c.onChange,children:[e.jsx(y,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(k,{children:h?e.jsx(E,{}):j==null?void 0:j.map(n=>e.jsx(x,{value:String(n.id),children:n.name},n.id))})]}),e.jsx(g,{})]})}):null]}),e.jsx("div",{children:e.jsx(G,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Group"})})]})})})}function me({modalClose:t,rowData:s,coaType:r}){const[i,{isLoading:d}]=se(),[h,N]=P.useState(0),{data:o,isLoading:_}=U(),[j,b]=V.useState("Assets"),C=(o==null?void 0:o.data)||[],c=C==null?void 0:C.filter(a=>(a==null?void 0:a.type)===j),n=R({resolver:B(ne),defaultValues:{parent_id:(s==null?void 0:s.id)||0,is_fixed_asset:0,is_stock:0,is_cash_nature:0,is_bank_nature:0,is_sub_type:0}});async function K(a){try{await i(a),H.success("Add ledger account successfully"),t()}catch(f){console.log(f)}}const v=a=>{r==="Assets"||j==="Assets"?(n.setValue("is_fixed_asset",a==="is_fixed_asset"?1:0),n.setValue("is_stock",a==="is_stock"?1:0),n.setValue("is_cash_nature",a==="is_cash_nature"?1:0),n.setValue("is_bank_nature",a==="is_bank_nature"?1:0)):(n.setValue("is_fixed_asset",0),n.setValue("is_stock",0),n.setValue("is_cash_nature",0),n.setValue("is_bank_nature",0))};return e.jsx(e.Fragment,{children:d?e.jsx("div",{className:"h-56",children:e.jsx(E,{})}):e.jsx(z,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(K),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(m,{control:n.control,name:"name",render:({field:a})=>e.jsxs(p,{children:[e.jsx(u,{children:"Name"}),e.jsx(y,{children:e.jsx(M,{placeholder:"Enter ledger account name",...a})}),e.jsx(g,{})]})}),e.jsx(m,{control:n.control,name:"code",render:({field:a})=>e.jsxs(p,{children:[e.jsx(u,{children:"Code"}),e.jsx(y,{children:e.jsx(M,{placeholder:"Enter code",...a,value:a.value||""})}),e.jsx(g,{})]})}),e.jsx(m,{name:"",render:()=>e.jsxs(p,{children:[e.jsx(u,{children:"Account Type"}),e.jsxs(T,{value:j,onValueChange:a=>{b(a)},children:[e.jsx(y,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Account Type"})})}),e.jsxs(k,{children:[e.jsx(x,{value:"Assets",children:"Assets"}),e.jsx(x,{value:"Liabilities",children:"Liabilities"}),e.jsx(x,{value:"Income",children:"Incomes"}),e.jsx(x,{value:"Expenses",children:"Expenses"})]})]}),e.jsx(g,{})]})}),(c==null?void 0:c.length)>0?e.jsx(m,{control:n.control,name:"parent_id",render:({field:a})=>e.jsxs(p,{children:[e.jsx(u,{children:"Parent"}),e.jsxs(T,{onValueChange:a.onChange,children:[e.jsx(y,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(k,{children:_?e.jsx(E,{}):c==null?void 0:c.map(f=>e.jsx(x,{value:String(f.id),children:f.name},f.id))})]}),e.jsx(g,{})]})}):null]}),r==="Assets"||j==="Assets"?e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Default Account Type"}),e.jsxs("div",{className:"flex items-center text-sm space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"nature",checked:!!n.watch("is_fixed_asset"),onChange:()=>v("is_fixed_asset")}),e.jsx("span",{children:"Fixed Asset"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"nature",checked:!!n.watch("is_stock"),onChange:()=>v("is_stock")}),e.jsx("span",{children:"Stock"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"nature",checked:!!n.watch("is_cash_nature"),onChange:()=>v("is_cash_nature")}),e.jsx("span",{children:"Cash Nature"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"nature",checked:!!n.watch("is_bank_nature"),onChange:()=>v("is_bank_nature")}),e.jsx("span",{children:"Bank Nature"})]})]})]}):null,e.jsx(m,{control:n.control,name:"is_sub_type",render:({field:a})=>e.jsxs(p,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(u,{children:"Is Sub Type"})}),e.jsx(y,{children:e.jsx(de,{checked:a.value===1,onCheckedChange:f=>{a.onChange(f?1:0),N(f?1:0)}})})]})}),h===1&&e.jsx(m,{control:n.control,name:"sub_type",render:({field:a})=>e.jsxs(p,{children:[e.jsx(u,{children:"Sub Type"}),e.jsxs(T,{onValueChange:a.onChange,defaultValue:"None",children:[e.jsx(y,{children:e.jsx(L,{children:e.jsx(w,{placeholder:""})})}),e.jsxs(k,{children:[e.jsx(x,{value:"None",children:"None"}),e.jsx(x,{value:"Employee",children:"Employee"}),e.jsx(x,{value:"Customer",children:"Customer"}),e.jsx(x,{value:"Supplier",children:"Supplier"}),e.jsx(x,{value:"Agent",children:"Agent"})]})]}),e.jsx(g,{})]})}),e.jsx("div",{children:e.jsx(G,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Account"})})]})})})}const Ce=()=>{const{data:t,isLoading:s}=xe(),[r,i]=V.useState(!1),[d,h]=V.useState(!1),N=(t==null?void 0:t.data)||[];return s?e.jsx(E,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{title:"Chart Of Account",description:"Manage Chart of account for you business"}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsxs(G,{onClick:()=>i(!0),size:"sm",children:[e.jsx(F,{className:"mr-2 h-4 w-4"})," Add Group"]}),e.jsxs(G,{onClick:()=>h(!0),size:"sm",children:[e.jsx(F,{className:"mr-2 h-4 w-4"})," Add Account"]})]})]}),e.jsx(le,{}),e.jsxs(ce,{defaultValue:I[0].type,className:"w-full mt-3",children:[e.jsx(re,{className:"w-fit",children:I.map(o=>e.jsx(te,{value:o.type,children:o.title},o.type))}),I.map(o=>e.jsx(ie,{value:o.type,children:e.jsx(je,{title:o.title,coaType:o.type,description:o.description,data:N})},o.type))]}),r&&e.jsx(O,{title:"Add Group",isOpen:r,toggleModal:()=>i(!1),children:e.jsx(ue,{modalClose:()=>i(!1)})}),d&&e.jsx(O,{title:"Add Account",isOpen:d,toggleModal:()=>h(!1),children:e.jsx(me,{modalClose:()=>h(!1)})})]})};export{Ce as default};
