import{aP as r,ar as G,V as J,W as Q,a as e,Y as W,Z,_ as d,$ as i,a0 as _,a1 as o,I as m,a2 as h,B as k,K as X,aC as v,aD as D,aE as q,aH as j,aG as ee,a3 as E,a4 as se,r as I,a5 as P,a6 as T,a7 as z,a8 as ne,a9 as C,aa as le,ab as ce,ac as Y,ad as U,R as ae,ae as te,t as re,af as de,ag as ie}from"./index-0a817f2a.js";import{S as A}from"./switch-9993497d.js";const oe=r.object({day:r.string().optional().nullable(),in_time:r.string(),delay_buffer_time:r.string(),ex_delay_buffer_time:r.string(),break_time:r.coerce.number(),working_hour:r.coerce.number(),out_time:r.string()}),O=r.object({name:r.string().min(2,{message:"Name must be at least 2 characters."}),in_time:r.string(),delay_buffer_time:r.string(),ex_delay_buffer_time:r.string(),break_time:r.coerce.number(),working_hour:r.coerce.number(),out_time:r.string(),ignore_overtime:r.number(),exclude_attendance_report:r.number(),discard_weekend_attendance:r.number(),days:oe.array().optional().nullable()});O.extend({id:r.coerce.number()});const xe=G.injectEndpoints({endpoints:l=>({getAttendancePolicies:l.query({query:s=>`attendance-policy?${s}`,providesTags:["attendance-policy"]}),createAttendancePolicy:l.mutation({query:s=>({url:"attendance-policy",method:"POST",body:s}),invalidatesTags:["attendance-policy"]}),removeAttendancePolicy:l.mutation({query:s=>({url:`attendance-policy/${s}`,method:"DELETE"}),invalidatesTags:["attendance-policy"]}),updateAttendancePolicy:l.mutation({query:({attendancePolicyId:s,updatedAttendancePolicy:y})=>({url:`attendance-policy/${s}`,method:"PUT",body:y}),invalidatesTags:["attendance-policy"]})}),overrideExisting:!1}),{useGetAttendancePoliciesQuery:me,useCreateAttendancePolicyMutation:he,useRemoveAttendancePolicyMutation:je,useUpdateAttendancePolicyMutation:ye}=xe,S=["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"];function V({modalClose:l,data:s}){const[y,{isLoading:f}]=he(),[x,{isLoading:u}]=ye(),c=J({resolver:Q(O),defaultValues:{name:(s==null?void 0:s.name)||"",in_time:(s==null?void 0:s.in_time)||"",delay_buffer_time:(s==null?void 0:s.delay_buffer_time)||"",ex_delay_buffer_time:(s==null?void 0:s.ex_delay_buffer_time)||"",break_time:(s==null?void 0:s.break_time)||0,working_hour:(s==null?void 0:s.working_hour)||0,out_time:(s==null?void 0:s.out_time)||"",ignore_overtime:(s==null?void 0:s.ignore_overtime)||0,exclude_attendance_report:(s==null?void 0:s.exclude_attendance_report)||0,discard_weekend_attendance:(s==null?void 0:s.discard_weekend_attendance)||0,days:S.map(n=>{var a,t,w,p,M,$,B,F,K,L,H,R;return{day:n,in_time:((t=(a=s==null?void 0:s.days)==null?void 0:a.find(g=>g.day===n))==null?void 0:t.in_time)||"",delay_buffer_time:((p=(w=s==null?void 0:s.days)==null?void 0:w.find(g=>g.day===n))==null?void 0:p.delay_buffer_time)||"",ex_delay_buffer_time:(($=(M=s==null?void 0:s.days)==null?void 0:M.find(g=>g.day===n))==null?void 0:$.ex_delay_buffer_time)||"",break_time:((F=(B=s==null?void 0:s.days)==null?void 0:B.find(g=>g.day===n))==null?void 0:F.break_time)||0,working_hour:((L=(K=s==null?void 0:s.days)==null?void 0:K.find(g=>g.day===n))==null?void 0:L.working_hour)||0,out_time:((R=(H=s==null?void 0:s.days)==null?void 0:H.find(g=>g.day===n))==null?void 0:R.out_time)||""}})}}),b=()=>{const n=c.getValues(),a=Object.keys(O.shape);S.forEach((t,w)=>{a.forEach(p=>{c.setValue(`days.${w}.${p}`,n[p])})})};async function N(n){try{s?(await x({attendancePolicyId:s.id,updatedAttendancePolicy:n}).unwrap(),E.success("Policy updated successfully"),l()):(await y(n).unwrap(),E.success("Policy created successfully"),l())}catch(a){console.log(a),se(a)}}return e.jsx(e.Fragment,{children:f||u?e.jsx("div",{children:e.jsx(W,{})}):e.jsx(Z,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(N),className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-4",children:[e.jsx(d,{control:c.control,name:"name",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"Policy Name"}),e.jsx(o,{children:e.jsx(m,{className:"h-7",placeholder:"Enter Policy Name",...n})}),e.jsx(h,{})]})}),e.jsx(d,{control:c.control,name:"in_time",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"In Time"}),e.jsx(o,{children:e.jsx(m,{type:"time",className:"h-7",...n})}),e.jsx(h,{})]})}),e.jsx(d,{control:c.control,name:"delay_buffer_time",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"Delay Buffer Time"}),e.jsx(o,{children:e.jsx(m,{type:"time",className:"h-7",...n,placeholder:"Enter Delay Buffer"})}),e.jsx(h,{})]})}),e.jsx(d,{control:c.control,name:"ex_delay_buffer_time",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"Extra Delay Buffer"}),e.jsx(o,{children:e.jsx(m,{className:"h-7",type:"time",...n})}),e.jsx(h,{})]})}),e.jsx(d,{control:c.control,name:"break_time",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"Break Time (in minutes)"}),e.jsx(o,{children:e.jsx(m,{className:"h-7",type:"number",...n,placeholder:"Enter Break Time"})}),e.jsx(h,{})]})}),e.jsx(d,{control:c.control,name:"working_hour",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"Working Hours"}),e.jsx(o,{children:e.jsx(m,{className:"h-7",type:"text",...n,placeholder:"Enter Working Hours"})}),e.jsx(h,{})]})}),e.jsx(d,{control:c.control,name:"out_time",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"Out Time"}),e.jsx(o,{children:e.jsx(m,{className:"h-7",type:"time",...n,placeholder:"Enter Out Time"})}),e.jsx(h,{})]})})]}),e.jsx("div",{}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[e.jsx(d,{control:c.control,name:"ignore_overtime",render:({field:n})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm h-10",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(_,{children:"Ignore Overtime"})}),e.jsx(o,{children:e.jsx(A,{className:"!mt-0 ",checked:n.value===1,onCheckedChange:a=>n.onChange(a?1:0)})})]})}),e.jsx(d,{control:c.control,name:"discard_weekend_attendance",render:({field:n})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm h-10",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(_,{children:"Discard attendance on weekend"})}),e.jsx(o,{children:e.jsx(A,{className:"!mt-0 ",checked:n.value===1,onCheckedChange:a=>n.onChange(a?1:0)})})]})}),e.jsx(d,{control:c.control,name:"exclude_attendance_report",render:({field:n})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm h-10",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(_,{children:"Exclude from attendance report"})}),e.jsx(o,{children:e.jsx(A,{className:"!mt-0 ",checked:n.value===1,onCheckedChange:a=>n.onChange(a?1:0)})})]})})]}),e.jsx(k,{variant:"default",type:"button",onClick:b,children:"Copy to 7 days"}),e.jsx(X,{children:e.jsxs(v,{children:[e.jsx(D,{children:e.jsxs(q,{className:"text-left text-xs",children:[e.jsx(j,{className:"p-1 text-xs",children:"Day"}),e.jsx(j,{className:"p-1 text-xs",children:"In Time"}),e.jsx(j,{className:"p-1 text-xs",children:"Delay Buffer Time"}),e.jsx(j,{className:"p-1 text-xs",children:"Extra Delay Buffer"}),e.jsx(j,{className:"p-1 text-xs",children:"Break Time (In Min)"}),e.jsx(j,{className:"p-1 text-xs",children:"Working Hours (In Hours)"}),e.jsx(j,{className:"p-1 text-xs",children:"Out Time"})]})}),e.jsx(ee,{className:"divide-y",children:S.map((n,a)=>e.jsxs(q,{children:[e.jsx(j,{className:"p-1 text-xs",children:e.jsx(d,{control:c.control,name:`days.${a}.day`,render:()=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(m,{className:"p-1 text-xs h-7",value:n,readOnly:!0})}),e.jsx(h,{})]})})}),e.jsx(j,{className:"p-1",children:e.jsx("div",{className:"flex-1",children:e.jsx(d,{control:c.control,name:`days.${a}.in_time`,render:({field:t})=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(m,{className:"p-1 text-xs h-7",type:"time",placeholder:"Enter In Time",...t,value:t.value||""})}),e.jsx(h,{})]})})})}),e.jsx(j,{className:"p-1",children:e.jsx("div",{className:"flex-1",children:e.jsx(d,{control:c.control,name:`days.${a}.delay_buffer_time`,render:({field:t})=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(m,{className:"p-1 text-xs h-7",type:"time",placeholder:"Enter In Time",...t,value:t.value||""})}),e.jsx(h,{})]})})})}),e.jsx(j,{className:"p-1",children:e.jsx("div",{className:"flex-1",children:e.jsx(d,{control:c.control,name:`days.${a}.ex_delay_buffer_time`,render:({field:t})=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(m,{className:"p-1 text-xs h-7",type:"time",placeholder:"Enter In Time",...t,value:t.value||""})}),e.jsx(h,{})]})})})}),e.jsx(j,{className:"p-1",children:e.jsx("div",{className:"flex-1",children:e.jsx(d,{control:c.control,name:`days.${a}.break_time`,render:({field:t})=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(m,{type:"number",className:"p-1 text-xs h-7",...t,value:t.value||""})}),e.jsx(h,{})]})})})}),e.jsx(j,{className:"p-1",children:e.jsx("div",{className:"flex-1",children:e.jsx(d,{control:c.control,name:`days.${a}.working_hour`,render:({field:t})=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(m,{type:"number",className:"p-1 text-xs h-7",...t,value:t.value||""})}),e.jsx(h,{})]})})})}),e.jsx(j,{children:e.jsx(d,{control:c.control,name:`days.${a}.out_time`,render:({field:t})=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(m,{className:"p-1 text-xs h-7",type:"time",...t,value:t.value||""})}),e.jsx(h,{})]})})})]},a))})]})}),e.jsx("div",{className:"text-right",children:e.jsx(k,{variant:"default",type:"submit",className:"w-fit mt-4",children:s?"Update":"Add"})})]})})})}function ge({data:l}){const[s,y]=I.useState(!1),[f,x]=I.useState(!1),[u,{isLoading:c}]=je(),b=async N=>{try{await u(N),E.success("Policy deleted successfully"),y(!1)}catch(n){console.log(n)}};return e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx(P,{children:e.jsxs(T,{children:[e.jsx(z,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>x(!0),children:e.jsx(ne,{className:"h-4 w-4 text-foreground"})})}),e.jsx(C,{children:e.jsx("p",{children:"Update Job Post"})})]})}),e.jsx(P,{children:e.jsx(T,{children:e.jsx(C,{children:e.jsx("p",{children:"Delete Requisition"})})})}),e.jsx(P,{children:e.jsxs(T,{children:[e.jsx(z,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{y(!0)},children:e.jsx(le,{className:"h-4 w-4 text-foreground"})})}),e.jsx(C,{children:e.jsx("p",{children:"Delete Policy"})})]})}),e.jsx(ce,{title:"Are you sure?",description:"This action cannot be undone.",name:l.name,isOpen:s,onClose:()=>y(!1),onConfirm:()=>b(l.id),loading:c}),f&&e.jsx(Y,{title:"Update Policy",isOpen:f,toggleModal:()=>x(!1),className:"w-[90%] max-w-6xl",children:e.jsx(V,{data:l,modalClose:()=>x(!1)})})]})}const _e=[{id:"select",header:({table:l})=>e.jsx(U,{checked:l.getIsAllPageRowsSelected()||l.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:s=>l.toggleAllPageRowsSelected(!!s),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:l})=>e.jsx(U,{checked:l.getIsSelected(),onCheckedChange:s=>l.toggleSelected(!!s),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:"Policy Name"},{accessorKey:"in_time",header:"In Time"},{accessorKey:"delay_buffer_time",header:"Delay Buffer"},{accessorKey:"ex_delay_buffer_time",header:"Ex Delay Buffer"},{accessorKey:"break_time",header:"Break Time"},{accessorKey:"working_hour",header:"Working Hours"},{accessorKey:"out_time",header:"Out Time"},{accessorKey:"ignore_overtime",header:"Ignore Overtime",cell:({row:l})=>l.original.ignore_overtime===1?"Yes":"No"},{accessorKey:"exclude_attendance_report",header:"Ignore from att report",cell:({row:l})=>l.original.exclude_attendance_report===1?"Yes":"No"},{accessorKey:"discard_weekend_attendance",header:"Discard attendance on weekend",cell:({row:l})=>l.original.discard_weekend_attendance===1?"Yes":"No"},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"Actions"}),enableSorting:!1,cell:({row:l})=>e.jsx(ge,{data:l.original})}],be=()=>{const[l,s]=I.useState(!1),[y,f]=ae.useState({pageIndex:0,pageSize:10}),{data:x,isLoading:u}=me(`per_page=${y.pageSize}&page=${y.pageIndex+1}`),c=(x==null?void 0:x.data)||[];console.log(x,"hello");const b=(x==null?void 0:x.data)||[],N=x==null?void 0:x.meta;return u?e.jsx(W,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(te,{title:"Attendance Policy",description:"Manage job apply for you business"}),e.jsxs(k,{onClick:()=>s(!0),size:"sm",children:[e.jsx(re,{className:"mr-2 h-4 w-4"})," Add Attendance Policy"]})]}),e.jsx(de,{}),b&&e.jsx("div",{children:e.jsx(ie,{columns:_e,data:c,paginationInfo:N,pagination:y,setPagination:f})})]})}),l&&e.jsx(Y,{title:"Add Attendance Policy",isOpen:l,toggleModal:()=>s(!1),className:"w-2/3 max-w-5xl",children:e.jsx(V,{modalClose:()=>s(!1)})})]})};export{be as default};
