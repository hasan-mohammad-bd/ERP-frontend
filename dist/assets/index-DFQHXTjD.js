import{h as v,j as e,A as O,r as b,R as W}from"./index-Cf2D7OQV.js";import{u as K,t as G,L as f,F as Q,a as S,b as A,c as C,S as L,d as J,f as I,g as M,h as k,i as E,e as w,M as P,H as Y}from"./modal-CRX6wKgW.js";import{c as D,B as N}from"./index-GeoyNztS.js";import{$ as ee}from"./index-BZai77ga.js";import{T as q,a as V,b as U,P as se,c as R,d as le,A as te,C as B,D as ae}from"./alert-modal-Bzk7JzYp.js";import{I as H}from"./input-D5cdJpEH.js";import{J as ne,C as ce}from"./validators-BX52zV_6.js";import{u as oe}from"./index-Ch9EajTd.js";import{u as ie}from"./index-CJKErHch.js";import{Z as de}from"./zoom-in-BnTz7Aru.js";import{P as re}from"./sheet-CV_RbaUK.js";import"./table-CTcDfsc8.js";import"./dropdown-menu-BUtIsn1g.js";import"./chevron-right-BgiJnq1K.js";import"./card-Ck73ltmw.js";/**
 * @license lucide-react v0.356.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=D("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),pe=v.injectEndpoints({endpoints:l=>({getJobApplies:l.query({query:s=>`job-applies?${s}`,providesTags:["job-applies"]}),getJobApplyStatusData:l.query({query:()=>"job-applies/additional/list",providesTags:["job-applies-status"]}),createJobApply:l.mutation({query:s=>({url:"job-applies",method:"POST",body:s}),invalidatesTags:["job-applies"]}),removeJobApply:l.mutation({query:s=>({url:`job-applies/${s}`,method:"DELETE"}),invalidatesTags:["job-applies"]}),updateJobApply:l.mutation({query:({jobApplyId:s,updatedJobApply:c})=>({url:`job-applies/${s}`,method:"PUT",body:c}),invalidatesTags:["job-applies"]})}),overrideExisting:!1}),{useGetJobAppliesQuery:he,useGetJobApplyStatusDataQuery:X,useCreateJobApplyMutation:je,useRemoveJobApplyMutation:me,useUpdateJobApplyMutation:ue}=pe;function Z({modalClose:l,data:s}){var $,z;const[c,{isLoading:u}]=je(),[n,{isLoading:m}]=ue(),{data:o,isLoading:r}=oe("page=1&per_page=1000"),{data:x,isLoading:j}=ie("page=1&per_page=1000"),{data:d,isLoading:_}=X(),F=(o==null?void 0:o.data)||[],t=(x==null?void 0:x.data)||[],i=(d==null?void 0:d.job_apply_status)||[],a=K({resolver:G(ne),defaultValues:{job_post_id:(($=s==null?void 0:s.job_post)==null?void 0:$.id)||1,job_candidate_id:((z=s==null?void 0:s.job_candidate)==null?void 0:z.id)||1,status:(s==null?void 0:s.status)||"Pending",expected_salary:(s==null?void 0:s.expected_salary)||0}});async function T(p){try{s?(await n({jobApplyId:s.id,updatedJobApply:p}),O.success("Job apply updated successfully"),l()):(await c(p),O.success("Job apply created successfully"),l())}catch(h){console.log(h)}}return e.jsx(e.Fragment,{children:u||m?e.jsx("div",{className:"",children:e.jsx(f,{})}):e.jsx(Q,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(T),className:" space-y-3 ",children:[e.jsx(S,{control:a.control,name:"job_post_id",render:({field:p})=>{var h,g;return e.jsxs(A,{children:[e.jsx(C,{children:"Job Post"}),e.jsxs(L,{onValueChange:p.onChange,defaultValue:(h=s==null?void 0:s.job_post)!=null&&h.id?String((g=s==null?void 0:s.job_post)==null?void 0:g.id):void 0,children:[e.jsx(J,{children:e.jsx(I,{children:e.jsx(M,{placeholder:"Select Department"})})}),e.jsx(k,{children:r?e.jsx(f,{}):F==null?void 0:F.map(y=>e.jsx(E,{value:String(y.id),children:y.title},y.id))})]}),e.jsx(w,{})]})}}),e.jsx(S,{control:a.control,name:"job_candidate_id",render:({field:p})=>{var h,g;return e.jsxs(A,{children:[e.jsx(C,{children:"Job Candidate"}),e.jsxs(L,{onValueChange:p.onChange,defaultValue:(h=s==null?void 0:s.job_candidate)!=null&&h.id?String((g=s==null?void 0:s.job_candidate)==null?void 0:g.id):void 0,children:[e.jsx(J,{children:e.jsx(I,{children:e.jsx(M,{placeholder:"Select Job Candidate"})})}),e.jsx(k,{children:j?e.jsx(f,{}):t==null?void 0:t.map(y=>e.jsx(E,{value:String(y.id),children:y.email},y.id))})]}),e.jsx(w,{})]})}}),e.jsx(S,{control:a.control,name:"status",render:({field:p})=>e.jsxs(A,{children:[e.jsx(C,{children:"Status"}),e.jsxs(L,{onValueChange:p.onChange,defaultValue:s!=null&&s.status?String(s==null?void 0:s.status):void 0,children:[e.jsx(J,{children:e.jsx(I,{children:e.jsx(M,{placeholder:"Select Designation"})})}),e.jsx(k,{children:_?e.jsx(f,{}):i==null?void 0:i.map((h,g)=>e.jsx(E,{value:String(h),children:h},g))})]}),e.jsx(w,{})]})}),e.jsx(S,{control:a.control,name:"expected_salary",render:({field:p})=>e.jsxs(A,{children:[e.jsx(C,{children:"Expected Salary"}),e.jsx(J,{children:e.jsx(H,{type:"number",placeholder:"Enter Expected Salary",...p})}),e.jsx(w,{})]})}),e.jsx("div",{children:e.jsx(N,{variant:"default",type:"submit",className:"w-full mt-4",children:s?"Update":"Add"})})]})})})}const ge=({data:l})=>e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("p",{className:"font-semibold",children:"Status:"}),e.jsx("div",{children:l.status})]})});function ye({data:l}){const[s,c]=b.useState(!1),[u,n]=b.useState(!1),[m,o]=b.useState(!1),[r,{isLoading:x}]=me(),j=async d=>{try{await r(d),O.success("Job deleted successfully"),c(!1)}catch(_){console.log(_)}};return e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx(q,{children:e.jsxs(V,{children:[e.jsx(U,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>n(!0),children:e.jsx(se,{className:"h-4 w-4 text-foreground"})})}),e.jsx(R,{children:e.jsx("p",{children:"Update Job Post"})})]})}),e.jsx(q,{children:e.jsxs(V,{children:[e.jsx(U,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{o(!0)},children:e.jsx(de,{className:"h-4 w-4 text-foreground"})})}),e.jsx(R,{children:e.jsx("p",{children:"Delete Requisition"})})]})}),e.jsx(q,{children:e.jsxs(V,{children:[e.jsx(U,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{c(!0)},children:e.jsx(le,{className:"h-4 w-4 text-foreground"})})}),e.jsx(R,{children:e.jsx("p",{children:"Delete Requisition"})})]})}),e.jsx(te,{title:"Are you sure?",description:"This action cannot be undone.",name:l.status,isOpen:s,onClose:()=>c(!1),onConfirm:()=>j(l.id),loading:x}),e.jsx(P,{title:"Update Job",isOpen:u,toggleModal:()=>n(!1),className:"w-[90%] max-w-6xl",children:e.jsx(Z,{data:l,modalClose:()=>n(!1)})}),e.jsx(P,{title:"Job Details",isOpen:m,toggleModal:()=>o(!1),className:"w-[90%] max-w-6xl",children:e.jsx(ge,{data:l})})]})}const fe=[{id:"select",header:({table:l})=>e.jsx(B,{checked:l.getIsAllPageRowsSelected()||l.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:s=>l.toggleAllPageRowsSelected(!!s),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:l})=>e.jsx(B,{checked:l.getIsSelected(),onCheckedChange:s=>l.toggleSelected(!!s),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"status",header:"Status"},{accessorKey:"expected_salary",header:"Expected salary"},{accessorKey:"",accessorFn:({job_post:l})=>l==null?void 0:l.title,header:"Job post title"},{accessorKey:"",accessorFn:({job_candidate:l})=>l==null?void 0:l.first_name,header:"Job candidate name"},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"Actions"}),enableSorting:!1,cell:({row:l})=>e.jsx(ye,{data:l.original})}],be=v.injectEndpoints({endpoints:l=>({changeStatus:l.mutation({query:s=>({url:"job-applies/change-status",method:"POST",body:s}),invalidatesTags:["change-status","job-applies"]})}),overrideExisting:!1}),{useChangeStatusMutation:Se}=be;function Ae({modalClose:l,data:s}){const[c,{isLoading:u}]=Se(),[n,m]=b.useState([]);b.useEffect(()=>{m(s||[])},[s]);const o=t=>{m(i=>i.filter(a=>(a==null?void 0:a.id)!==t))},{data:r,isLoading:x}=X(),j=(r==null?void 0:r.job_apply_status)||[],d=K({resolver:G(ce),defaultValues:{status:"Call For Interview",ids:n.map(t=>t.id)}}),_=d.watch("status");async function F(t){var a;const i={...t,ids:n.map(T=>T.id),interview_date:(a=t==null?void 0:t.interview_date)==null?void 0:a.replace("T"," ").concat(":00")};try{await c(i),O.success("Job apply created successfully"),l()}catch(T){console.log(T)}}return e.jsx(e.Fragment,{children:u?e.jsx("div",{className:"",children:e.jsx(f,{})}):e.jsxs(Q,{...d,children:[e.jsx("div",{className:"flex gap-3 flex-wrap max-h-40 overflow-y-auto",children:n.map((t,i)=>{var a;return e.jsxs("div",{className:"flex items-center gap-1  bg-black text-white p-2 rounded-lg whitespace-nowrap",children:[e.jsxs("p",{className:"text-xs",children:[(a=t.job_candidate)==null?void 0:a.email," "]}),e.jsx("span",{className:"cursor-pointer ",onClick:()=>o(t.id),children:e.jsx(xe,{})})]},i)})}),e.jsxs("form",{onSubmit:d.handleSubmit(F),className:" space-y-3 ",children:[e.jsx(S,{control:d.control,name:"status",render:({field:t})=>e.jsxs(A,{children:[e.jsx(C,{children:"Status"}),e.jsxs(L,{onValueChange:t.onChange,defaultValue:"Call For Interview",children:[e.jsx(J,{children:e.jsx(I,{children:e.jsx(M,{placeholder:"Select status"})})}),e.jsx(k,{children:x?e.jsx(f,{}):j==null?void 0:j.map((i,a)=>e.jsx(E,{value:String(i),children:i},a))})]}),e.jsx(w,{})]})}),_==="Call For Interview"&&e.jsx(S,{control:d.control,name:"interview_date",render:({field:t})=>e.jsxs(A,{children:[e.jsx(C,{children:"Interview Date"}),e.jsx(J,{children:e.jsx(H,{type:"datetime-local",placeholder:"Enter interview date",...t,value:t.value??""})}),e.jsx(w,{})]})}),e.jsx("div",{children:e.jsx(N,{variant:"default",type:"submit",className:"w-full mt-4",children:"Change Status"})})]})]})})}const Ce=[{label:"Update Status",value:"update-status"},{label:"Delete Selected",value:"delete-selected"}],Ue=()=>{const[l,s]=b.useState(!1),[c,u]=W.useState({pageIndex:0,pageSize:10}),{data:n,isLoading:m}=he(`per_page=${c.pageSize}&page=${c.pageIndex+1}`),[o,r]=b.useState({action:"",payload:[]}),x=(n==null?void 0:n.data)||[],j=n==null?void 0:n.meta;return m?e.jsx(f,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Y,{title:"Job Apply",description:"Manage job apply for you business"}),e.jsxs(N,{onClick:()=>s(!0),size:"sm",children:[e.jsx(re,{className:"mr-2 h-4 w-4"})," Add Job Apply"]})]}),e.jsx(ee,{}),x&&e.jsx("div",{children:e.jsx(ae,{columns:fe,data:x,bulkActions:Ce,selectedBulkAction:o,setSelectedBulkAction:r,paginationInfo:j,pagination:c,setPagination:u})})]})}),e.jsx(P,{title:"Add Job Apply",isOpen:l,toggleModal:()=>s(!1),className:"",children:e.jsx(Z,{modalClose:()=>s(!1)})}),o.action==="update-status"&&e.jsx(P,{title:"Job Status Bulk Update",isOpen:o.action==="update-status",toggleModal:()=>r({action:"",payload:[]}),className:"",children:e.jsx(Ae,{modalClose:()=>s(!1),data:o.payload})})]})};export{Ue as default};
