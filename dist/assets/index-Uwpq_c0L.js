import{b0 as _,k as e,b2 as G,b3 as n,L as Z,n as J,Q as K,b4 as D,b5 as ee,b6 as T,b7 as se,r as I,W as R,X as B,Y as M,Z as H,a0 as x,a1 as j,a2 as h,a3 as m,I as P,a4 as p,ak as C,al as L,am as w,an as E,ao as t,H as O,b8 as ne,a6 as Q,b9 as le,R as ce,ba as re,af as ae,P as $,ag as de}from"./index-CoYxIyax.js";import{T as te,a as ie,b as oe,c as xe}from"./tabs-CvXDgduG.js";import{B as z}from"./badge-B01Q_I_0.js";import{M as v}from"./modal-D4n7Y-rc.js";import{S as je}from"./switch-BfnfDR2K.js";import"./sheet-CAT9hY2z.js";const he=_.injectEndpoints({endpoints:r=>({getLedgerGroups:r.query({query:()=>"ledger-groups?tree=1",providesTags:["ledger-groups-tree"]}),getLedgerGroupsArray:r.query({query:()=>"ledger-groups",providesTags:["ledger-groups-array"]}),createLedgerGroup:r.mutation({query:s=>({url:"ledger-groups",method:"POST",body:s}),invalidatesTags:["ledger-groups","ledger-groups-tree","ledger-groups-array"]}),removeLedgerGroup:r.mutation({query:s=>({url:`ledger-groups/${s}`,method:"DELETE"}),invalidatesTags:["ledger-groups"]}),updateLedgerGroup:r.mutation({query:({ledgerGroupId:s,updatedLedgerGroup:l})=>({url:`ledger-groups/${s}`,method:"PUT",body:l}),invalidatesTags:["ledger-groups"]})}),overrideExisting:!1}),{useGetLedgerGroupsQuery:me,useGetLedgerGroupsArrayQuery:U,useCreateLedgerGroupMutation:ue,useRemoveLedgerGroupMutation:we,useUpdateLedgerGroupMutation:Ee}=he,Y=({group:r,coaType:s})=>r.childs_group.map(l=>e.jsxs(e.Fragment,{children:[e.jsxs(G,{children:[e.jsxs(n,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:["    ",l.name]}),e.jsx(n,{className:"py-2.5",children:l.code}),e.jsx(n,{className:"py-2.5",children:"Group"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"})]},l.id),l.childs_group.length>0&&e.jsx(Y,{group:l,coaType:s}),l.ledgers.map(a=>e.jsxs(G,{children:[e.jsx(n,{className:"py-0 col-span-2 w-2/3",children:e.jsxs(Z,{className:J({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/${s}/${a.id}`,children:["    ",a.name]})}),e.jsx(n,{className:"py-2.5",children:a.code}),e.jsx(n,{className:"py-2.5",children:"Account"}),e.jsx(n,{className:"py-2.5",children:e.jsx(z,{variant:"outline",children:"active"})}),e.jsx(n,{className:"py-2.5",children:"700"}),e.jsx(n,{className:"py-2.5",children:"500"})]},a.id))]})),pe=({data:r,coaType:s})=>{const l=r.find(a=>a.name===s);return l?e.jsx(K,{className:"mt-4",children:e.jsxs(D,{children:[e.jsx(ee,{children:e.jsxs(G,{children:[e.jsx(T,{className:"py-2.5 h-8 col-span-2 w-2/3",children:"Name"}),e.jsx(T,{className:"py-2.5 h-8 w-[100px]",children:"Code"}),e.jsx(T,{className:"py-2.5 h-8",children:"Type"}),e.jsx(T,{className:"py-2.5 h-8",children:"Status"}),e.jsx(T,{className:"py-2.5 h-8",children:"Debit"}),e.jsx(T,{className:"py-2.5 h-8",children:"Credit"})]})}),e.jsxs(se,{children:[e.jsxs(G,{children:[e.jsx(n,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:l.name}),e.jsx(n,{className:"py-2.5",children:l.code}),e.jsx(n,{className:"py-2.5",children:"Group"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"})]}),e.jsx(Y,{group:l,coaType:s}),l.ledgers.map(a=>e.jsxs(G,{children:[e.jsx(n,{className:"py-2.5 col-span-2 w-2/3",children:a.name}),e.jsx(n,{className:"py-2.5",children:a.code}),e.jsx(n,{className:"py-2.5",children:"Account"}),e.jsx(n,{className:"py-2.5",children:e.jsx(z,{variant:"secondary",children:"Inactive"})}),e.jsx(n,{className:"py-2.5",children:"700"}),e.jsx(n,{className:"py-2.5",children:"500"})]},a.id))]})]})}):null},k=[{type:"Assets",title:"Assets",description:"Manage assets for your business"},{type:"Liabilities",title:"Liabilities",description:"Manage liabilities for your business"},{type:"Income",title:"Incomes",description:"Manage incomes for your business"},{type:"Expenses",title:"Expenses",description:"Manage expenses for your business"}];function ye({modalClose:r,rowData:s}){const[l,{isLoading:a}]=ue(),{data:y,isLoading:f}=U(),[A,i]=I.useState("Assets"),F=(y==null?void 0:y.data)||[],u=F==null?void 0:F.filter(d=>(d==null?void 0:d.type)===A),b=R({resolver:B(ne),defaultValues:{parent_id:(s==null?void 0:s.id)||0}});async function V(d){try{await l(d),Q.success("Add ledger group successfully"),r()}catch(N){console.log(N)}}return e.jsx(e.Fragment,{children:a?e.jsx("div",{className:"h-56",children:e.jsx(M,{})}):e.jsx(H,{...b,children:e.jsxs("form",{onSubmit:b.handleSubmit(V),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(x,{control:b.control,name:"name",render:({field:d})=>e.jsxs(j,{children:[e.jsx(h,{children:"Name"}),e.jsx(m,{children:e.jsx(P,{placeholder:"Enter financial year name",...d})}),e.jsx(p,{})]})}),e.jsx(x,{control:b.control,name:"code",render:({field:d})=>e.jsxs(j,{children:[e.jsx(h,{children:"Code"}),e.jsx(m,{children:e.jsx(P,{placeholder:"Enter code",...d,value:d.value||""})}),e.jsx(p,{})]})}),e.jsx(x,{name:"",render:()=>e.jsxs(j,{children:[e.jsx(h,{children:"Account Type"}),e.jsxs(C,{value:A,onValueChange:d=>{i(d)},children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Account Type"})})}),e.jsxs(E,{children:[e.jsx(t,{value:"Assets",children:"Assets"}),e.jsx(t,{value:"Liabilities",children:"Liabilities"}),e.jsx(t,{value:"Income",children:"Incomes"}),e.jsx(t,{value:"Expenses",children:"Expenses"})]})]}),e.jsx(p,{})]})}),(u==null?void 0:u.length)>0?e.jsx(x,{control:b.control,name:"parent_id",render:({field:d})=>e.jsxs(j,{children:[e.jsx(h,{children:"Parent"}),e.jsxs(C,{onValueChange:d.onChange,children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(E,{children:f?e.jsx(M,{}):u==null?void 0:u.map(N=>e.jsx(t,{value:String(N.id),children:N.name},N.id))})]}),e.jsx(p,{})]})}):null]}),e.jsx("div",{children:e.jsx(O,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Group"})})]})})})}const ge=_.injectEndpoints({endpoints:r=>({getEnum:r.query({query:()=>"catalogs/enum",providesTags:["catalogs/enum"]})}),overrideExisting:!1}),{useGetEnumQuery:fe}=ge;function be({modalClose:r,rowData:s,coaType:l}){const[a,{isLoading:y}]=le(),[f,A]=ce.useState(0),{data:i,isLoading:F}=U(),{data:u,isLoading:b}=fe(),V=(u==null?void 0:u.account_nature)||[],[d,N]=I.useState("Assets"),q=(i==null?void 0:i.data)||[],S=q==null?void 0:q.filter(c=>(c==null?void 0:c.type)===d),g=R({resolver:B(re),defaultValues:{name:(s==null?void 0:s.name)||"",parent_id:(s==null?void 0:s.id)||0,is_sub_type:0,nature:(s==null?void 0:s.nature)||""}});async function W(c){try{await a(c),Q.success("Add ledger account successfully"),r()}catch(o){console.log(o)}}return e.jsx(e.Fragment,{children:y?e.jsx("div",{className:"h-56",children:e.jsx(M,{})}):e.jsx(H,{...g,children:e.jsxs("form",{onSubmit:g.handleSubmit(W),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(x,{control:g.control,name:"name",render:({field:c})=>e.jsxs(j,{children:[e.jsx(h,{children:"Name"}),e.jsx(m,{children:e.jsx(P,{placeholder:"Enter ledger account name",...c})}),e.jsx(p,{})]})}),e.jsx(x,{control:g.control,name:"code",render:({field:c})=>e.jsxs(j,{children:[e.jsx(h,{children:"Code"}),e.jsx(m,{children:e.jsx(P,{placeholder:"Enter code",...c,value:c.value||""})}),e.jsx(p,{})]})}),e.jsx(x,{name:"",render:()=>e.jsxs(j,{children:[e.jsx(h,{children:"Account Type"}),e.jsxs(C,{value:d,onValueChange:c=>{N(c)},children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Account Type"})})}),e.jsxs(E,{children:[e.jsx(t,{value:"Assets",children:"Assets"}),e.jsx(t,{value:"Liabilities",children:"Liabilities"}),e.jsx(t,{value:"Income",children:"Incomes"}),e.jsx(t,{value:"Expenses",children:"Expenses"})]})]}),e.jsx(p,{})]})}),(S==null?void 0:S.length)>0?e.jsx(x,{control:g.control,name:"parent_id",render:({field:c})=>e.jsxs(j,{children:[e.jsx(h,{children:"Parent"}),e.jsxs(C,{onValueChange:c.onChange,children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(E,{children:F?e.jsx(M,{}):S==null?void 0:S.map(o=>e.jsx(t,{value:String(o.id),children:o.name},o.id))})]}),e.jsx(p,{})]})}):null]}),l==="Assets"||d==="Assets"?e.jsx(x,{control:g.control,name:"nature",render:({field:c})=>e.jsxs(j,{children:[e.jsx(h,{children:"Default Account Type"}),e.jsxs(C,{onValueChange:c.onChange,children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(w,{placeholder:"Select Parent"})})}),e.jsx(E,{children:b?e.jsx(M,{}):V.map((o,X)=>e.jsx(t,{value:o.toString(),children:o.toString()},X))})]}),e.jsx(p,{})]})}):null,e.jsx(x,{control:g.control,name:"is_sub_type",render:({field:c})=>e.jsxs(j,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(h,{children:"Is Sub Type"})}),e.jsx(m,{children:e.jsx(je,{checked:c.value===1,onCheckedChange:o=>{c.onChange(o?1:0),A(o?1:0)}})})]})}),f===1&&e.jsx(x,{control:g.control,name:"sub_type",render:({field:c})=>e.jsxs(j,{children:[e.jsx(h,{children:"Sub Type"}),e.jsxs(C,{onValueChange:c.onChange,defaultValue:"None",children:[e.jsx(m,{children:e.jsx(L,{children:e.jsx(w,{placeholder:""})})}),e.jsxs(E,{children:[e.jsx(t,{value:"None",children:"None"}),e.jsx(t,{value:"Employee",children:"Employee"}),e.jsx(t,{value:"Customer",children:"Customer"}),e.jsx(t,{value:"Supplier",children:"Supplier"}),e.jsx(t,{value:"Agent",children:"Agent"})]})]}),e.jsx(p,{})]})}),e.jsx("div",{children:e.jsx(O,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Account"})})]})})})}const Me=()=>{const{data:r,isLoading:s}=me(),[l,a]=I.useState(!1),[y,f]=I.useState(!1),A=(r==null?void 0:r.data)||[];return s?e.jsx(M,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{title:"Chart Of Account",description:"Manage Chart of account for you business"}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsxs(O,{onClick:()=>a(!0),size:"sm",children:[e.jsx($,{className:"mr-2 h-4 w-4"})," Add Group"]}),e.jsxs(O,{onClick:()=>f(!0),size:"sm",children:[e.jsx($,{className:"mr-2 h-4 w-4"})," Add Account"]})]})]}),e.jsx(de,{}),e.jsxs(te,{defaultValue:k[0].type,className:"w-full mt-3",children:[e.jsx(ie,{className:"w-fit",children:k.map(i=>e.jsx(oe,{value:i.type,children:i.title},i.type))}),k.map(i=>e.jsx(xe,{value:i.type,children:e.jsx(pe,{title:i.title,coaType:i.type,description:i.description,data:A})},i.type))]}),l&&e.jsx(v,{title:"Add Group",isOpen:l,toggleModal:()=>a(!1),children:e.jsx(ye,{modalClose:()=>a(!1)})}),y&&e.jsx(v,{title:"Add Account",isOpen:y,toggleModal:()=>f(!1),children:e.jsx(be,{modalClose:()=>f(!1)})})]})};export{Me as default};
