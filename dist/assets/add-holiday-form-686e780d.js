import{r as N,y as L,B as M,ck as z,a as e,ar as I,aG as O,Q as i,U as w,G,H as h,J as c,K as u,M as f,I as x,N as d,a6 as C,a7 as $,a8 as b,aR as F,a9 as P,aa as S,aB as J,aH as R,D as K,as as k}from"./index-a07c9d65.js";import{c as Q}from"./index-b12fd352.js";import{s as U}from"./holidays-137cbbd4.js";function Y(){const[y,p]=N.useState({fromDate:[!1],toDate:[!1]}),[H,v]=N.useState([]),[T,{isLoading:_}]=Q(),j=L(),o=M({resolver:K(U),defaultValues:{holidays:[{name:"",start_date:void 0,end_date:void 0,duration:"",note:""}]}}),{fields:V,append:E,remove:A}=z({control:o.control,name:"holidays"}),D=(r,a)=>{if(r&&a){const s=a.getTime()-r.getTime(),t=Math.ceil(s/(1e3*60*60*24));return`${t+1} day${t===0?"":"s"}`}return""},B=async r=>{try{await T(r),k.success("Holidays Created Successfully!"),j("/hrm/holidays")}catch{k.error("Failed to create holidays!")}},g=(r,a)=>{p(s=>{const t={...s};return a==="fromDate"?(t.fromDate[r]=!t.fromDate[r],t.toDate[r]=!1):(o.getValues(`holidays.${r}.start_date`)?(t.toDate[r]=!t.toDate[r],v(n=>{const m=[...n];return m[r]=!1,m})):v(n=>{const m=[...n];return m[r]=!0,m}),t.fromDate[r]=!1),t})};return e.jsx(e.Fragment,{children:_?e.jsx("div",{className:"h-56",children:e.jsx(I,{})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(O,{title:"Add Holiday",description:""}),e.jsx(i,{size:"sm",onClick:()=>j("/hrm/holidays"),children:"Holiday List"})]}),e.jsx(w,{className:"p-3",children:e.jsx(G,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(B),className:"space-y-3 mb-auto px-2 overflow-y-scroll no-scrollbar",children:[V.map((r,a)=>e.jsx(w,{className:"p-3",children:e.jsxs("div",{className:"flex w-full gap-x-3",children:[e.jsx("div",{className:"w-[215px]",children:e.jsx(h,{control:o.control,name:`holidays.${a}.name`,render:({field:s})=>e.jsxs(c,{children:[e.jsx(u,{children:a===0&&"Holiday Name"}),e.jsx(f,{children:e.jsx(x,{type:"text",placeholder:"Enter holiday name",...s})}),e.jsx(d,{})]})})}),e.jsx("div",{className:"w-[250px]",children:e.jsx(h,{control:o.control,name:`holidays.${a}.start_date`,render:({field:s})=>e.jsxs(c,{children:[e.jsx(u,{children:a===0&&"From Date"}),e.jsxs(C,{open:y.fromDate[a],onOpenChange:()=>g(a,"fromDate"),children:[e.jsx($,{asChild:!0,children:e.jsxs(i,{variant:"outline",className:`w-full justify-start text-left font-normal ${!s.value&&"text-muted-foreground"}`,children:[s.value?b(s.value,"PP"):"Pick a date",e.jsx(F,{className:"ml-auto h-4 w-4 opacity-50"})]})}),e.jsx(P,{className:"w-auto p-0",align:"start",children:e.jsx(S,{mode:"single",selected:s.value??void 0,onSelect:t=>{s.onChange(t);const l=o.getValues(`holidays.${a}.end_date`);if(t&&l){const n=D(t,l);o.setValue(`holidays.${a}.duration`,n)}},initialFocus:!0})})]}),e.jsx(d,{})]})})}),e.jsx("div",{className:"w-[250px]",children:e.jsx(h,{control:o.control,name:`holidays.${a}.end_date`,render:({field:s})=>e.jsxs(c,{children:[e.jsx(u,{children:a===0&&"To Date"}),e.jsxs(C,{open:y.toDate[a],onOpenChange:()=>g(a,"toDate"),children:[e.jsx($,{asChild:!0,children:e.jsxs(i,{variant:"outline",className:`w-full justify-start text-left font-normal ${!s.value&&"text-muted-foreground"}`,children:[s.value?b(s.value,"PP"):"Pick a date",e.jsx(F,{className:"ml-auto h-4 w-4 opacity-50"})]})}),e.jsx(P,{className:"w-auto p-0",align:"start",children:e.jsx(S,{mode:"single",selected:s.value??void 0,disabled:t=>{const l=o.getValues(`holidays.${a}.start_date`);return!!(l&&t<l)},onSelect:t=>{s.onChange(t);const l=o.getValues(`holidays.${a}.start_date`);if(l&&t){const n=D(l,t);o.setValue(`holidays.${a}.duration`,n)}},initialFocus:!0})})]}),H[a]&&e.jsx(d,{children:"Please select From Date first."}),e.jsx(d,{})]})})}),e.jsx("div",{className:"w-[112px]",children:e.jsx(h,{control:o.control,name:`holidays.${a}.duration`,render:({field:s})=>e.jsxs(c,{children:[e.jsx(u,{children:a===0&&"Duration"}),e.jsx(f,{children:e.jsx(x,{type:"text",placeholder:"Duration",...s,disabled:!0})}),e.jsx(d,{})]})})}),e.jsx("div",{className:"flex-1",children:e.jsx(h,{control:o.control,name:`holidays.${a}.note`,render:({field:s})=>e.jsxs(c,{children:[e.jsx(u,{children:a===0&&"Note"}),e.jsx(f,{children:e.jsx(x,{type:"text",placeholder:"Enter note",...s})}),e.jsx(d,{})]})})}),e.jsx("div",{className:`${a===0?"mt-10":"mt-4"}`,children:e.jsx(c,{children:e.jsx("span",{onClick:()=>A(a),className:"cursor-pointer",children:e.jsx(J,{size:16,color:"red"})})})})]})},r.id)),e.jsxs(i,{variant:"outline",className:"border border-dashed border-gray-700 w-full",type:"button",onClick:()=>{E({name:"",start_date:void 0,end_date:void 0,duration:"",note:""}),p(r=>({fromDate:[...r.fromDate,!1],toDate:[...r.toDate,!1]}))},children:[e.jsx(R,{size:16})," ",e.jsx("span",{className:"ml-2",children:"Add Holiday"})]}),e.jsxs("div",{className:"flex flex-row-reverse items-center !mb-2",children:[e.jsx(i,{variant:"default",type:"submit",className:"w-fit ml-2",children:"Save"}),e.jsx(i,{variant:"primary",onClick:()=>j("/hrm/holidays"),className:"w-fit",children:"Back"})]})]})})})]})})}export{Y as default};
