import{cN as he,cR as xe,cS as je,R as Y,cT as se,E as ne,G as le,cU as me,a as e,aw as F,J as ce,K as N,N as A,Q as C,b3 as R,V as w,b4 as U,b5 as q,b6 as H,b8 as _,W as M,I as P,X as S,ax as E,ay as V,cV as ge,cW as pe,cX as ye,ab as be,ac as fe,b as $,cY as Ne,ae as Ae,cZ as Ce,c_ as we,c$ as Se,d0 as Le,d1 as Ge,d2 as Te,d3 as Me,r as G,d4 as _e,d5 as Ee,bf as k,bi as j,aB as J,aC as W,aD as X,aA as T,aF as K,aE as Z,aG as v,L as de,o as re,aI as z,aH as D,Y as Oe,bd as Fe,be as Ie,bg as Q,bh as ke,d6 as Pe,aL as Ve,aM as ee,aN as ze,al as Re,am as Ue,an as qe,ao as He}from"./index-a2be996e.js";import{S as Qe}from"./switch-093c6041.js";const Be=he.injectEndpoints({endpoints:i=>({getEnum:i.query({query:()=>"catalogs/enum",providesTags:["catalogs/enum"]})}),overrideExisting:!1}),{useGetEnumQuery:Ye}=Be;function oe({modalClose:i,rowData:s}){const[u,{isLoading:o}]=xe(),[b,{isLoading:p}]=je(),[L,a]=Y.useState(s!=null&&s.is_sub_type?1:0),{data:h,isLoading:O}=se(),{data:x,isLoading:y}=Ye(),I=(x==null?void 0:x.account_nature)||[],c=(h==null?void 0:h.data)||[],t=ne({resolver:le(me),defaultValues:{name:(s==null?void 0:s.name)||"",parent_id:s==null?void 0:s.parent_id,is_sub_type:s!=null&&s.is_sub_type?1:0,sub_type:s!=null&&s.sub_type&&["None","Employee","Customer","Supplier","Agent"].includes(s.sub_type)?s.sub_type:"None",nature:(s==null?void 0:s.nature)||"",code:(s==null?void 0:s.code)||""}});async function m(d){const g=d.sub_type&&["None","Employee","Customer","Supplier","Agent"].includes(d.sub_type)?d.sub_type:"None";try{s?(await b({ledgerAccountId:s==null?void 0:s.id,updatedLedgerAccount:{...s,...d,sub_type:g}}).unwrap(),E.success("Update ledger account successfully"),i()):(await u(d).unwrap(),E.success("Add ledger account successfully"),i())}catch(f){E.error("error.data.message"),V(f),console.log(f,"dsadasd")}}return e.jsx(e.Fragment,{children:o||p?e.jsx("div",{className:"h-56",children:e.jsx(F,{})}):e.jsx(ce,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(m),className:"w-full space-y-3",children:[e.jsxs(e.Fragment,{children:[e.jsx(N,{control:t.control,name:"parent_id",render:({field:d})=>{var g,f;return e.jsxs(A,{children:[e.jsx(C,{children:"Parent Group"}),e.jsxs(R,{onValueChange:d.onChange,defaultValue:(g=s==null?void 0:s.parent_id)!=null&&g.toString()?(f=s==null?void 0:s.parent_id)==null?void 0:f.toString():void 0,disabled:!!(s!=null&&s.id),children:[e.jsx(w,{children:e.jsx(U,{children:e.jsx(q,{placeholder:"Select Parent"})})}),e.jsx(H,{children:O?e.jsx(F,{}):c==null?void 0:c.filter(r=>(r==null?void 0:r.name)!=="Assets"&&(r==null?void 0:r.name)!=="Liabilities"&&(r==null?void 0:r.name)!=="Equity"&&(r==null?void 0:r.name)!=="Expenses"&&(r==null?void 0:r.name)!=="Income").map(r=>e.jsx(_,{value:String(r.id),children:r.name},r.id))})]}),e.jsx(M,{})]})}}),e.jsx(N,{control:t.control,name:"name",render:({field:d})=>e.jsxs(A,{children:[e.jsx(C,{children:"Account Name"}),e.jsx(w,{children:e.jsx(P,{placeholder:"Enter ledger account name",...d})}),e.jsx(M,{})]})}),e.jsx(N,{control:t.control,name:"code",render:({field:d})=>e.jsxs(A,{children:[e.jsx(C,{children:"Code"}),e.jsx(w,{children:e.jsx(P,{placeholder:"Enter code",...d,value:d.value||""})}),e.jsx(M,{})]})})]}),e.jsx(N,{control:t.control,name:"nature",render:({field:d})=>e.jsxs(A,{children:[e.jsx(C,{children:"Default Account Type"}),e.jsxs(R,{onValueChange:d.onChange,defaultValue:(s==null?void 0:s.nature)||"",children:[e.jsx(w,{children:e.jsx(U,{children:e.jsx(q,{placeholder:"Select Parent"})})}),e.jsx(H,{children:y?e.jsx(F,{}):I.map((g,f)=>e.jsx(_,{value:g.toString(),children:g.toString()},f))})]}),e.jsx(M,{})]})}),e.jsx(N,{control:t.control,name:"is_sub_type",render:({field:d})=>e.jsxs(A,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(C,{children:"Is Sub Type"})}),e.jsx(w,{children:e.jsx(Qe,{checked:d.value===1,onCheckedChange:g=>{d.onChange(g?1:0),a(g?1:0)}})})]})}),L===1&&e.jsx(N,{control:t.control,name:"sub_type",render:({field:d})=>e.jsxs(A,{children:[e.jsx(C,{children:"Sub Type"}),e.jsxs(R,{onValueChange:d.onChange,defaultValue:(s==null?void 0:s.sub_type)||"None",children:[e.jsx(w,{children:e.jsx(U,{children:e.jsx(q,{placeholder:""})})}),e.jsxs(H,{children:[e.jsx(_,{value:"None",children:"None"}),e.jsx(_,{value:"Employee",children:"Employee"}),e.jsx(_,{value:"Customer",children:"Customer"}),e.jsx(_,{value:"Supplier",children:"Supplier"}),e.jsx(_,{value:"Agent",children:"Agent"})]})]}),e.jsx(M,{})]})}),e.jsx("div",{children:e.jsx(S,{variant:"default",type:"submit",className:"w-full mt-4",children:s?"Update Account":"Add Account"})})]})})})}function ae({modalClose:i,rowData:s}){const[u,o]=Y.useState(!1),[b,{isLoading:p}]=ge(),[L,{isLoading:a}]=pe(),{data:h,isLoading:O}=se(),x=(h==null?void 0:h.data)||[],y=ne({resolver:le(ye),defaultValues:{parent_id:s==null?void 0:s.id,name:(s==null?void 0:s.name)||"",code:(s==null?void 0:s.code)||""}});async function I(c){try{s?(await L({ledgerGroupId:s.id,updatedLedgerGroup:{...s,...c}}).unwrap(),E.success("Add ledger group successfully"),i()):(await b(c).unwrap(),E.success("Add ledger group successfully"),i())}catch(t){V(t),console.log(t)}}return e.jsx(e.Fragment,{children:p||a?e.jsx("div",{className:"h-56",children:e.jsx(F,{})}):e.jsx(ce,{...y,children:e.jsxs("form",{onSubmit:y.handleSubmit(I),className:"w-full space-y-3",children:[e.jsxs(e.Fragment,{children:[e.jsx(N,{control:y.control,name:"parent_id",render:({field:c})=>{var t;return e.jsxs(A,{children:[e.jsx(C,{children:"Parent Group"}),e.jsxs(be,{open:u,onOpenChange:o,modal:!0,children:[e.jsx(fe,{asChild:!0,children:e.jsx(w,{children:e.jsxs(S,{disabled:!!(s!=null&&s.id),variant:"outline",role:"combobox",className:$("w-full justify-between",!c.value&&"text-muted-foreground"),children:[c.value?(t=x.find(m=>m.id===Number(c.value)))==null?void 0:t.name:"Select Parent",e.jsx(Ne,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(Ae,{className:"w-[460px] p-0",children:e.jsxs(Ce,{children:[e.jsx(we,{placeholder:"Search parent group..."}),e.jsxs(Se,{children:[e.jsx(Le,{children:"No parent group found."}),e.jsx(Ge,{children:O?e.jsx(F,{}):x.map(m=>e.jsxs(Te,{onSelect:()=>{c.onChange(String(m.id)),o(!1)},children:[e.jsx(Me,{className:$("mr-2 h-4 w-4",Number(c.value)===m.id?"opacity-100":"opacity-0")}),m.name]},m.id))})]})]})})]}),e.jsx(M,{})]})}}),e.jsx(N,{control:y.control,name:"name",render:({field:c})=>e.jsxs(A,{children:[e.jsx(C,{children:"Account Name"}),e.jsx(w,{children:e.jsx(P,{placeholder:"Enter name",...c})}),e.jsx(M,{})]})}),e.jsx(N,{control:y.control,name:"code",render:({field:c})=>e.jsxs(A,{children:[e.jsx(C,{children:"Code"}),e.jsx(w,{children:e.jsx(P,{placeholder:"Enter code",...c,value:c.value||""})}),e.jsx(M,{})]})})]}),e.jsx("div",{children:e.jsx(S,{variant:"default",type:"submit",className:"w-full mt-4",children:s?"Update Group":"Add Group"})})]})})})}const te=({group:i,coaType:s,depth:u=0})=>{const o=Array(u).fill("        ").join(""),[b,p]=G.useState(null),[L,a]=G.useState(null),[h,O]=G.useState(null),[x,y]=G.useState(null),[I,c]=G.useState(null),[t,m]=G.useState(null),[d,{isLoading:g}]=_e(),[f,{isLoading:r}]=Ee(),ie=async n=>{try{await d(n).unwrap(),E.success("Account deleted successfully"),c(null)}catch(l){V(l),console.log(l)}},ue=async n=>{try{await f(n).unwrap(),E.success("Account deleted successfully"),m(null)}catch(l){V(l),console.log(l)}};return i.childs_group.map(n=>e.jsxs(Y.Fragment,{children:[e.jsxs(k,{children:[e.jsx(j,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:e.jsx(J,{children:e.jsxs(W,{delayDuration:100,children:[e.jsx(X,{asChild:!0,children:e.jsxs("span",{children:[o,n.name]})}),e.jsx(T,{roles:["ledger-groups.edit","ledger-groups.delete"],children:e.jsx(K,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(T,{roles:["ledger-groups.edit"],children:e.jsx(S,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{a(n.id),y(n)},children:e.jsx(Z,{className:"h-4 w-4 text-foreground"})})}),e.jsx(T,{roles:["ledger-groups.delete"],children:e.jsx(S,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{m(n.id),y(n)},children:e.jsx(v,{className:"h-4 w-4 text-foreground"})})})]})})})]})})}),e.jsx(j,{className:"py-2.5",children:n.code}),e.jsx(j,{className:"py-2.5",children:"Group"})]}),n.childs_group&&n.childs_group.length>0&&e.jsx(te,{group:n,coaType:s,depth:u+1}),n.ledgers&&n.ledgers.length>0&&n.ledgers.map(l=>e.jsxs(k,{children:[e.jsx(j,{className:"py-0 col-span-2 w-2/3",children:e.jsx("div",{className:"py-2.5 col-span-2 w-2/3 font-medium",children:e.jsx(J,{children:e.jsxs(W,{delayDuration:100,children:[e.jsx(X,{asChild:!0,children:e.jsxs(de,{className:re({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/reports/detailed-general-ledger/${l.id}`,children:[o,l.name]})}),e.jsx(T,{roles:["ledger-accounts.edit","ledger-accounts.delete"],children:e.jsx(K,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(T,{roles:["ledger-accounts.edit"],children:e.jsx(S,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{p(l.id),O(l)},children:e.jsx(Z,{className:"h-4 w-4 text-foreground"})})}),e.jsx(T,{roles:["ledger-accounts.delete"],children:e.jsx(S,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{c(l.id),O(l)},children:e.jsx(v,{className:"h-4 w-4 text-foreground"})})})]})})})]})})})}),e.jsx(j,{className:"py-2.5",children:l.code}),e.jsx(j,{className:"py-2.5",children:"Account"}),e.jsxs(j,{className:"py-2.5",children:[(l==null?void 0:l.id)===b&&e.jsx(z,{title:"Edit Account",isOpen:(l==null?void 0:l.id)===b,toggleModal:()=>p(null),children:e.jsx(oe,{rowData:h,modalClose:()=>p(null)})}),e.jsx(D,{title:"Are you sure?",description:"This action cannot be undone.",name:h==null?void 0:h.name,isOpen:I===(l==null?void 0:l.id),onClose:()=>c(null),onConfirm:()=>ie(h==null?void 0:h.id),loading:g})]})]},l.id)),(n==null?void 0:n.id)===L&&e.jsx(z,{title:"Edit Group",isOpen:(n==null?void 0:n.id)===L,toggleModal:()=>a(null),children:e.jsx(ae,{rowData:x,modalClose:()=>a(null)})}),e.jsx(D,{title:"Are you sure?",description:"This action cannot be undone.",name:x==null?void 0:x.name,isOpen:(n==null?void 0:n.id)===t,onClose:()=>m(null),onConfirm:()=>ue(x==null?void 0:x.id),loading:r})]},n.id))},$e=({data:i,coaType:s})=>{const u=i.find(o=>o.name===s);return u?e.jsx(Oe,{className:"mt-4",children:e.jsxs(Fe,{children:[e.jsx(Ie,{children:e.jsxs(k,{children:[e.jsx(Q,{className:"py-2.5 h-8 col-span-2 w-2/3",children:"Name"}),e.jsx(Q,{className:"py-2.5 h-8 w-[100px]",children:"Code"}),e.jsx(Q,{className:"py-2.5 h-8",children:"Type"})]})}),e.jsxs(ke,{children:[e.jsxs(k,{children:[e.jsx(j,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:u.name}),e.jsx(j,{className:"py-2.5",children:u.code}),e.jsx(j,{className:"py-2.5",children:"Group"})]}),e.jsx(te,{group:u,coaType:s,depth:1}),u.ledgers.map(o=>e.jsxs(k,{children:[e.jsx(j,{className:"py-2.5 col-span-2 w-2/3",children:e.jsxs(de,{className:re({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/detailed-general-ledger/${o.id}`,children:["    ",o.name]})}),e.jsx(j,{className:"py-2.5",children:o.code}),e.jsx(j,{className:"py-2.5",children:"Account"})]},o.id))]})]})}):null},B=[{type:"Assets",title:"Assets",description:"Manage assets for your business"},{type:"Liabilities",title:"Liabilities",description:"Manage liabilities for your business"},{type:"Income",title:"Income",description:"Manage incomes for your business"},{type:"Expenses",title:"Expenses",description:"Manage expenses for your business"},{type:"Equity",title:"Equity",description:"Manage expenses for your business"}],Xe=()=>{const{data:i,isLoading:s}=Pe(),[u,o]=G.useState(!1),[b,p]=G.useState(!1),L=(i==null?void 0:i.data)||[];return s?e.jsx(F,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Ve,{title:"Chart Of Account",description:"Manage Chart of account for you business"}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(T,{roles:["ledger-groups.create"],children:e.jsxs(S,{onClick:()=>o(!0),size:"sm",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"})," Add Group"]})}),e.jsx(T,{roles:["ledger-accounts.create"],children:e.jsxs(S,{onClick:()=>p(!0),size:"sm",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"})," Add Account"]})})]})]}),e.jsx(ze,{}),e.jsxs(Re,{defaultValue:B[0].type,className:"w-full mt-3",children:[e.jsx(Ue,{className:"w-fit",children:B.map(a=>e.jsx(qe,{value:a.type,children:a.title},a.type))}),B.map(a=>e.jsx(He,{value:a.type,children:e.jsx($e,{title:a.title,coaType:a.type,description:a.description,data:L})},a.type))]}),u&&e.jsx(z,{title:"Add Group",isOpen:u,toggleModal:()=>o(!1),children:e.jsx(ae,{modalClose:()=>o(!1)})}),b&&e.jsx(z,{title:"Add Account",isOpen:b,toggleModal:()=>p(!1),children:e.jsx(oe,{modalClose:()=>p(!1)})})]})};export{Xe as default};
