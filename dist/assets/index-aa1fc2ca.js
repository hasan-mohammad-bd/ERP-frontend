import{r as m,aX as O,B as T,D as k,a as e,au as N,G as I,aU as u,H as R,J as z,K as U,a9 as G,aa as $,V as p,ab as P,aV as H,ac as K,ad as V,av as _,aw as B,az as y,aA as h,aB as A,aC as J,aD as f,aE as Q,aF as X,aG as C,aH as S,R as q,y as W,aJ as Y,aK as Z,aL as D,aM as ee}from"./index-78b4d473.js";import{a as ae,e as se,b as te,c as le}from"./attendance-policy-mapping-35e7866c.js";import{u as ne}from"./index-20c97b35.js";function F({modalClose:s,data:a}){const[t,n]=m.useState(null),[c,l]=m.useState(!1),{data:o,isLoading:d}=ne("per_page=1000&page=1"),{data:i,isLoading:g}=O("per_page=1000&page=1"),w=(o==null?void 0:o.data)||[],E=(i==null?void 0:i.data)||[],[b,{isLoading:v}]=ae(),r=T({resolver:k(se),defaultValues:{employee_id:a==null?void 0:a.employee_id.toString(),attendance_policy_id:a==null?void 0:a.attendance_policy_id.toString(),effective_date:a==null?void 0:a.effective_date}}),M=x=>{x&&(n(x),r.setValue("effective_date",`${P(x,"yyyy-MM-dd")}`),l(!1))};m.useEffect(()=>{a&&n(new Date(a.effective_date))},[a]);async function L(x){try{a&&(await b({attendancePolicyId:a.id,updatedAttendancePolicy:x}).unwrap(),_.success("Policy updated successfully")),s()}catch(j){console.log(j),B(j)}}return e.jsx(e.Fragment,{children:v?e.jsx("div",{children:e.jsx(N,{})}):e.jsx(I,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(L),className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx("div",{className:"w-full",children:e.jsx(u,{loading:d,data:w,displayField:"name",valueField:"id",form:r,name:"attendance_policy_id",title:"Attendance Policy",className:"w-[460px]"})}),e.jsx("div",{className:"w-full",children:e.jsx(u,{loading:g,data:E,displayField:"first_name",valueField:"id",form:r,name:"employee_id",title:"Employee",className:"w-[460px]"})}),e.jsx(R,{control:r.control,name:"effective_date",render:()=>e.jsxs(z,{children:[e.jsx(U,{children:"Effective Date"}),e.jsxs(G,{open:c,onOpenChange:l,children:[e.jsx($,{asChild:!0,className:"",children:e.jsxs(p,{variant:"outline",className:`w-full justify-start text-left font-normal ${!t&&"text-muted-foreground"}`,children:[t?P(t,"PP"):"Pick a date",e.jsx(H,{className:"ml-auto h-4 w-4 opacity-50"})]})}),e.jsx(K,{className:"w-auto p-0",align:"start",children:e.jsx(V,{mode:"single",selected:t??void 0,onSelect:M,initialFocus:!0})})]})]})})]}),e.jsx("div",{className:"text-right",children:e.jsx(p,{variant:"default",type:"submit",className:"w-fit mt-4",children:a?"Update":"Add"})})]})})})}function ce({data:s}){const[a,t]=m.useState(!1),[n,c]=m.useState(!1),[l,{isLoading:o}]=te(),d=async i=>{try{await l(i),_.success("Employee Attendance Policy deleted successfully"),t(!1)}catch(g){console.log(g)}};return e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx(y,{children:e.jsxs(h,{children:[e.jsx(A,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>c(!0),children:e.jsx(J,{className:"h-4 w-4 text-foreground"})})}),e.jsx(f,{children:e.jsx("p",{children:"Update Attendance Policy"})})]})}),e.jsx(y,{children:e.jsx(h,{children:e.jsx(f,{children:e.jsx("p",{children:"Delete Attendance Policy"})})})}),e.jsx(y,{children:e.jsxs(h,{children:[e.jsx(A,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{t(!0)},children:e.jsx(Q,{className:"h-4 w-4 text-foreground"})})}),e.jsx(f,{children:e.jsx("p",{children:"Delete Attendance Policy"})})]})}),e.jsx(X,{title:"Are you sure?",description:"This action cannot be undone.",name:s.attendance_policy.name,isOpen:a,onClose:()=>t(!1),onConfirm:()=>d(s.id),loading:o}),n&&e.jsx(C,{title:"Update Employee Attendance Policy",isOpen:n,toggleModal:()=>c(!1),children:e.jsx(F,{data:s,modalClose:()=>c(!1)})})]})}const ie=[{id:"select",header:({table:s})=>e.jsx(S,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>s.toggleAllPageRowsSelected(!!a),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(S,{checked:s.getIsSelected(),onCheckedChange:a=>s.toggleSelected(!!a),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"effective_date",header:"Effective Date"},{header:"Policy Name",cell:({row:s})=>s.original.attendance_policy.name},{accessorKey:"",header:"Employee Name",cell:({row:s})=>{var a,t,n,c;return((t=(a=s.original)==null?void 0:a.employee)==null?void 0:t.first_name)+" "+((c=(n=s.original)==null?void 0:n.employee)==null?void 0:c.last_name)}},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"Actions"}),enableSorting:!1,cell:({row:s})=>e.jsx(ce,{data:s.original})}],me=()=>{const[s,a]=m.useState(!1),[t,n]=q.useState({pageIndex:0,pageSize:10}),c=W(),{data:l,isLoading:o}=le(`per_page=${t.pageSize}&page=${t.pageIndex+1}`),d=(l==null?void 0:l.data)||[],i=l==null?void 0:l.meta;return o?e.jsx(N,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Y,{title:"Manage Employee Attendance Policy",description:"Manage job apply for you business"}),e.jsxs(p,{onClick:()=>c("/hrm/employees-list"),size:"sm",children:[e.jsx(Z,{className:"mr-2 h-4 w-4"})," Add Employee Attendance Policy"]})]}),e.jsx(D,{}),d&&e.jsx("div",{children:e.jsx(ee,{columns:ie,data:d,paginationInfo:i,pagination:i&&t,setPagination:i&&n})})]})}),s&&e.jsx(C,{title:"Add Leave Type",isOpen:s,toggleModal:()=>a(!1),className:"",children:e.jsx(F,{modalClose:()=>a(!1)})})]})};export{me as default};
