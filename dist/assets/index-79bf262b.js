import{aU as r,ar as G,V as X,W as v,a as e,Y as J,Z as D,_ as d,$ as i,a0 as _,a1 as o,I as j,a2 as m,B as T,K as ee,aH as se,aI as ne,aJ as q,aM as h,aL as le,aj as ce,ak as ae,al as te,am as re,an as de,a3 as M,a4 as ie,r as O,a5 as P,a6 as C,a7 as z,a8 as oe,a9 as S,aa as xe,ab as me,ac as Q,ad as Y,R as he,ae as je,t as ye,af as ge,ag as _e}from"./index-616dae72.js";import{S as A}from"./switch-49ef3f9e.js";const fe=r.object({day:r.string().optional().nullable(),in_time:r.string(),delay_buffer_time:r.string(),ex_delay_buffer_time:r.string(),break_time:r.coerce.number(),working_hour:r.coerce.number(),out_time:r.string(),working_type:r.string()}),$=r.object({name:r.string().min(2,{message:"Name must be at least 2 characters."}),in_time:r.string(),delay_buffer_time:r.string(),ex_delay_buffer_time:r.string(),break_time:r.coerce.number(),working_hour:r.coerce.number(),out_time:r.string(),ignore_overtime:r.number(),exclude_attendance_report:r.number(),discard_weekend_attendance:r.number(),days:fe.array().optional().nullable()});$.extend({id:r.coerce.number()});const ue=G.injectEndpoints({endpoints:l=>({getAttendancePolicies:l.query({query:s=>`attendance-policy?${s}`,providesTags:["attendance-policy"]}),createAttendancePolicy:l.mutation({query:s=>({url:"attendance-policy",method:"POST",body:s}),invalidatesTags:["attendance-policy"]}),removeAttendancePolicy:l.mutation({query:s=>({url:`attendance-policy/${s}`,method:"DELETE"}),invalidatesTags:["attendance-policy"]}),updateAttendancePolicy:l.mutation({query:({attendancePolicyId:s,updatedAttendancePolicy:g})=>({url:`attendance-policy/${s}`,method:"PUT",body:g}),invalidatesTags:["attendance-policy"]})}),overrideExisting:!1}),{useGetAttendancePoliciesQuery:be,useCreateAttendancePolicyMutation:Ne,useRemoveAttendancePolicyMutation:ke,useUpdateAttendancePolicyMutation:pe}=ue,I=["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"],E=[{label:"Full Day",value:"full_day",id:1},{label:"Half Day",value:"half_day",id:2},{label:"Weekend",value:"weekend",id:3}];function Z({modalClose:l,data:s}){const[g,{isLoading:b}]=Ne(),[x,{isLoading:k}]=pe(),c=X({resolver:v($),defaultValues:{name:(s==null?void 0:s.name)||"",in_time:(s==null?void 0:s.in_time)||"",delay_buffer_time:(s==null?void 0:s.delay_buffer_time)||"",ex_delay_buffer_time:(s==null?void 0:s.ex_delay_buffer_time)||"",break_time:(s==null?void 0:s.break_time)||0,working_hour:(s==null?void 0:s.working_hour)||0,out_time:(s==null?void 0:s.out_time)||"",ignore_overtime:(s==null?void 0:s.ignore_overtime)||0,exclude_attendance_report:(s==null?void 0:s.exclude_attendance_report)||0,discard_weekend_attendance:(s==null?void 0:s.discard_weekend_attendance)||0,days:I.map(n=>{var a,t,u,f,N,B,F,H,K,L,R,U,V,W;return{day:n,in_time:((t=(a=s==null?void 0:s.days)==null?void 0:a.find(y=>y.day===n))==null?void 0:t.in_time)||"",delay_buffer_time:((f=(u=s==null?void 0:s.days)==null?void 0:u.find(y=>y.day===n))==null?void 0:f.delay_buffer_time)||"",ex_delay_buffer_time:((B=(N=s==null?void 0:s.days)==null?void 0:N.find(y=>y.day===n))==null?void 0:B.ex_delay_buffer_time)||"",break_time:((H=(F=s==null?void 0:s.days)==null?void 0:F.find(y=>y.day===n))==null?void 0:H.break_time)||0,working_hour:((L=(K=s==null?void 0:s.days)==null?void 0:K.find(y=>y.day===n))==null?void 0:L.working_hour)||0,out_time:((U=(R=s==null?void 0:s.days)==null?void 0:R.find(y=>y.day===n))==null?void 0:U.out_time)||"",working_type:((W=(V=s==null?void 0:s.days)==null?void 0:V.find(y=>y.day===n))==null?void 0:W.working_type)||"full_day"}})}}),p=()=>{const n=c.getValues(),a=Object.keys($.shape);I.forEach((t,u)=>{a.forEach(f=>{c.setValue(`days.${u}.${f}`,n[f])})})};async function w(n){try{s?(await x({attendancePolicyId:s.id,updatedAttendancePolicy:n}).unwrap(),M.success("Policy updated successfully"),l()):(await g(n).unwrap(),M.success("Policy created successfully"),l())}catch(a){console.log(a),ie(a)}}return e.jsx(e.Fragment,{children:b||k?e.jsx("div",{children:e.jsx(J,{})}):e.jsx(D,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(w),className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-4",children:[e.jsx(d,{control:c.control,name:"name",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"Policy Name"}),e.jsx(o,{children:e.jsx(j,{className:"h-7",placeholder:"Enter Policy Name",...n})}),e.jsx(m,{})]})}),e.jsx(d,{control:c.control,name:"in_time",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"In Time"}),e.jsx(o,{children:e.jsx(j,{type:"time",className:"h-7",...n})}),e.jsx(m,{})]})}),e.jsx(d,{control:c.control,name:"delay_buffer_time",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"Delay Buffer Time"}),e.jsx(o,{children:e.jsx(j,{type:"time",className:"h-7",...n,placeholder:"Enter Delay Buffer"})}),e.jsx(m,{})]})}),e.jsx(d,{control:c.control,name:"ex_delay_buffer_time",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"Extra Delay Buffer"}),e.jsx(o,{children:e.jsx(j,{className:"h-7",type:"time",...n})}),e.jsx(m,{})]})}),e.jsx(d,{control:c.control,name:"break_time",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"Break Time (in minutes)"}),e.jsx(o,{children:e.jsx(j,{className:"h-7",type:"number",...n,placeholder:"Enter Break Time"})}),e.jsx(m,{})]})}),e.jsx(d,{control:c.control,name:"working_hour",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"Working Hours"}),e.jsx(o,{children:e.jsx(j,{className:"h-7",type:"text",...n,placeholder:"Enter Working Hours"})}),e.jsx(m,{})]})}),e.jsx(d,{control:c.control,name:"out_time",render:({field:n})=>e.jsxs(i,{children:[e.jsx(_,{children:"Out Time"}),e.jsx(o,{children:e.jsx(j,{className:"h-7",type:"time",...n,placeholder:"Enter Out Time"})}),e.jsx(m,{})]})})]}),e.jsx("div",{}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[e.jsx(d,{control:c.control,name:"ignore_overtime",render:({field:n})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm h-10",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(_,{children:"Ignore Overtime"})}),e.jsx(o,{children:e.jsx(A,{className:"!mt-0 ",checked:n.value===1,onCheckedChange:a=>n.onChange(a?1:0)})})]})}),e.jsx(d,{control:c.control,name:"discard_weekend_attendance",render:({field:n})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm h-10",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(_,{children:"Discard attendance on weekend"})}),e.jsx(o,{children:e.jsx(A,{className:"!mt-0 ",checked:n.value===1,onCheckedChange:a=>n.onChange(a?1:0)})})]})}),e.jsx(d,{control:c.control,name:"exclude_attendance_report",render:({field:n})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm h-10",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(_,{children:"Exclude from attendance report"})}),e.jsx(o,{children:e.jsx(A,{className:"!mt-0 ",checked:n.value===1,onCheckedChange:a=>n.onChange(a?1:0)})})]})})]}),e.jsx(T,{variant:"default",type:"button",onClick:p,children:"Copy to 7 days"}),e.jsx(ee,{children:e.jsxs(se,{children:[e.jsx(ne,{children:e.jsxs(q,{className:"text-left text-xs",children:[e.jsx(h,{className:"p-1 text-xs",children:"Day"}),e.jsx(h,{className:"p-1 text-xs",children:"In Time"}),e.jsx(h,{className:"p-1 text-xs",children:"Delay Buffer Time"}),e.jsx(h,{className:"p-1 text-xs",children:"Extra Delay Buffer"}),e.jsx(h,{className:"p-1 text-xs",children:"Break Time (In Min)"}),e.jsx(h,{className:"p-1 text-xs",children:"Working Hours (In Hours)"}),e.jsx(h,{className:"p-1 text-xs",children:"Out Time"}),e.jsx(h,{className:"p-1 text-xs",children:"Working Type"})]})}),e.jsx(le,{className:"divide-y",children:I.map((n,a)=>e.jsxs(q,{children:[e.jsx(h,{className:"p-1 text-xs",children:e.jsx(d,{control:c.control,name:`days.${a}.day`,render:()=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(j,{className:"p-1 text-xs h-7",value:n,readOnly:!0})}),e.jsx(m,{})]})})}),e.jsx(h,{className:"p-1",children:e.jsx("div",{className:"flex-1",children:e.jsx(d,{control:c.control,name:`days.${a}.in_time`,render:({field:t})=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(j,{className:"p-1 text-xs h-7",type:"time",placeholder:"Enter In Time",...t,value:t.value||""})}),e.jsx(m,{})]})})})}),e.jsx(h,{className:"p-1",children:e.jsx("div",{className:"flex-1",children:e.jsx(d,{control:c.control,name:`days.${a}.delay_buffer_time`,render:({field:t})=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(j,{className:"p-1 text-xs h-7",type:"time",placeholder:"Enter In Time",...t,value:t.value||""})}),e.jsx(m,{})]})})})}),e.jsx(h,{className:"p-1",children:e.jsx("div",{className:"",children:e.jsx(d,{control:c.control,name:`days.${a}.ex_delay_buffer_time`,render:({field:t})=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(j,{className:"p-1 text-xs h-7",type:"time",placeholder:"Enter In Time",...t,value:t.value||""})}),e.jsx(m,{})]})})})}),e.jsx(h,{className:"p-1",children:e.jsx("div",{className:"",children:e.jsx(d,{control:c.control,name:`days.${a}.break_time`,render:({field:t})=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(j,{type:"number",className:"p-1 text-xs h-7",...t,value:t.value||""})}),e.jsx(m,{})]})})})}),e.jsx(h,{className:"p-1",children:e.jsx("div",{className:"flex-1",children:e.jsx(d,{control:c.control,name:`days.${a}.working_hour`,render:({field:t})=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(j,{type:"number",className:"p-1 text-xs h-7",...t,value:t.value||""})}),e.jsx(m,{})]})})})}),e.jsx(h,{children:e.jsx(d,{control:c.control,name:`days.${a}.out_time`,render:({field:t})=>e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(j,{className:"p-1 text-xs h-7",type:"time",...t,value:t.value||""})}),e.jsx(m,{})]})})}),e.jsx("div",{className:"mr-1",children:e.jsx(d,{control:c.control,name:`days.${a}.working_type`,render:({field:t})=>{var u,f;return e.jsxs(i,{className:"p-1 text-xs h-7 w-[100px]",children:[e.jsxs(ce,{onValueChange:t.onChange,defaultValue:(f=(u=s==null?void 0:s.days)==null?void 0:u[a])!=null&&f.working_type?String(s.days[a].working_type):"full_day",children:[e.jsx(o,{className:"p-1 text-xs h-7 mt-[6px]",children:e.jsx(ae,{children:e.jsx(te,{placeholder:"Full Time"})})}),e.jsx(re,{children:E==null?void 0:E.map(N=>e.jsx(de,{value:String(N.value),children:N.label},N.value))})]}),e.jsx(m,{})]})}})})]},a))})]})}),e.jsx("div",{className:"text-right",children:e.jsx(T,{variant:"default",type:"submit",className:"w-fit mt-4",children:s?"Update":"Add"})})]})})})}function we({data:l}){const[s,g]=O.useState(!1),[b,x]=O.useState(!1),[k,{isLoading:c}]=ke(),p=async w=>{try{await k(w),M.success("Policy deleted successfully"),g(!1)}catch(n){console.log(n)}};return e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx(P,{children:e.jsxs(C,{children:[e.jsx(z,{asChild:!0,children:e.jsx(T,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>x(!0),children:e.jsx(oe,{className:"h-4 w-4 text-foreground"})})}),e.jsx(S,{children:e.jsx("p",{children:"Update Job Post"})})]})}),e.jsx(P,{children:e.jsx(C,{children:e.jsx(S,{children:e.jsx("p",{children:"Delete Requisition"})})})}),e.jsx(P,{children:e.jsxs(C,{children:[e.jsx(z,{asChild:!0,children:e.jsx(T,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{g(!0)},children:e.jsx(xe,{className:"h-4 w-4 text-foreground"})})}),e.jsx(S,{children:e.jsx("p",{children:"Delete Policy"})})]})}),e.jsx(me,{title:"Are you sure?",description:"This action cannot be undone.",name:l.name,isOpen:s,onClose:()=>g(!1),onConfirm:()=>p(l.id),loading:c}),b&&e.jsx(Q,{title:"Update Policy",isOpen:b,toggleModal:()=>x(!1),className:"w-[90%] max-w-6xl",children:e.jsx(Z,{data:l,modalClose:()=>x(!1)})})]})}const Te=[{id:"select",header:({table:l})=>e.jsx(Y,{checked:l.getIsAllPageRowsSelected()||l.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:s=>l.toggleAllPageRowsSelected(!!s),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:l})=>e.jsx(Y,{checked:l.getIsSelected(),onCheckedChange:s=>l.toggleSelected(!!s),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:"Policy Name"},{accessorKey:"in_time",header:"In Time"},{accessorKey:"delay_buffer_time",header:"Delay Buffer"},{accessorKey:"ex_delay_buffer_time",header:"Ex Delay Buffer"},{accessorKey:"break_time",header:"Break Time"},{accessorKey:"working_hour",header:"Working Hours"},{accessorKey:"out_time",header:"Out Time"},{accessorKey:"ignore_overtime",header:"Ignore Overtime",cell:({row:l})=>l.original.ignore_overtime===1?"Yes":"No"},{accessorKey:"exclude_attendance_report",header:"Ignore from att report",cell:({row:l})=>l.original.exclude_attendance_report===1?"Yes":"No"},{accessorKey:"discard_weekend_attendance",header:"Discard attendance on weekend",cell:({row:l})=>l.original.discard_weekend_attendance===1?"Yes":"No"},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"Actions"}),enableSorting:!1,cell:({row:l})=>e.jsx(we,{data:l.original})}],Se=()=>{const[l,s]=O.useState(!1),[g,b]=he.useState({pageIndex:0,pageSize:10}),{data:x,isLoading:k}=be(`per_page=${g.pageSize}&page=${g.pageIndex+1}`),c=(x==null?void 0:x.data)||[];console.log(x,"hello");const p=(x==null?void 0:x.data)||[],w=x==null?void 0:x.meta;return k?e.jsx(J,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(je,{title:"Attendance Policy",description:"Manage job apply for you business"}),e.jsxs(T,{onClick:()=>s(!0),size:"sm",children:[e.jsx(ye,{className:"mr-2 h-4 w-4"})," Add Attendance Policy"]})]}),e.jsx(ge,{}),p&&e.jsx("div",{children:e.jsx(_e,{columns:Te,data:c,paginationInfo:w,pagination:g,setPagination:b})})]})}),l&&e.jsx(Q,{title:"Add Attendance Policy",isOpen:l,toggleModal:()=>s(!1),className:"w-2/3 max-w-5xl",children:e.jsx(Z,{modalClose:()=>s(!1)})})]})};export{Se as default};
