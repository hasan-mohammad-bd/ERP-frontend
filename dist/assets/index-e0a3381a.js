import{a_ as R,j as e,R as _,b0 as S,b1 as n,L as $,n as U,J as se,b2 as ne,b3 as re,b4 as C,b5 as le,U as H,V as Q,W as A,X as J,Y as u,Z as p,_ as g,y as ae,z as ce,$ as y,B as L,k as V,b6 as de,D as te,b7 as oe,b8 as ie,b9 as xe,ba as he,bb as me,bc as je,bd as ue,a0 as b,I as w,be as pe,a2 as Y,bf as ge,ah as E,ai as M,aj as F,ak as O,al as N,bg as ye,r as v,ac as be,s as z,ad as fe,aa as B}from"./index-6fa63041.js";import{T as Ne,a as Ce,b as Ae,c as Se}from"./tabs-f9180891.js";import{B as W}from"./badge-e37f5d6e.js";import{S as Le}from"./switch-597609ff.js";const Te=R.injectEndpoints({endpoints:r=>({getLedgerGroups:r.query({query:()=>"ledger-groups?tree=1",providesTags:["ledger-groups-tree"]}),getLedgerGroupsArray:r.query({query:()=>"ledger-groups",providesTags:["ledger-groups-array"]}),createLedgerGroup:r.mutation({query:s=>({url:"ledger-groups",method:"POST",body:s}),invalidatesTags:["ledger-groups","ledger-groups-tree","ledger-groups-array"]}),removeLedgerGroup:r.mutation({query:s=>({url:`ledger-groups/${s}`,method:"DELETE"}),invalidatesTags:["ledger-groups"]}),updateLedgerGroup:r.mutation({query:({ledgerGroupId:s,updatedLedgerGroup:c})=>({url:`ledger-groups/${s}`,method:"PUT",body:c}),invalidatesTags:["ledger-groups"]})}),overrideExisting:!1}),{useGetLedgerGroupsQuery:we,useGetLedgerGroupsArrayQuery:X,useCreateLedgerGroupMutation:Ge,useRemoveLedgerGroupMutation:Ve,useUpdateLedgerGroupMutation:ve}=Te,Z=({group:r,coaType:s,depth:c=0})=>{const a=Array(c).fill("        ").join("");return r.childs_group.map(d=>e.jsxs(_.Fragment,{children:[e.jsxs(S,{children:[e.jsxs(n,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:[a,d.name]}),e.jsx(n,{className:"py-2.5",children:d.code}),e.jsx(n,{className:"py-2.5",children:"Group"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"})]}),d.childs_group&&d.childs_group.length>0&&e.jsx(Z,{group:d,coaType:s,depth:c+1}),d.ledgers&&d.ledgers.length>0&&d.ledgers.map(x=>e.jsxs(S,{children:[e.jsx(n,{className:"py-0 col-span-2 w-2/3",children:e.jsxs($,{className:U({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/detailed-general-ledger/${x.id}`,children:[a,x.name]})}),e.jsx(n,{className:"py-2.5",children:x.code}),e.jsx(n,{className:"py-2.5",children:"Account"}),e.jsx(n,{className:"py-2.5",children:e.jsx(W,{variant:"outline",children:"active"})}),e.jsx(n,{className:"py-2.5",children:"700"}),e.jsx(n,{className:"py-2.5",children:"500"})]},x.id))]},d.id))},Ee=({data:r,coaType:s})=>{const c=r.find(a=>a.name===s);return c?e.jsx(se,{className:"mt-4",children:e.jsxs(ne,{children:[e.jsx(re,{children:e.jsxs(S,{children:[e.jsx(C,{className:"py-2.5 h-8 col-span-2 w-2/3",children:"Name"}),e.jsx(C,{className:"py-2.5 h-8 w-[100px]",children:"Code"}),e.jsx(C,{className:"py-2.5 h-8",children:"Type"}),e.jsx(C,{className:"py-2.5 h-8",children:"Status"}),e.jsx(C,{className:"py-2.5 h-8",children:"Debit"}),e.jsx(C,{className:"py-2.5 h-8",children:"Credit"})]})}),e.jsxs(le,{children:[e.jsxs(S,{children:[e.jsx(n,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:c.name}),e.jsx(n,{className:"py-2.5",children:c.code}),e.jsx(n,{className:"py-2.5",children:"Group"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"}),e.jsx(n,{className:"py-2.5"})]}),e.jsx(Z,{group:c,coaType:s,depth:1}),c.ledgers.map(a=>e.jsxs(S,{children:[e.jsx(n,{className:"py-2.5 col-span-2 w-2/3",children:e.jsxs($,{className:U({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/detailed-general-ledger/${a.id}`,children:["    ",a.name]})}),e.jsx(n,{className:"py-2.5",children:a.code}),e.jsx(n,{className:"py-2.5",children:"Account"}),e.jsx(n,{className:"py-2.5",children:e.jsx(W,{variant:"secondary",children:"Inactive"})}),e.jsx(n,{className:"py-2.5",children:"700"}),e.jsx(n,{className:"py-2.5",children:"500"})]},a.id))]})]})}):null},P=[{type:"Assets",title:"Assets",description:"Manage assets for your business"},{type:"Liabilities",title:"Liabilities",description:"Manage liabilities for your business"},{type:"Income",title:"Incomes",description:"Manage incomes for your business"},{type:"Expenses",title:"Expenses",description:"Manage expenses for your business"}];function Me({modalClose:r,rowData:s}){const[c,a]=_.useState(!1),[d,{isLoading:x}]=Ge(),{data:f,isLoading:o}=X(),T=(f==null?void 0:f.data)||[],j=H({resolver:Q(pe),defaultValues:{parent_id:(s==null?void 0:s.id)||0}});async function G(i){try{await d(i),Y.success("Add ledger group successfully"),r()}catch(h){console.log(h)}}return e.jsx(e.Fragment,{children:x?e.jsx("div",{className:"h-56",children:e.jsx(A,{})}):e.jsx(J,{...j,children:e.jsxs("form",{onSubmit:j.handleSubmit(G),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(u,{control:j.control,name:"parent_id",render:({field:i})=>{var h;return e.jsxs(p,{children:[e.jsx(g,{children:"Parent Group"}),e.jsxs(ae,{open:c,onOpenChange:a,modal:!0,children:[e.jsx(ce,{asChild:!0,children:e.jsx(y,{children:e.jsxs(L,{variant:"outline",role:"combobox",className:V("w-full justify-between",!i.value&&"text-muted-foreground"),children:[i.value?(h=T.find(t=>t.id===Number(i.value)))==null?void 0:h.name:"Select Parent",e.jsx(de,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(te,{className:"w-[460px] p-0",children:e.jsxs(oe,{children:[e.jsx(ie,{placeholder:"Search parent group..."}),e.jsxs(xe,{children:[e.jsx(he,{children:"No parent group found."}),e.jsx(me,{children:o?e.jsx(A,{}):T.map(t=>e.jsxs(je,{onSelect:()=>{i.onChange(String(t.id)),a(!1)},children:[e.jsx(ue,{className:V("mr-2 h-4 w-4",Number(i.value)===t.id?"opacity-100":"opacity-0")}),t.name]},t.id))})]})]})})]}),e.jsx(b,{})]})}}),e.jsx(u,{control:j.control,name:"name",render:({field:i})=>e.jsxs(p,{children:[e.jsx(g,{children:"Account Name"}),e.jsx(y,{children:e.jsx(w,{placeholder:"Enter name",...i})}),e.jsx(b,{})]})}),e.jsx(u,{control:j.control,name:"code",render:({field:i})=>e.jsxs(p,{children:[e.jsx(g,{children:"Code"}),e.jsx(y,{children:e.jsx(w,{placeholder:"Enter code",...i,value:i.value||""})}),e.jsx(b,{})]})})]}),e.jsx("div",{children:e.jsx(L,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Group"})})]})})})}const Fe=R.injectEndpoints({endpoints:r=>({getEnum:r.query({query:()=>"catalogs/enum",providesTags:["catalogs/enum"]})}),overrideExisting:!1}),{useGetEnumQuery:Oe}=Fe;function Pe({modalClose:r,rowData:s,coaType:c}){var k,q;const[a,{isLoading:d}]=ge(),[x,f]=_.useState(0),{data:o,isLoading:T}=X(),{data:j,isLoading:G}=Oe(),i=(j==null?void 0:j.account_nature)||[],h=(o==null?void 0:o.data)||[],t=H({resolver:Q(ye),defaultValues:{name:(s==null?void 0:s.name)||"",parent_id:(s==null?void 0:s.id)||0,is_sub_type:0,nature:(s==null?void 0:s.nature)||""}});console.log(h);const K=t.watch("parent_id"),I=h==null?void 0:h.filter(l=>(l==null?void 0:l.id)==K);console.log((k=I[0])==null?void 0:k.type);async function D(l){try{await a(l),Y.success("Add ledger account successfully"),r()}catch(m){console.log(m)}}return e.jsx(e.Fragment,{children:d?e.jsx("div",{className:"h-56",children:e.jsx(A,{})}):e.jsx(J,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(D),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(u,{control:t.control,name:"parent_id",render:({field:l})=>e.jsxs(p,{children:[e.jsx(g,{children:"Parent Group"}),e.jsxs(E,{onValueChange:l.onChange,children:[e.jsx(y,{children:e.jsx(M,{children:e.jsx(F,{placeholder:"Select Parent"})})}),e.jsx(O,{children:T?e.jsx(A,{}):h==null?void 0:h.map(m=>e.jsx(N,{value:String(m.id),children:m.name},m.id))})]}),e.jsx(b,{})]})}),e.jsx(u,{control:t.control,name:"name",render:({field:l})=>e.jsxs(p,{children:[e.jsx(g,{children:"Account Name"}),e.jsx(y,{children:e.jsx(w,{placeholder:"Enter ledger account name",...l})}),e.jsx(b,{})]})}),e.jsx(u,{control:t.control,name:"code",render:({field:l})=>e.jsxs(p,{children:[e.jsx(g,{children:"Code"}),e.jsx(y,{children:e.jsx(w,{placeholder:"Enter code",...l,value:l.value||""})}),e.jsx(b,{})]})})]}),c==="Assets"||((q=I[0])==null?void 0:q.type)==="Assets"?e.jsx(u,{control:t.control,name:"nature",render:({field:l})=>e.jsxs(p,{children:[e.jsx(g,{children:"Default Account Type"}),e.jsxs(E,{onValueChange:l.onChange,children:[e.jsx(y,{children:e.jsx(M,{children:e.jsx(F,{placeholder:"Select Parent"})})}),e.jsx(O,{children:G?e.jsx(A,{}):i.map((m,ee)=>e.jsx(N,{value:m.toString(),children:m.toString()},ee))})]}),e.jsx(b,{})]})}):null,e.jsx(u,{control:t.control,name:"is_sub_type",render:({field:l})=>e.jsxs(p,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(g,{children:"Is Sub Type"})}),e.jsx(y,{children:e.jsx(Le,{checked:l.value===1,onCheckedChange:m=>{l.onChange(m?1:0),f(m?1:0)}})})]})}),x===1&&e.jsx(u,{control:t.control,name:"sub_type",render:({field:l})=>e.jsxs(p,{children:[e.jsx(g,{children:"Sub Type"}),e.jsxs(E,{onValueChange:l.onChange,defaultValue:"None",children:[e.jsx(y,{children:e.jsx(M,{children:e.jsx(F,{placeholder:""})})}),e.jsxs(O,{children:[e.jsx(N,{value:"None",children:"None"}),e.jsx(N,{value:"Employee",children:"Employee"}),e.jsx(N,{value:"Customer",children:"Customer"}),e.jsx(N,{value:"Supplier",children:"Supplier"}),e.jsx(N,{value:"Agent",children:"Agent"})]})]}),e.jsx(b,{})]})}),e.jsx("div",{children:e.jsx(L,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Account"})})]})})})}const ze=()=>{const{data:r,isLoading:s}=we(),[c,a]=v.useState(!1),[d,x]=v.useState(!1),f=(r==null?void 0:r.data)||[];return s?e.jsx(A,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(be,{title:"Chart Of Account",description:"Manage Chart of account for you business"}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsxs(L,{onClick:()=>a(!0),size:"sm",children:[e.jsx(z,{className:"mr-2 h-4 w-4"})," Add Group"]}),e.jsxs(L,{onClick:()=>x(!0),size:"sm",children:[e.jsx(z,{className:"mr-2 h-4 w-4"})," Add Account"]})]})]}),e.jsx(fe,{}),e.jsxs(Ne,{defaultValue:P[0].type,className:"w-full mt-3",children:[e.jsx(Ce,{className:"w-fit",children:P.map(o=>e.jsx(Ae,{value:o.type,children:o.title},o.type))}),P.map(o=>e.jsx(Se,{value:o.type,children:e.jsx(Ee,{title:o.title,coaType:o.type,description:o.description,data:f})},o.type))]}),c&&e.jsx(B,{title:"Add Group",isOpen:c,toggleModal:()=>a(!1),children:e.jsx(Me,{modalClose:()=>a(!1)})}),d&&e.jsx(B,{title:"Add Account",isOpen:d,toggleModal:()=>x(!1),children:e.jsx(Pe,{modalClose:()=>x(!1)})})]})};export{ze as default};
