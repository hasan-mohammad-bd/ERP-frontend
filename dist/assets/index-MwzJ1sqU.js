import{h as k,j as e,A as u,r as f,R as v}from"./index-CwtkdAoF.js";import{u as _,t as z,L as S,F as U,a as C,b as T,c as b,d as F,e as A,S as q,f as H,g as K,h as V,i as G,M as P,H as Q}from"./modal-DpBJVnX2.js";import{B as j}from"./index-Cxev_hGH.js";import{$ as B}from"./index-D-gdl2yy.js";import{P as J,T as W,A as X,C as N,D as Y}from"./alert-modal-BmFBKbfb.js";import{I as Z}from"./input-BHxcSLDT.js";import{R as D}from"./validators-P_ADjOZ1.js";import{u as ee}from"./index-DzKmGKfs.js";import{c as se}from"./index-DxOvx-Jd.js";import{T as M,a as w,b as I,c as L}from"./tooltip-BMgwtow4.js";import{P as te}from"./sheet-CUiZ_cAH.js";import"./dropdown-menu-DfrG1frA.js";import"./chevron-right-DEhBy0bI.js";import"./card-Ba-Nv17p.js";const re=k.injectEndpoints({endpoints:s=>({getRosters:s.query({query:t=>`rosters?${t}`,providesTags:["rosters"]}),createRoster:s.mutation({query:t=>({url:"rosters",method:"POST",body:t}),invalidatesTags:["rosters"]}),removeRoster:s.mutation({query:t=>({url:`rosters/${t}`,method:"DELETE"}),invalidatesTags:["rosters"]}),updateRoster:s.mutation({query:({rosterId:t,updatedRoster:a})=>({url:`rosters/${t}`,method:"PUT",body:a}),invalidatesTags:["rosters"]})}),overrideExisting:!1}),{useGetRostersQuery:ae,useCreateRosterMutation:oe,useRemoveRosterMutation:ne,useUpdateRosterMutation:le}=re;function $({modalClose:s,data:t}){var y,R;const[a,{isLoading:d}]=oe(),[r,{isLoading:m}]=le(),{data:l}=se("page=1&per_page=1000"),h=(l==null?void 0:l.data)||[],{data:c,isLoading:p}=ee("page=1&per_page=1000"),x=(c==null?void 0:c.data)||[],g=_({resolver:z(D),defaultValues:{date:((y=t==null?void 0:t.date)==null?void 0:y.date)||"",schedule_id:((R=t==null?void 0:t.schedule)==null?void 0:R.id)||1}}),E=n=>h.some(o=>o.date.date===n);async function O(n){try{t?(await r({rosterId:t.id,updatedRoster:n}),u.success("Roster updated successfully"),s()):(await a(n),u.success("Roster created successfully"),s())}catch(o){console.log(o)}}return e.jsx(e.Fragment,{children:d||m?e.jsx("div",{className:"h-56",children:e.jsx(S,{})}):e.jsx(U,{...g,children:e.jsxs("form",{onSubmit:g.handleSubmit(O),className:"w-full space-y-3",children:[e.jsx(C,{control:g.control,name:"date",render:({field:n})=>e.jsxs(T,{children:[e.jsx(b,{children:"Date"}),e.jsx(F,{children:e.jsx(Z,{type:"date",placeholder:"Enter date",...n,onChange:o=>{const i=o.target.value;E(i)?(o.preventDefault(),u.error(`${i} is a holiday`)):n.onChange(o)}})}),e.jsx(A,{})]})}),e.jsx(C,{control:g.control,name:"schedule_id",render:({field:n})=>{var o;return e.jsxs(T,{children:[e.jsx(b,{children:" Schedule"}),e.jsxs(q,{onValueChange:n.onChange,defaultValue:(o=t==null?void 0:t.schedule)!=null&&o.id?String(t.schedule.id):void 0,children:[e.jsx(F,{children:e.jsx(H,{children:e.jsx(K,{placeholder:"Select Schedule"})})}),e.jsx(V,{children:p?e.jsx(S,{}):x==null?void 0:x.map(i=>e.jsx(G,{value:String(i.id),children:i.name},i.id))})]}),e.jsx(A,{})]})}}),e.jsx("div",{children:e.jsx(j,{variant:"default",type:"submit",className:"w-full mt-4",children:t?"Update":"Add"})})]})})})}function ce({data:s}){var c;const[t,a]=f.useState(!1),[d,r]=f.useState(!1),[m,{isLoading:l}]=ne(),h=async p=>{try{await m(p),u.success("Roster deleted successfully"),a(!1)}catch(x){console.log(x)}};return e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx(M,{children:e.jsxs(w,{children:[e.jsx(I,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>r(!0),children:e.jsx(J,{className:"h-4 w-4 text-foreground"})})}),e.jsx(L,{children:e.jsx("p",{children:"Update Section"})})]})}),e.jsx(M,{children:e.jsxs(w,{children:[e.jsx(I,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{a(!0)},children:e.jsx(W,{className:"h-4 w-4 text-foreground"})})}),e.jsx(L,{children:e.jsx("p",{children:"Delete Schedule"})})]})}),e.jsx(X,{title:"Are you sure?",description:"This action cannot be undone.",name:(c=s==null?void 0:s.date)==null?void 0:c.date,isOpen:t,onClose:()=>a(!1),onConfirm:()=>h(s.id),loading:l}),e.jsx(P,{title:"Update Roster",isOpen:d,toggleModal:()=>r(!1),children:e.jsx($,{data:s,modalClose:()=>r(!1)})})]})}const ie=[{id:"select",header:({table:s})=>e.jsx(N,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:t=>s.toggleAllPageRowsSelected(!!t),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(N,{checked:s.getIsSelected(),onCheckedChange:t=>s.toggleSelected(!!t),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"",accessorFn:({date:s})=>s==null?void 0:s.date,header:"Date"},{accessorKey:"",accessorFn:({schedule:s})=>s==null?void 0:s.start_time,header:"Schedule Start time"},{accessorKey:"",accessorFn:({schedule:s})=>s==null?void 0:s.end_time,header:"Schedule End time"},{accessorKey:"",accessorFn:({schedule:s})=>s==null?void 0:s.hour,header:"Schedule Hour"},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"Actions"}),enableSorting:!1,cell:({row:s})=>e.jsx(ce,{data:s.original})}],be=()=>{const[s,t]=f.useState(!1),[a,d]=v.useState({pageIndex:0,pageSize:10}),{data:r,isLoading:m}=ae(`per_page=${a.pageSize}&page=${a.pageIndex+1}`),l=(r==null?void 0:r.data)||[],h=r==null?void 0:r.meta;return m?e.jsx(S,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Q,{title:"Roster",description:"Manage roster for you organization"}),e.jsxs(j,{onClick:()=>t(!0),size:"sm",children:[e.jsx(te,{className:"mr-2 h-4 w-4"})," Add Roster"]})]}),e.jsx(B,{}),l&&e.jsx("div",{children:e.jsx(Y,{columns:ie,data:l,paginationInfo:h,pagination:a,setPagination:d})})]})}),e.jsx(P,{title:"Add Roster",isOpen:s,toggleModal:()=>t(!1),children:e.jsx($,{modalClose:()=>t(!1)})})]})};export{be as default};
