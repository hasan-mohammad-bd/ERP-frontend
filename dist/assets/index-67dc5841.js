import{a1 as B,a as e,R as I,V as S,Y as r,L as $,o as Q,F as se,Q as ne,U as ae,W as C,X as le,af as q,a6 as U,a7 as H,$ as A,a8 as Y,a9 as p,aa as g,ab as y,y as re,z as ce,ac as f,B as w,b as k,ba as de,D as te,bb as oe,bc as ie,bd as he,be as xe,bf as ue,bg as je,bh as me,ad as N,I as T,bi as pe,bj as ge,au as G,av as M,aw as O,ax as F,ay as b,bk as ye,r as V,ap as fe,t as v,aq as Ne,an as z}from"./index-e8c93185.js";import{T as be,a as Ce,b as Ae,c as Se}from"./tabs-35e05170.js";import{B as J}from"./badge-0c91fdc2.js";import{S as we}from"./switch-855576f9.js";const Le=B.injectEndpoints({endpoints:n=>({getLedgerGroups:n.query({query:()=>"ledger-groups?tree=1",providesTags:["ledger-groups-tree"]}),getLedgerGroupsArray:n.query({query:()=>"ledger-groups",providesTags:["ledger-groups-array"]}),createLedgerGroup:n.mutation({query:s=>({url:"ledger-groups",method:"POST",body:s}),invalidatesTags:["ledger-groups","ledger-groups-tree","ledger-groups-array"]}),removeLedgerGroup:n.mutation({query:s=>({url:`ledger-groups/${s}`,method:"DELETE"}),invalidatesTags:["ledger-groups"]}),updateLedgerGroup:n.mutation({query:({ledgerGroupId:s,updatedLedgerGroup:l})=>({url:`ledger-groups/${s}`,method:"PUT",body:l}),invalidatesTags:["ledger-groups"]})}),overrideExisting:!1}),{useGetLedgerGroupsQuery:Te,useGetLedgerGroupsArrayQuery:W,useCreateLedgerGroupMutation:Ee,useRemoveLedgerGroupMutation:ve,useUpdateLedgerGroupMutation:ze}=Le,X=({group:n,coaType:s,depth:l=0})=>{const c=Array(l).fill("        ").join("");return n.childs_group.map(d=>e.jsxs(I.Fragment,{children:[e.jsxs(S,{children:[e.jsxs(r,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:[c,d.name]}),e.jsx(r,{className:"py-2.5",children:d.code}),e.jsx(r,{className:"py-2.5",children:"Group"}),e.jsx(r,{className:"py-2.5"}),e.jsx(r,{className:"py-2.5"}),e.jsx(r,{className:"py-2.5"})]}),d.childs_group&&d.childs_group.length>0&&e.jsx(X,{group:d,coaType:s,depth:l+1}),d.ledgers&&d.ledgers.length>0&&d.ledgers.map(i=>e.jsxs(S,{children:[e.jsx(r,{className:"py-0 col-span-2 w-2/3",children:e.jsxs($,{className:Q({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/reports/detailed-general-ledger/${i.id}`,children:[c,i.name]})}),e.jsx(r,{className:"py-2.5",children:i.code}),e.jsx(r,{className:"py-2.5",children:"Account"}),e.jsx(r,{className:"py-2.5",children:e.jsx(J,{variant:"outline",children:"active"})}),e.jsx(r,{className:"py-2.5",children:"700"}),e.jsx(r,{className:"py-2.5",children:"500"})]},i.id))]},d.id))},Ge=({data:n,coaType:s})=>{const l=n.find(c=>c.name===s);return l?e.jsx(se,{className:"mt-4",children:e.jsxs(ne,{children:[e.jsx(ae,{children:e.jsxs(S,{children:[e.jsx(C,{className:"py-2.5 h-8 col-span-2 w-2/3",children:"Name"}),e.jsx(C,{className:"py-2.5 h-8 w-[100px]",children:"Code"}),e.jsx(C,{className:"py-2.5 h-8",children:"Type"}),e.jsx(C,{className:"py-2.5 h-8",children:"Status"}),e.jsx(C,{className:"py-2.5 h-8",children:"Debit"}),e.jsx(C,{className:"py-2.5 h-8",children:"Credit"})]})}),e.jsxs(le,{children:[e.jsxs(S,{children:[e.jsx(r,{className:"py-2.5 col-span-2 w-2/3 font-medium",children:l.name}),e.jsx(r,{className:"py-2.5",children:l.code}),e.jsx(r,{className:"py-2.5",children:"Group"}),e.jsx(r,{className:"py-2.5"}),e.jsx(r,{className:"py-2.5"}),e.jsx(r,{className:"py-2.5"})]}),e.jsx(X,{group:l,coaType:s,depth:1}),l.ledgers.map(c=>e.jsxs(S,{children:[e.jsx(r,{className:"py-2.5 col-span-2 w-2/3",children:e.jsxs($,{className:Q({variant:"link",size:"sm",className:"text-blue-400 hover:no-underline"}),to:`/accounts/detailed-general-ledger/${c.id}`,children:["    ",c.name]})}),e.jsx(r,{className:"py-2.5",children:c.code}),e.jsx(r,{className:"py-2.5",children:"Account"}),e.jsx(r,{className:"py-2.5",children:e.jsx(J,{variant:"secondary",children:"Inactive"})}),e.jsx(r,{className:"py-2.5",children:"700"}),e.jsx(r,{className:"py-2.5",children:"500"})]},c.id))]})]})}):null},P=[{type:"Assets",title:"Assets",description:"Manage assets for your business"},{type:"Liabilities",title:"Liabilities",description:"Manage liabilities for your business"},{type:"Income",title:"Incomes",description:"Manage incomes for your business"},{type:"Expenses",title:"Expenses",description:"Manage expenses for your business"}];function Me(n){var c,d;const s=(c=n==null?void 0:n.data)==null?void 0:c.data,l=[];if(s)for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&s[i].forEach(j=>{l.push(j)});return l.length===0&&l.push(((d=n==null?void 0:n.data)==null?void 0:d.message)||"Something went wrong. Please try again."),l}function K(n){Me(n).forEach(l=>{q.error(l)})}function Oe({modalClose:n,rowData:s}){const[l,c]=I.useState(!1),[d,{isLoading:i}]=Ee(),{data:j,isLoading:h}=W(),L=(j==null?void 0:j.data)||[],m=U({resolver:H(pe),defaultValues:{parent_id:s==null?void 0:s.id}});async function E(x){try{await d(x).unwrap(),q.success("Add ledger group successfully"),n()}catch(u){K(u),console.log(u)}}return e.jsx(e.Fragment,{children:i?e.jsx("div",{className:"h-56",children:e.jsx(A,{})}):e.jsx(Y,{...m,children:e.jsxs("form",{onSubmit:m.handleSubmit(E),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(p,{control:m.control,name:"parent_id",render:({field:x})=>{var u;return e.jsxs(g,{children:[e.jsx(y,{children:"Parent Group"}),e.jsxs(re,{open:l,onOpenChange:c,modal:!0,children:[e.jsx(ce,{asChild:!0,children:e.jsx(f,{children:e.jsxs(w,{variant:"outline",role:"combobox",className:k("w-full justify-between",!x.value&&"text-muted-foreground"),children:[x.value?(u=L.find(o=>o.id===Number(x.value)))==null?void 0:u.name:"Select Parent",e.jsx(de,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(te,{className:"w-[460px] p-0",children:e.jsxs(oe,{children:[e.jsx(ie,{placeholder:"Search parent group..."}),e.jsxs(he,{children:[e.jsx(xe,{children:"No parent group found."}),e.jsx(ue,{children:h?e.jsx(A,{}):L.map(o=>e.jsxs(je,{onSelect:()=>{x.onChange(String(o.id)),c(!1)},children:[e.jsx(me,{className:k("mr-2 h-4 w-4",Number(x.value)===o.id?"opacity-100":"opacity-0")}),o.name]},o.id))})]})]})})]}),e.jsx(N,{})]})}}),e.jsx(p,{control:m.control,name:"name",render:({field:x})=>e.jsxs(g,{children:[e.jsx(y,{children:"Account Name"}),e.jsx(f,{children:e.jsx(T,{placeholder:"Enter name",...x})}),e.jsx(N,{})]})}),e.jsx(p,{control:m.control,name:"code",render:({field:x})=>e.jsxs(g,{children:[e.jsx(y,{children:"Code"}),e.jsx(f,{children:e.jsx(T,{placeholder:"Enter code",...x,value:x.value||""})}),e.jsx(N,{})]})})]}),e.jsx("div",{children:e.jsx(w,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Group"})})]})})})}const Fe=B.injectEndpoints({endpoints:n=>({getEnum:n.query({query:()=>"catalogs/enum",providesTags:["catalogs/enum"]})}),overrideExisting:!1}),{useGetEnumQuery:Pe}=Fe;function Ie({modalClose:n,rowData:s,coaType:l}){var _;const[c,{isLoading:d}]=ge(),[i,j]=I.useState(0),{data:h,isLoading:L}=W(),{data:m,isLoading:E}=Pe(),x=(m==null?void 0:m.account_nature)||[],u=(h==null?void 0:h.data)||[];console.log(u);const o=U({resolver:H(ye),defaultValues:{name:(s==null?void 0:s.name)||"",parent_id:s==null?void 0:s.id,is_sub_type:0,nature:(s==null?void 0:s.nature)||""}});console.log(u);const Z=o.watch("parent_id"),R=u==null?void 0:u.filter(t=>(t==null?void 0:t.id)==Z);async function D(t){try{await c(t).unwrap(),q.success("Add ledger account successfully"),n()}catch(a){K(a),console.log(a)}}return e.jsx(e.Fragment,{children:d?e.jsx("div",{className:"h-56",children:e.jsx(A,{})}):e.jsx(Y,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(D),className:"w-full space-y-3",children:[(s==null?void 0:s.id)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Parent:"})," ",s==null?void 0:s.name]}),!(s!=null&&s.id)&&e.jsxs(e.Fragment,{children:[e.jsx(p,{control:o.control,name:"parent_id",render:({field:t})=>e.jsxs(g,{children:[e.jsx(y,{children:"Parent Group"}),e.jsxs(G,{onValueChange:t.onChange,children:[e.jsx(f,{children:e.jsx(M,{children:e.jsx(O,{placeholder:"Select Parent"})})}),e.jsx(F,{children:L?e.jsx(A,{}):u==null?void 0:u.filter(a=>(a==null?void 0:a.name)!=="Assets"&&(a==null?void 0:a.name)!=="Liabilities"&&(a==null?void 0:a.name)!=="Equity"&&(a==null?void 0:a.name)!=="Expenses"&&(a==null?void 0:a.name)!=="Owner's Equity").map(a=>e.jsx(b,{value:String(a.id),children:a.name},a.id))})]}),e.jsx(N,{})]})}),e.jsx(p,{control:o.control,name:"name",render:({field:t})=>e.jsxs(g,{children:[e.jsx(y,{children:"Account Name"}),e.jsx(f,{children:e.jsx(T,{placeholder:"Enter ledger account name",...t})}),e.jsx(N,{})]})}),e.jsx(p,{control:o.control,name:"code",render:({field:t})=>e.jsxs(g,{children:[e.jsx(y,{children:"Code"}),e.jsx(f,{children:e.jsx(T,{placeholder:"Enter code",...t,value:t.value||""})}),e.jsx(N,{})]})})]}),l==="Assets"||((_=R[0])==null?void 0:_.type)==="Assets"?e.jsx(p,{control:o.control,name:"nature",render:({field:t})=>e.jsxs(g,{children:[e.jsx(y,{children:"Default Account Type"}),e.jsxs(G,{onValueChange:t.onChange,children:[e.jsx(f,{children:e.jsx(M,{children:e.jsx(O,{placeholder:"Select Parent"})})}),e.jsx(F,{children:E?e.jsx(A,{}):x.map((a,ee)=>e.jsx(b,{value:a.toString(),children:a.toString()},ee))})]}),e.jsx(N,{})]})}):null,e.jsx(p,{control:o.control,name:"is_sub_type",render:({field:t})=>e.jsxs(g,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(y,{children:"Is Sub Type"})}),e.jsx(f,{children:e.jsx(we,{checked:t.value===1,onCheckedChange:a=>{t.onChange(a?1:0),j(a?1:0)}})})]})}),i===1&&e.jsx(p,{control:o.control,name:"sub_type",render:({field:t})=>e.jsxs(g,{children:[e.jsx(y,{children:"Sub Type"}),e.jsxs(G,{onValueChange:t.onChange,defaultValue:"None",children:[e.jsx(f,{children:e.jsx(M,{children:e.jsx(O,{placeholder:""})})}),e.jsxs(F,{children:[e.jsx(b,{value:"None",children:"None"}),e.jsx(b,{value:"Employee",children:"Employee"}),e.jsx(b,{value:"Customer",children:"Customer"}),e.jsx(b,{value:"Supplier",children:"Supplier"}),e.jsx(b,{value:"Agent",children:"Agent"})]})]}),e.jsx(N,{})]})}),e.jsx("div",{children:e.jsx(w,{variant:"default",type:"submit",className:"w-full mt-4",children:"Add Account"})})]})})})}const Be=()=>{const{data:n,isLoading:s}=Te(),[l,c]=V.useState(!1),[d,i]=V.useState(!1),j=(n==null?void 0:n.data)||[];return s?e.jsx(A,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(fe,{title:"Chart Of Account",description:"Manage Chart of account for you business"}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsxs(w,{onClick:()=>c(!0),size:"sm",children:[e.jsx(v,{className:"mr-2 h-4 w-4"})," Add Group"]}),e.jsxs(w,{onClick:()=>i(!0),size:"sm",children:[e.jsx(v,{className:"mr-2 h-4 w-4"})," Add Account"]})]})]}),e.jsx(Ne,{}),e.jsxs(be,{defaultValue:P[0].type,className:"w-full mt-3",children:[e.jsx(Ce,{className:"w-fit",children:P.map(h=>e.jsx(Ae,{value:h.type,children:h.title},h.type))}),P.map(h=>e.jsx(Se,{value:h.type,children:e.jsx(Ge,{title:h.title,coaType:h.type,description:h.description,data:j})},h.type))]}),l&&e.jsx(z,{title:"Add Group",isOpen:l,toggleModal:()=>c(!1),children:e.jsx(Oe,{modalClose:()=>c(!1)})}),d&&e.jsx(z,{title:"Add Account",isOpen:d,toggleModal:()=>i(!1),children:e.jsx(Ie,{modalClose:()=>i(!1)})})]})};export{Be as default};
