import{B as O,D as E,ce as R,r as m,a as e,au as F,G as U,H as N,J as G,K as g,N as C,I as S,Q as _,aU as K,aE as A,V as u,aK as M,av as L,aw as H,az as v,aA as f,aB as b,aC as $,aD as y,aF as B,aG as T,aH as w,R as J,aJ as Q,aL as V,aM as q}from"./index-5e4ea710.js";import{c as W}from"./leave-fdfdd57b.js";import{u as X,a as Y,b as Z,c as D}from"./index-a6342871.js";import{u as ee}from"./index-df9bf5b6.js";function I({modalClose:s,data:a}){const[l,{isLoading:d}]=X(),[n,{isLoading:p}]=Y(),{data:o,isLoading:i}=ee("per_page=1000&page=1"),x=(o==null?void 0:o.data)||[],c=O({resolver:E(W),defaultValues:{name:(a==null?void 0:a.name)||"",leave:a!=null&&a.leave_group_types?a.leave_group_types.map(r=>{var t;return{...r,leave_type_id:String(((t=r==null?void 0:r.leave_type)==null?void 0:t.id)||"")}}):[]}});async function P(r){try{a?(await n({leaveGroupId:a.id,updatedLeaveGroup:r}).unwrap(),L.success("Leave Group updated successfully"),s()):(await l(r).unwrap(),L.success("Leave Group created successfully"),s())}catch(t){console.log(t),H(t)}}const{fields:h,append:j,remove:k}=R({control:c.control,name:"leave"});return m.useEffect(()=>{h.length===0&&j({leave_type_id:"",leave_count:0})},[h,j]),e.jsx(e.Fragment,{children:d||p?e.jsx("div",{children:e.jsx(F,{})}):e.jsx(U,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(P),className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-1",children:[e.jsx(N,{control:c.control,name:"name",render:({field:r})=>e.jsxs(G,{children:[e.jsx(g,{children:"Leave Group Name"}),e.jsx(C,{children:e.jsx(S,{className:"",placeholder:"Enter Leave Group Name",...r})}),e.jsx(_,{})]})}),h.map((r,t)=>e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx("div",{className:"mr-2 w-full",children:e.jsxs("div",{children:[t===0?e.jsx(g,{children:"Leave Type"}):null,e.jsx(K,{loading:i,data:x,displayField:"name",valueField:"id",form:c,name:`leave.${t}.leave_type_id`,className:"w-[290px]"})]},r.id)}),e.jsx("div",{children:e.jsx(N,{control:c.control,name:`leave.${t}.leave_count`,render:({field:z})=>e.jsxs(G,{children:[t===0?e.jsx(g,{children:"Leave Count"}):null,e.jsx(C,{children:e.jsx(S,{type:"number",className:"",placeholder:"Enter Leave Count",...z})}),e.jsx(_,{})]})},r.id)}),e.jsx("span",{className:"mt-auto mb-3",onClick:()=>k(t),children:e.jsx(A,{size:16,color:"red",className:"ml-2"})})]},t)),e.jsxs(u,{variant:"outline",className:"border border-dashed border-gray-700 w-full",type:"button",onClick:()=>j({leave_type_id:"",leave_count:0}),children:[e.jsx(M,{size:16})," ",e.jsx("span",{className:"ml-2",children:"Add Line"})]})]}),e.jsx("div",{className:"text-right",children:e.jsx(u,{variant:"default",type:"submit",className:"w-fit mt-4",children:a?"Update":"Add"})})]})})})}function ae({data:s}){const[a,l]=m.useState(!1),[d,n]=m.useState(!1),[p,{isLoading:o}]=Z(),i=async x=>{try{await p(x),L.success("Leave Group deleted successfully"),l(!1)}catch(c){console.log(c)}};return e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx(v,{children:e.jsxs(f,{children:[e.jsx(b,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>n(!0),children:e.jsx($,{className:"h-4 w-4 text-foreground"})})}),e.jsx(y,{children:e.jsx("p",{children:"Update Leave Group"})})]})}),e.jsx(v,{children:e.jsx(f,{children:e.jsx(y,{children:e.jsx("p",{children:"Delete Leave Group"})})})}),e.jsx(v,{children:e.jsxs(f,{children:[e.jsx(b,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"icon",className:"hover:bg-secondary",onClick:()=>{l(!0)},children:e.jsx(A,{className:"h-4 w-4 text-foreground"})})}),e.jsx(y,{children:e.jsx("p",{children:"Delete Leave Group"})})]})}),e.jsx(B,{title:"Are you sure?",description:"This action cannot be undone.",name:s.name,isOpen:a,onClose:()=>l(!1),onConfirm:()=>i(s.id),loading:o}),d&&e.jsx(T,{title:"Update Leave Group",isOpen:d,toggleModal:()=>n(!1),className:"",children:e.jsx(I,{data:s,modalClose:()=>n(!1)})})]})}const se=[{id:"select",header:({table:s})=>e.jsx(w,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>s.toggleAllPageRowsSelected(!!a),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(w,{checked:s.getIsSelected(),onCheckedChange:a=>s.toggleSelected(!!a),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:"Leave group name"},{accessorKey:"Leave Types",cell:({row:s})=>s.original.leave_group_types.map(a=>{var l;return e.jsx("div",{className:"py-1",children:(l=a.leave_type)==null?void 0:l.name})})},{accessorKey:"Leave Count",cell:({row:s})=>s.original.leave_group_types.map(a=>e.jsx("div",{className:"py-1",children:a.leave_count}))},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"Actions"}),enableSorting:!1,cell:({row:s})=>e.jsx(ae,{data:s.original})}],oe=()=>{const[s,a]=m.useState(!1),[l,d]=J.useState({pageIndex:0,pageSize:10}),{data:n,isLoading:p}=D(`per_page=${l.pageSize}&page=${l.pageIndex+1}`),o=(n==null?void 0:n.data)||[],i=n==null?void 0:n.meta;return p?e.jsx(F,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Q,{title:"Leave Group",description:"Manage job apply for you business"}),e.jsxs(u,{onClick:()=>a(!0),size:"sm",children:[e.jsx(M,{className:"mr-2 h-4 w-4"})," Add Leave Group"]})]}),e.jsx(V,{}),o&&e.jsx("div",{children:e.jsx(q,{columns:se,data:o,paginationInfo:i,pagination:i&&l,setPagination:i&&d})})]})}),s&&e.jsx(T,{title:"Add Leave Group",isOpen:s,toggleModal:()=>a(!1),className:"",children:e.jsx(I,{modalClose:()=>a(!1)})})]})};export{oe as default};
