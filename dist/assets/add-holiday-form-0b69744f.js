import{r as N,y as L,B as z,cg as I,a as e,au as J,aJ as O,V as c,W as C,G as R,H as d,J as m,K as u,N as x,I as f,Q as h,a9 as F,aa as $,ab as j,aV as b,ac as P,ad as _,aE as B,aK as K,D as G,av as S}from"./index-c9746b3f.js";import{c as Q}from"./index-f36ecbee.js";import{s as W}from"./holidays-b5b40f77.js";function Y(){const[y,H]=N.useState({fromDate:[!1],toDate:[!1]}),[V,p]=N.useState([]),[k,{isLoading:v}]=Q(),D=L(),o=z({resolver:G(W),defaultValues:{holidays:[{name:"",start_date:null,end_date:null,duration:"",note:""}]}}),{fields:T,append:E,remove:M}=I({control:o.control,name:"holidays"}),g=(r,a)=>{if(r&&a){const s=a.getTime()-r.getTime(),t=Math.ceil(s/(1e3*60*60*24));return`${t+1} day${t===0?"":"s"}`}return""},A=async r=>{const a={...r,holidays:r.holidays.map(s=>({...s,start_date:s.start_date?j(new Date(s.start_date),"yyyy-MM-dd"):null,end_date:s.end_date?j(new Date(s.end_date),"yyyy-MM-dd"):null}))};try{await k(a),S.success("Holidays Created Successfully!"),D("/hrm/holidays")}catch{S.error("Failed to create holidays!")}},w=(r,a)=>{H(s=>{const t={...s};return a==="fromDate"?(t.fromDate[r]=!t.fromDate[r],t.toDate[r]=!1):(o.getValues(`holidays.${r}.start_date`)?(t.toDate[r]=!t.toDate[r],p(n=>{const i=[...n];return i[r]=!1,i})):p(n=>{const i=[...n];return i[r]=!0,i}),t.fromDate[r]=!1),t})};return e.jsx(e.Fragment,{children:v?e.jsx("div",{className:"h-56",children:e.jsx(J,{})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(O,{title:"Add Holiday",description:""}),e.jsx(c,{size:"sm",onClick:()=>D("/hrm/holidays"),children:"Holiday List"})]}),e.jsx(C,{className:"p-3",children:e.jsx(R,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(A),className:"space-y-3 mb-auto px-2 overflow-y-scroll no-scrollbar",children:[T.map((r,a)=>e.jsx(C,{className:"p-3",children:e.jsxs("div",{className:"flex w-full gap-x-3",children:[e.jsx("div",{className:"w-[215px]",children:e.jsx(d,{control:o.control,name:`holidays.${a}.name`,render:({field:s})=>e.jsxs(m,{children:[e.jsx(u,{children:a===0&&"Holiday Name"}),e.jsx(x,{children:e.jsx(f,{type:"text",placeholder:"Enter holiday name",...s})}),e.jsx(h,{})]})})}),e.jsx("div",{className:"w-[250px]",children:e.jsx(d,{control:o.control,name:`holidays.${a}.start_date`,render:({field:s})=>e.jsxs(m,{children:[e.jsx(u,{children:a===0&&"From Date"}),e.jsxs(F,{open:y.fromDate[a],onOpenChange:()=>w(a,"fromDate"),children:[e.jsx($,{asChild:!0,children:e.jsxs(c,{variant:"outline",className:`w-full justify-start text-left font-normal ${!s.value&&"text-muted-foreground"}`,children:[s.value?j(new Date(s.value),"PP"):"Pick a date",e.jsx(b,{className:"ml-auto h-4 w-4 opacity-50"})]})}),e.jsx(P,{className:"w-auto p-0",align:"start",children:e.jsx(_,{mode:"single",selected:s.value??void 0,onSelect:t=>{s.onChange(t);const l=o.getValues(`holidays.${a}.end_date`);if(t&&l){const n=g(t,l);o.setValue(`holidays.${a}.duration`,n)}},initialFocus:!0})})]}),e.jsx(h,{})]})})}),e.jsx("div",{className:"w-[250px]",children:e.jsx(d,{control:o.control,name:`holidays.${a}.end_date`,render:({field:s})=>e.jsxs(m,{children:[e.jsx(u,{children:a===0&&"To Date"}),e.jsxs(F,{open:y.toDate[a],onOpenChange:()=>w(a,"toDate"),children:[e.jsx($,{asChild:!0,children:e.jsxs(c,{variant:"outline",className:`w-full justify-start text-left font-normal ${!s.value&&"text-muted-foreground"}`,children:[s.value?j(new Date(s.value),"PP"):"Pick a date",e.jsx(b,{className:"ml-auto h-4 w-4 opacity-50"})]})}),e.jsx(P,{className:"w-auto p-0",align:"start",children:e.jsx(_,{mode:"single",selected:s.value??void 0,disabled:t=>{const l=o.getValues(`holidays.${a}.start_date`);return!!(l&&t<l)},onSelect:t=>{s.onChange(t);const l=o.getValues(`holidays.${a}.start_date`);if(l&&t){const n=g(l,t);o.setValue(`holidays.${a}.duration`,n)}},initialFocus:!0})})]}),V[a]&&e.jsx(h,{children:"Please select a From Date first."})]})})}),e.jsx("div",{className:"w-[150px]",children:e.jsx(d,{control:o.control,name:`holidays.${a}.duration`,render:({field:s})=>e.jsxs(m,{children:[e.jsx(u,{children:a===0&&"Duration"}),e.jsx(x,{children:e.jsx(f,{type:"text",disabled:!0,...s})}),e.jsx(h,{})]})})}),e.jsx("div",{className:"w-[300px]",children:e.jsx(d,{control:o.control,name:`holidays.${a}.note`,render:({field:s})=>e.jsxs(m,{children:[e.jsx(u,{children:a===0&&"Note"}),e.jsx(x,{children:e.jsx(f,{type:"text",placeholder:"Enter note",...s})}),e.jsx(h,{})]})})}),e.jsx("div",{children:e.jsxs(c,{type:"button",variant:"destructive",className:"mt-6",onClick:()=>M(a),children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Remove"]})})]})},r.id)),e.jsxs("div",{className:"flex justify-end items-center space-x-3",children:[e.jsxs(c,{type:"button",variant:"secondary",size:"sm",onClick:()=>E({name:"",start_date:null,end_date:null,duration:"",note:""}),children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Add Row"]}),e.jsx(c,{type:"submit",size:"sm",disabled:v,children:"Save"})]})]})})})]})})}export{Y as default};
